
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module UpperBound_AExtra</title>
<meta name="description" content="Documentation of Coq module UpperBound_AExtra" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module UpperBound_AExtra</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CoqlibC</span> <span class="id">MapsC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ASTC</span> <span class="id">Integers</span> <span class="id">Floats</span> <span class="id">Values</span> <span class="id">MemoryC</span> <span class="id">Events</span> <span class="id">Globalenvs</span> <span class="id">Smallstep</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Locations</span> <span class="id">Stacklayout</span> <span class="id">Conventions</span> <span class="id">Linking</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Csem</span> <span class="id">Cop</span> <span class="id">Ctypes</span> <span class="id">Ctyping</span> <span class="id">Csyntax</span> <span class="id">Cexec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Simulation</span> <span class="id">Memory</span> <span class="id">ValuesC</span> <span class="id">LinkingC2</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Skeleton</span> <span class="id">ModSem</span> <span class="id">Mod</span> <span class="id">sflib</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CtypesC</span> <span class="id">CsemC</span> <span class="id">Sem</span> <span class="kwd">Syntax</span> <span class="id">LinkingC</span> <span class="kwd">Program</span> <span class="id">SemProps</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Equality</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CtypingC</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">Eq</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H1</span>: ?<span class="id">a</span> = ?<span class="id">b</span>, <span class="id">H2</span>: ?<span class="id">a</span> = ?<span class="id">c</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">Eq</span><br/>
&nbsp;&nbsp;| [ <span class="id">H1</span>: ?<span class="id">a</span> <span class="id">m</span>= ?<span class="id">b</span>, <span class="id">H2</span>: ?<span class="id">a</span> <span class="id">m</span>= ?<span class="id">c</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">Eq</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">app_cont</span> (<span class="id">k0</span> <span class="id">k1</span>: <span class="id">cont</span>) {<span class="kwd">struct</span> <span class="id">k0</span>}: <span class="id">cont</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">k0</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Kstop</span> =&gt; <span class="id">k1</span><br/>
&nbsp;&nbsp;| <span class="id">Kdo</span> <span class="id">k</span> =&gt; <span class="id">Kdo</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kseq</span> <span class="id">s</span> <span class="id">k</span> =&gt; <span class="id">Kseq</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kifthenelse</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span> =&gt; <span class="id">Kifthenelse</span> <span class="id">s1</span> <span class="id">s2</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kwhile1</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span> =&gt; <span class="id">Kwhile1</span> <span class="id">e</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kwhile2</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span> =&gt; <span class="id">Kwhile2</span> <span class="id">e</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kdowhile1</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span> =&gt; <span class="id">Kdowhile1</span> <span class="id">e</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kdowhile2</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span> =&gt; <span class="id">Kdowhile2</span> <span class="id">e</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kfor2</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span> =&gt; <span class="id">Kfor2</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kfor3</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span> =&gt; <span class="id">Kfor3</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kfor4</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span> =&gt; <span class="id">Kfor4</span> <span class="id">e</span> <span class="id">s1</span> <span class="id">s2</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kswitch1</span> <span class="id">ls</span> <span class="id">k</span> =&gt;  <span class="id">Kswitch1</span> <span class="id">ls</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kswitch2</span> <span class="id">k</span> =&gt;  <span class="id">Kswitch2</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kreturn</span> <span class="id">k</span> =&gt; <span class="id">Kreturn</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Kcall</span> <span class="id">f</span> <span class="id">e</span> <span class="id">em</span> <span class="id">ty</span> <span class="id">k</span> =&gt; <span class="id">Kcall</span> <span class="id">f</span> <span class="id">e</span> <span class="id">em</span> <span class="id">ty</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">app_cont_stop_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k0</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">app_cont</span> <span class="id">k0</span> <span class="id">Kstop</span> = <span class="id">k0</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7445')">Proof.</div>
<div class="proofscript" id="proof7445">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">k0</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">des</span>; <span class="id">clarify</span>; <span class="id">ss</span>; <span class="id">r</span>; <span class="tactic">f_equal</span>; <span class="id">ss</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">app_cont_stop_left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k0</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">app_cont</span> <span class="id">Kstop</span> <span class="id">k0</span> = <span class="id">k0</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7446')">Proof.</div>
<div class="proofscript" id="proof7446">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">k0</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">des</span>; <span class="id">clarify</span>; <span class="id">ss</span>; <span class="id">r</span>; <span class="tactic">f_equal</span>; <span class="id">ss</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">app_cont_kstop_inv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k0</span> <span class="id">k1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">APP</span>: <span class="id">app_cont</span> <span class="id">k0</span> <span class="id">k1</span> = <span class="id">Kstop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k0</span> = <span class="id">Kstop</span> /\ <span class="id">k1</span> = <span class="id">Kstop</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7447')">Proof.</div>
<div class="proofscript" id="proof7447">
 <span class="tactic">destruct</span> <span class="id">k0</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">SIM</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">cp_link</span>: <span class="id">Csyntax.program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">cps</span>: <span class="id">list</span> <span class="id">Csyntax.program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">ctx</span>: <span class="id">Syntax.program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">FOCUS</span>: <span class="id">link_list</span> <span class="id">cps</span> = <span class="id">Some</span> <span class="id">cp_link</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">prog_src</span> := <span class="id">ctx</span> ++ [<span class="id">cp_link</span>.(<span class="id">CsemC.module</span>)].<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">prog_tgt</span> := <span class="id">ctx</span> ++ <span class="id">map</span> <span class="id">CsemC.module</span> <span class="id">cps</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">sk_link</span>: <span class="id">Sk.t</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">skenv_link</span>: <span class="id">SkEnv.t</span> := (<span class="id">Sk.load_skenv</span> <span class="id">sk_link</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id">LINKSRC</span>: <span class="id">link_sk</span> <span class="id">prog_src</span> = <span class="id">Some</span> <span class="id">sk_link</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> " '<span class="id">geof</span>' <span class="id">cp</span>" := (<span class="id">Build_genv</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> <span class="id">cp</span>.(<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span>)) <span class="id">cp</span>) <span class="id">cp</span>.(<span class="id">prog_comp_env</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>, <span class="id">only</span> <span class="id">parsing</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">ge_cp_link</span>: <span class="id">genv</span> := <span class="id">geof</span> <span class="id">cp_link</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WTPROGLINK</span>: <span class="id">wt_program</span> <span class="id">cp_link</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WTPROGS</span>: <span class="kwd">forall</span> <span class="id">cp</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>), <span class="id">wt_program</span> <span class="id">cp</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">CSTYLE_EXTERN_LINK</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, (<span class="id">Gfun</span> (<span class="id">Ctypes.External</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span>))) <span class="id">cp_link</span>.(<span class="id">prog_defs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ef</span>.(<span class="id">ef_sig</span>).(<span class="id">sig_cstyle</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">is_focus</span> (<span class="id">cp</span>: <span class="id">Csyntax.program</span>): <span class="kwd">Prop</span> := <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">CSTYLE_EXTERN</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span> <span class="id">cp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_focus</span> <span class="id">cp</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, (<span class="id">Gfun</span> (<span class="id">Ctypes.External</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span>))) <span class="id">cp</span>.(<span class="id">prog_defs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ef</span>.(<span class="id">ef_sig</span>).(<span class="id">sig_cstyle</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">link_sk_match</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">link_sk</span> <span class="id">prog_src</span> = <span class="id">link_sk</span> <span class="id">prog_tgt</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7448')">Proof.</div>
<div class="proofscript" id="proof7448">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst_locals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_sk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id">map_app</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">eapply</span> <span class="id">link_list_app_commut</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">FOCUS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">cps</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">link_list</span>, <span class="id">link_list_aux</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id">link_list_cons</span> <span class="id">Sk.t</span>); <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">HD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span> <span class="id">Linker_program</span> <span class="id">Linker_fundef</span> <span class="id">Linker_types</span> <span class="id">Linker_varinit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Linker_vardef</span> <span class="id">Linker_def</span> <span class="id">Linking.Linker_fundef</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">a</span> <span class="id">into</span> <span class="id">p0</span>. <span class="tactic">rename</span> <span class="id">restl</span> <span class="id">into</span> <span class="id">p1</span>. <span class="id">fold</span> <span class="id">Csyntax.program</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Heq</span>. <span class="tactic">unfold</span> <span class="id">link_prog</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">des_ifs_safe</span>. <span class="id">bsimpl</span>. <span class="id">des</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">bsimpl</span>. <span class="id">des</span>; <span class="id">des_sumbool</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_Properties.for_all_false</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">PTree_Properties.for_all_correct</span> <span class="kwd">in</span> *. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">p0</span> <span class="id">signature_of_function</span> <span class="id">x1</span>). <span class="tactic">intro</span> <span class="id">REL0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">p1</span> <span class="id">signature_of_function</span> <span class="id">x1</span>). <span class="tactic">intro</span> <span class="id">REL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">REL0</span>; <span class="tactic">try</span> <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">Heq1</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">CHK</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_prog_check</span> <span class="kwd">in</span> *. <span class="id">des_ifs_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">REL1</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bsimpl</span>. <span class="id">des</span>; <span class="id">des_sumbool</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Heq2</span> <span class="id">CHK0</span> <span class="id">H1</span> <span class="id">H4</span>. <span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; <span class="id">bsimpl</span>; <span class="id">des</span>; <span class="id">des_sumbool</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">signature_of_function</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">signature_of_type</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">n</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="id">ginduction</span> <span class="id">t</span>. <span class="id">ss</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">IHt</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">signature_of_function</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">signature_of_type</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">n</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="id">ginduction</span> <span class="id">t</span>. <span class="id">ss</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">IHt</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">link_vardef</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bsimpl</span>. <span class="id">des</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">unfold</span> <span class="id">CSk.of_program</span>. <span class="id">ss</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">skdefs_of_gdefs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_elements_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_elements_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">PTree.elements_extensional</span>. <span class="tactic">intro</span> <span class="id">id</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id">PTree.gmap</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">Heq2</span> <span class="id">into</span> <span class="id">P</span>. <span class="tactic">rename</span> <span class="id">Heq1</span> <span class="id">into</span> <span class="id">Q</span>. <span class="tactic">clear</span> - <span class="id">P</span> <span class="id">Q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id">prog_defmap_update_snd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_Properties.for_all_correct</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> ((<span class="id">PTree_Properties.of_list</span> (<span class="id">prog_defs</span> <span class="id">p0</span>)) ! <span class="id">id</span>) <span class="kwd">as</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> ((<span class="id">PTree_Properties.of_list</span> (<span class="id">prog_defs</span> <span class="id">p1</span>)) ! <span class="id">id</span>) <span class="kwd">as</span> <span class="id">y</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:<span class="id">Tx</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">y</span> <span class="id">eqn</span>:<span class="id">Ty</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">Tx</span>. <span class="tactic">unfold</span> <span class="id">y</span> <span class="kwd">in</span> <span class="id">Ty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Q</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">CHK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">option_map</span>. <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">g</span>, <span class="id">g0</span>; <span class="id">ss</span>; <span class="tactic">unfold</span> <span class="id">skdef_of_gdef</span>, <span class="id">fundef_of_fundef</span>, <span class="id">link_prog_check</span>, <span class="id">prog_defmap</span>, <span class="id">program_of_program</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; <span class="id">bsimpl</span>; <span class="id">des</span>; <span class="id">des_sumbool</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">g</span>, <span class="id">g0</span>; <span class="id">ss</span>; <span class="tactic">unfold</span> <span class="id">skdef_of_gdef</span>, <span class="id">fundef_of_fundef</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>; <span class="id">ss</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fundef_of_fundef</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>; <span class="id">bsimpl</span>; <span class="id">des</span>; <span class="id">des_sumbool</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="tactic">unfold</span> <span class="id">signature_of_function</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">signature_of_type</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">n</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">Heq1</span>. <span class="tactic">clear</span>. <span class="id">ginduction</span> <span class="id">t</span>. <span class="id">ss</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">IHt</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="tactic">unfold</span> <span class="id">signature_of_function</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">signature_of_type</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">n</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">Heq1</span>. <span class="tactic">clear</span>. <span class="id">ginduction</span> <span class="id">t</span>. <span class="id">ss</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">IHt</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">g</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">link_vardef</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="id">bsimpl</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">eqb_true_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">destruct</span> <span class="id">gvar_info</span>; <span class="id">ss</span>. <span class="tactic">f_equal</span>; <span class="id">ss</span>. <span class="tactic">f_equal</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>, <span class="id">v0</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">link_vardef</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Q</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">LINKTGT</span>: <span class="id">link_sk</span> <span class="id">prog_tgt</span> = <span class="id">Some</span> <span class="id">sk_link</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7449')">Proof.</div>
<div class="proofscript" id="proof7449">
 <span class="tactic">rewrite</span> <span class="id">link_sk_match</span> <span class="kwd">in</span> *. <span class="id">ss</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">INCL_LINKED</span>: <span class="id">SkEnv.includes</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7450')">Proof.</div>
<div class="proofscript" id="proof7450">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_includes</span>. <span class="tactic">eapply</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">prog_src</span>. <span class="id">instantiate</span> (1 := (<span class="id">module</span> <span class="id">cp_link</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_or_app</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">ss</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">INCL_FOCUS</span>: <span class="kwd">forall</span> <span class="id">pgm</span>, <span class="id">is_focus</span> <span class="id">pgm</span> -&gt; <span class="id">SkEnv.includes</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">pgm</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7451')">Proof.</div>
<div class="proofscript" id="proof7451">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">exploit</span> <span class="id">link_includes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">LINKTGT</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">prog_tgt</span>. <span class="id">instantiate</span> (1 := (<span class="id">module</span> <span class="id">pgm</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> *. <span class="id">r</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">right</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">esplits</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_defmap_func_same_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pgm</span> <span class="id">id</span> <span class="id">func</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">pgm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">pgm</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNAL</span>: <span class="id">negb</span> (<span class="id">is_external_fd</span> <span class="id">func</span>) = <span class="id">true</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7452')">Proof.</div>
<div class="proofscript" id="proof7452">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> <span class="kwd">in</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (@<span class="id">prog_defmap_linkorder</span> (<span class="id">Ctypes.fundef</span> <span class="id">function</span>) <span class="id">type</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>. <span class="id">inv</span> <span class="id">P0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">sum_cont</span>: <span class="id">list</span> <span class="id">Frame.t</span> -&gt; <span class="id">cont</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">sum_cont_nil</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> [] <span class="id">Kstop</span><br/>
&nbsp;&nbsp;| <span class="id">sum_cont_cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_fptr</span> <span class="id">_vs</span> <span class="id">k0</span> <span class="id">_m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_targs</span> <span class="id">_tres</span> <span class="id">_cconv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CALL</span>: <span class="id">is_call_cont_strong</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl</span> <span class="id">k1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TL</span>: <span class="id">sum_cont</span> <span class="id">tl</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">K</span>: <span class="id">k2</span> = <span class="id">app_cont</span> <span class="id">k0</span> <span class="id">k1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOCUS</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">K0</span>: <span class="id">exists</span> <span class="id">_f</span> <span class="id">_e</span> <span class="id">_C</span> <span class="id">_k</span>, <span class="id">k0</span> = (<span class="id">Kcall</span> <span class="id">_f</span> <span class="id">_e</span> <span class="id">_C</span> <span class="id">_tres</span> <span class="id">_k</span>) /\ &lt;&lt;<span class="id">WTYK</span>: <span class="id">wtype_cont</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">_k</span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">Csem.Callstate</span> <span class="id">_fptr</span> (<span class="id">Tfunction</span> <span class="id">_targs</span> <span class="id">_tres</span> <span class="id">_cconv</span>) <span class="id">_vs</span> <span class="id">k0</span> <span class="id">_m</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> ((<span class="id">Frame.mk</span> (<span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Csem.Callstate</span> <span class="id">_fptr</span> (<span class="id">Tfunction</span> <span class="id">_targs</span> <span class="id">_tres</span> <span class="id">_cconv</span>) <span class="id">_vs</span> <span class="id">k0</span> <span class="id">_m</span>)) :: <span class="id">tl</span>) <span class="id">k2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sum_cont_kstop_inv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">frs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span>: <span class="id">sum_cont</span> <span class="id">frs</span> <span class="id">Kstop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">frs</span> = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7453')">Proof.</div>
<div class="proofscript" id="proof7453">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">SUM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SUM</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexpl</span> <span class="id">app_cont_kstop_inv</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">match_focus_state</span>: <span class="id">Csem.state</span> -&gt; <span class="id">Csem.state</span> -&gt; <span class="id">cont</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">reg_state_similar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">s</span> <span class="id">k</span> <span class="id">k0</span> <span class="id">k1</span> <span class="id">e</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CONT</span>: <span class="id">k</span> = <span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">match_focus_state</span> (<span class="id">Csem.State</span> <span class="id">f</span> <span class="id">s</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>) (<span class="id">Csem.State</span> <span class="id">f</span> <span class="id">s</span> <span class="id">k1</span> <span class="id">e</span> <span class="id">m</span>) <span class="id">k0</span><br/>
&nbsp;&nbsp;| <span class="id">expr_state_similar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">ex</span> <span class="id">k</span> <span class="id">k0</span> <span class="id">k1</span> <span class="id">e</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CONT</span>: <span class="id">k</span> = <span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">match_focus_state</span> (<span class="id">Csem.ExprState</span> <span class="id">f</span> <span class="id">ex</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>) (<span class="id">Csem.ExprState</span> <span class="id">f</span> <span class="id">ex</span> <span class="id">k1</span> <span class="id">e</span> <span class="id">m</span>) <span class="id">k0</span><br/>
&nbsp;&nbsp;| <span class="id">call_sate_similar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fptr</span> <span class="id">tyf</span> <span class="id">vargs</span> <span class="id">k</span> <span class="id">k0</span> <span class="id">k1</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CONT</span>: <span class="id">k</span> = <span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">match_focus_state</span> (<span class="id">Csem.Callstate</span> <span class="id">fptr</span> <span class="id">tyf</span> <span class="id">vargs</span> <span class="id">k</span> <span class="id">m</span>) (<span class="id">Csem.Callstate</span> <span class="id">fptr</span> <span class="id">tyf</span> <span class="id">vargs</span> <span class="id">k1</span> <span class="id">m</span>) <span class="id">k0</span><br/>
&nbsp;&nbsp;| <span class="id">return_sate_similar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vres</span> <span class="id">k</span> <span class="id">k0</span> <span class="id">k1</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CONT</span>: <span class="id">k</span> = <span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">match_focus_state</span> (<span class="id">Csem.Returnstate</span> <span class="id">vres</span> <span class="id">k</span> <span class="id">m</span>) (<span class="id">Csem.Returnstate</span> <span class="id">vres</span> <span class="id">k1</span> <span class="id">m</span>) <span class="id">k0</span><br/>
&nbsp;&nbsp;| <span class="id">stuck_state_similar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k0</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_focus_state</span> <span class="id">Csem.Stuckstate</span> <span class="id">Csem.Stuckstate</span> <span class="id">k0</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">call_cont_app_cont</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> <span class="id">k0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span> (<span class="id">SUM</span>: <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">app_cont</span> (<span class="id">call_cont</span> <span class="id">k</span>) <span class="id">k0</span>) = <span class="id">call_cont</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7454')">Proof.</div>
<div class="proofscript" id="proof7454">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">SUM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">CASE</span>: <span class="id">k0</span> = <span class="id">Kstop</span> \/ <span class="id">is_call_cont_strong</span> <span class="id">k0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SUM</span>; <span class="id">ss</span>; <span class="id">et</span>. <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SUM</span>. <span class="id">clear_tac</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clarify</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">app_cont_stop_right</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">rr</span> <span class="kwd">in</span> <span class="id">CASE</span>. <span class="id">des_ifs</span>. <span class="id">clear_tac</span>. <span class="tactic">clear</span> - <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">k</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">des</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">app_cont_stop_right</span>; <span class="id">ss</span>; <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">matched_state_source</span> (<span class="id">st_tgt</span>: <span class="id">Csem.state</span>) (<span class="id">k0</span>: <span class="id">cont</span>): <span class="id">Csem.state</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">st_tgt</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Csem.State</span> <span class="id">f</span> <span class="id">s</span> <span class="id">k1</span> <span class="id">e</span> <span class="id">m</span> =&gt; <span class="id">Csem.State</span> <span class="id">f</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>) <span class="id">e</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Csem.ExprState</span> <span class="id">f</span> <span class="id">ex</span> <span class="id">k1</span> <span class="id">e</span> <span class="id">m</span> =&gt; <span class="id">Csem.ExprState</span> <span class="id">f</span> <span class="id">ex</span> (<span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>) <span class="id">e</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Csem.Callstate</span> <span class="id">fptr</span> <span class="id">tyf</span> <span class="id">vargs</span> <span class="id">k1</span> <span class="id">m</span> =&gt; <span class="id">Csem.Callstate</span> <span class="id">fptr</span> <span class="id">tyf</span> <span class="id">vargs</span> (<span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>) <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Csem.Returnstate</span> <span class="id">vres</span> <span class="id">k1</span> <span class="id">m</span> =&gt; <span class="id">Csem.Returnstate</span> <span class="id">vres</span> (<span class="id">app_cont</span> <span class="id">k1</span> <span class="id">k0</span>) <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Csem.Stuckstate</span> =&gt; <span class="id">Csem.Stuckstate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">match_focus_state_iff</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">st_src0</span> <span class="id">st_tgt0</span> <span class="id">k0</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">MATCH</span>: <span class="id">match_focus_state</span> <span class="id">st_src0</span> <span class="id">st_tgt0</span> <span class="id">k0</span>&gt;&gt; &lt;-&gt; &lt;&lt;<span class="id">MATCH</span>: <span class="id">st_src0</span> = <span class="id">matched_state_source</span> <span class="id">st_tgt0</span> <span class="id">k0</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7455')">Proof.</div>
<div class="proofscript" id="proof7455">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">r</span>. <span class="tactic">destruct</span> <span class="id">st_tgt0</span>; <span class="id">ss</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Same Lemmas </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">defmap_with_signature</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp</span>:<span class="id">Csyntax.program</span>) <span class="id">i</span> <span class="id">g</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span> = <span class="id">Some</span> <span class="id">g</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd</span>, (<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) ! <span class="id">i</span> = <span class="id">Some</span> <span class="id">gd</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7456')">Proof.</div>
<div class="proofscript" id="proof7456">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">defmap_with_signature_internal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp</span>:<span class="id">Csyntax.program</span>) <span class="id">i</span> <span class="id">if_sig</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">if_sig0</span>, (<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">AST.Internal</span> <span class="id">if_sig0</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7457')">Proof.</div>
<div class="proofscript" id="proof7457">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">f2</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">invert_symbol_lemma1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> <span class="id">i0</span> <span class="id">i</span> <span class="id">cp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBSKENV</span> : <span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span> = <span class="id">Some</span> <span class="id">i0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFS</span>: <span class="id">defs</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>) <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMB</span> : <span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span> = <span class="id">Some</span> <span class="id">i</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span> = <span class="id">i0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7458')">Proof.</div>
<div class="proofscript" id="proof7458">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H0</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_defmap_same_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pgm</span> <span class="id">id</span> <span class="id">func</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">pgm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">pgm</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>))):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7459')">Proof.</div>
<div class="proofscript" id="proof7459">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> <span class="kwd">in</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (@<span class="id">prog_defmap_linkorder</span> (<span class="id">Ctypes.fundef</span> <span class="id">function</span>) <span class="id">type</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>. <span class="id">inv</span> <span class="id">P0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_defmap_gvar_exists_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pgm</span> <span class="id">id</span> <span class="id">var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">pgm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">pgm</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gvar</span> <span class="id">var</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">var</span>', (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gvar</span> <span class="id">var</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7460')">Proof.</div>
<div class="proofscript" id="proof7460">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> <span class="kwd">in</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (@<span class="id">prog_defmap_linkorder</span> (<span class="id">Ctypes.fundef</span> <span class="id">function</span>) <span class="id">type</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>. <span class="id">inv</span> <span class="id">P0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_defmap_exists_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pgm</span> <span class="id">id</span> <span class="id">func</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">pgm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">pgm</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">func</span>', (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7461')">Proof.</div>
<div class="proofscript" id="proof7461">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> <span class="kwd">in</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (@<span class="id">prog_defmap_linkorder</span> (<span class="id">Ctypes.fundef</span> <span class="id">function</span>) <span class="id">type</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>. <span class="id">inv</span> <span class="id">P0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">invert_symbol_lemma2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> <span class="id">i0</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBSKENV</span> : <span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span> = <span class="id">Some</span> <span class="id">i0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFS</span>: <span class="id">defs</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>) <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMB</span> : <span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span> = <span class="id">Some</span> <span class="id">i</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span> = <span class="id">i0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7462')">Proof.</div>
<div class="proofscript" id="proof7462">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_LINKED</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H0</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">internals_linking</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNALS</span> : <span class="id">internals</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>) <span class="id">i</span> = <span class="id">true</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">internals</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>) <span class="id">i</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7463')">Proof.</div>
<div class="proofscript" id="proof7463">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_internals</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">INTERNALS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">prog_defmap_func_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">prog_defmap_gvar_exists_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_find_defs_same_rev2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">b</span> <span class="id">func</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNAL</span>: <span class="id">negb</span> (<span class="id">is_external_fd</span> (<span class="id">fundef_of_fundef</span> <span class="id">func</span>)) = <span class="id">true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">cp_link</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7464')">Proof.</div>
<div class="proofscript" id="proof7464">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">destruct</span> ((<span class="id">Genv.genv_defs</span> <span class="id">skenv_link</span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">GENVDEF</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma1</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eapply</span> <span class="id">defmap_with_signature</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span>. <span class="tactic">rewrite</span> <span class="id">GENVDEF</span>. <span class="tactic">rewrite</span> <span class="id">SYMBSKENV</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_func_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">defmap_with_signature</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">internals_linking</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_LINKED</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="id">exploit</span> <span class="id">defmap_with_signature</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">i</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_find_defs_same_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">b</span> <span class="id">if_sig</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">cp_link</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7465')">Proof.</div>
<div class="proofscript" id="proof7465">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_find_defs_same_rev2</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">field_offset_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f0</span> <span class="id">co</span> <span class="id">delta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span> : <span class="id">linkorder_program</span> <span class="id">cp</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPLETE</span> : <span class="id">complete_members</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) (<span class="id">co_members</span> <span class="id">co</span>) = <span class="id">true</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_offset</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">f0</span> (<span class="id">co_members</span> <span class="id">co</span>) = <span class="id">Errors.OK</span> <span class="id">delta</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_offset</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">f0</span> (<span class="id">co_members</span> <span class="id">co</span>) = <span class="id">Errors.OK</span> <span class="id">delta</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7466')">Proof.</div>
<div class="proofscript" id="proof7466">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">field_offset</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> 0 <span class="kwd">as</span> <span class="id">n</span>. <span class="tactic">clear</span> <span class="id">Heqn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">COMPLETE</span> <span class="id">FOC</span> <span class="id">EXTENDS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">cp</span> <span class="id">delta</span> <span class="id">f0</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id">co_members</span> <span class="id">co</span>) <span class="kwd">as</span> [| <span class="id">mhd</span> <span class="id">mtl</span>]; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">ss</span>); <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">mhd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ALIGN</span>: (<span class="id">align</span> <span class="id">n</span> (<span class="id">alignof</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">t</span>)) = (<span class="id">align</span> <span class="id">n</span> (<span class="id">alignof</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">t</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> -<span class="id">COMPLETE</span> <span class="id">EXTENDS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">t</span> <span class="id">n</span> <span class="id">cp</span> <span class="id">cp_link</span> <span class="id">COMPLETE</span> <span class="id">EXTENDS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="tactic">unfold</span> <span class="id">align_attr</span>; <span class="id">des_ifs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">EXTENDS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">EXTENDS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">EXTENDS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">EXTENDS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">ALIGN</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">ALIGN</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">andb_prop</span> <span class="kwd">in</span> <span class="id">COMPLETE</span>. <span class="id">des</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHmtl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">erewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_add_ptr_int_same1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">ty</span> <span class="id">CC</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>' <span class="id">k1</span> <span class="id">k2</span> <span class="id">ty0</span> <span class="id">si</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span> : <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Oadd</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span> : <span class="id">context</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">CC</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CLASSADD</span> : <span class="id">classify_add</span> <span class="id">ty1</span> <span class="id">ty2</span> = <span class="id">add_case_pi</span> <span class="id">ty0</span> <span class="id">si</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_add_ptr_int</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty0</span> <span class="id">si</span> <span class="id">v1</span> <span class="id">v2</span> = <span class="id">Some</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">sem_add_ptr_int</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">ty0</span> <span class="id">si</span> <span class="id">v1</span> <span class="id">v2</span> = <span class="id">Some</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7467')">Proof.</div>
<div class="proofscript" id="proof7467">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">classify_add</span> <span class="kwd">in</span> <span class="id">CLASSADD</span>; <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="id">des</span>; <span class="id">clarify</span>); <span class="tactic">unfold</span> <span class="id">sem_add_ptr_int</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_add_ptr_int_same2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">ty</span> <span class="id">CC</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>' <span class="id">k1</span> <span class="id">k2</span> <span class="id">ty0</span> <span class="id">si</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span> : <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Oadd</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span> : <span class="id">context</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">CC</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CLASSADD</span> : <span class="id">classify_add</span> <span class="id">ty1</span> <span class="id">ty2</span> = <span class="id">add_case_ip</span> <span class="id">si</span> <span class="id">ty0</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_add_ptr_int</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty0</span> <span class="id">si</span> <span class="id">v2</span> <span class="id">v1</span> = <span class="id">Some</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">sem_add_ptr_int</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">ty0</span> <span class="id">si</span> <span class="id">v2</span> <span class="id">v1</span> = <span class="id">Some</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7468')">Proof.</div>
<div class="proofscript" id="proof7468">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">classify_add</span> <span class="kwd">in</span> <span class="id">CLASSADD</span>; <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="id">des</span>; <span class="id">clarify</span>); <span class="tactic">unfold</span> <span class="id">sem_add_ptr_int</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_add_ptr_long_same1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">ty</span> <span class="id">CC</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>' <span class="id">k1</span> <span class="id">k2</span> <span class="id">ty0</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span> : <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Oadd</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span> : <span class="id">context</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">CC</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CLASSADD</span> : <span class="id">classify_add</span> <span class="id">ty1</span> <span class="id">ty2</span> = <span class="id">add_case_pl</span> <span class="id">ty0</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_add_ptr_long</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty0</span> <span class="id">v1</span> <span class="id">v2</span> = <span class="id">Some</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">sem_add_ptr_long</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">ty0</span> <span class="id">v1</span> <span class="id">v2</span> = <span class="id">Some</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7469')">Proof.</div>
<div class="proofscript" id="proof7469">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">classify_add</span> <span class="kwd">in</span> <span class="id">CLASSADD</span>; <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="id">des</span>; <span class="id">clarify</span>); <span class="tactic">unfold</span> <span class="id">sem_add_ptr_long</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_add_ptr_long_same2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">ty</span> <span class="id">CC</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>' <span class="id">k1</span> <span class="id">k2</span> <span class="id">ty0</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span> : <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Oadd</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span> : <span class="id">context</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">CC</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CLASSADD</span> : <span class="id">classify_add</span> <span class="id">ty1</span> <span class="id">ty2</span> = <span class="id">add_case_lp</span> <span class="id">ty0</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_add_ptr_long</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty0</span> <span class="id">v2</span> <span class="id">v1</span> = <span class="id">Some</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">sem_add_ptr_long</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">ty0</span> <span class="id">v2</span> <span class="id">v1</span> = <span class="id">Some</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7470')">Proof.</div>
<div class="proofscript" id="proof7470">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">classify_add</span> <span class="kwd">in</span> <span class="id">CLASSADD</span>; <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="id">des</span>; <span class="id">clarify</span>); <span class="tactic">unfold</span> <span class="id">sem_add_ptr_long</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>; <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>; <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a1</span>)). <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_sub_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">ty</span> <span class="id">CC</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>' <span class="id">k1</span> <span class="id">k2</span> <span class="id">k0</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTSRC</span> : <span class="id">wt_state</span> <span class="id">cp_link</span> <span class="id">ge_cp_link</span> (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Osub</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span> : <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Osub</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span> : <span class="id">context</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">CC</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_sub</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">m</span>' = <span class="id">Some</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">sem_sub</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">m</span>' = <span class="id">Some</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7471')">Proof.</div>
<div class="proofscript" id="proof7471">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sem_sub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">inv</span> <span class="id">WTSRC</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classify_sub</span> <span class="id">ty1</span> <span class="id">ty2</span>) <span class="id">eqn</span>:<span class="id">ClASSIFY</span>; <span class="tactic">unfold</span> <span class="id">classify_sub</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">try</span> <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a0</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a0</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a2</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a2</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a0</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z0</span> <span class="id">a0</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a2</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a2</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a0</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">typeconv</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tpointer</span> <span class="id">ty0</span> <span class="id">a2</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tarray</span> <span class="id">ty0</span> <span class="id">z</span> <span class="id">a2</span>)); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sem_add_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">ty</span> <span class="id">CC</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>' <span class="id">k1</span> <span class="id">k2</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span> : <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">CC</span> (<span class="id">Ebinop</span> <span class="id">Oadd</span> (<span class="kwd">Eval</span> <span class="id">v1</span> <span class="id">ty1</span>) (<span class="kwd">Eval</span> <span class="id">v2</span> <span class="id">ty2</span>) <span class="id">ty</span>)) <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span> : <span class="id">context</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">CC</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sem_add</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">m</span>' = <span class="id">Some</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id">sem_add</span> (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) <span class="id">v1</span> <span class="id">ty1</span> <span class="id">v2</span> <span class="id">ty2</span> <span class="id">m</span>' = <span class="id">Some</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7472')">Proof.</div>
<div class="proofscript" id="proof7472">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sem_add</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">sem_add_ptr_int_same1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">sem_add_ptr_long_same1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">sem_add_ptr_int_same2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">sem_add_ptr_long_same2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">free_list_exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">m</span> <span class="id">e</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTENV</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk</span> <span class="id">ty</span>, <span class="id">e</span> ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">blk</span>, <span class="id">ty</span>) -&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> (<span class="id">id</span> : <span class="id">positive</span>) (<span class="id">cmp</span> : <span class="id">composite</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FREE</span> : <span class="id">Mem.free_list</span> <span class="id">m</span> (<span class="id">blocks_of_env</span> (<span class="id">geof</span> <span class="id">cp_link</span>) <span class="id">e</span>) = <span class="id">Some</span> <span class="id">m</span>') :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Mem.free_list</span> <span class="id">m</span> (<span class="id">blocks_of_env</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">e</span>) = <span class="id">Some</span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7473')">Proof.</div>
<div class="proofscript" id="proof7473">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">blocks_of_env</span>, <span class="id">block_of_binding</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">WTENV0</span>: <span class="kwd">forall</span> <span class="id">p</span> <span class="id">blk</span> <span class="id">ty</span>, <span class="id">In</span> (<span class="id">p</span>, (<span class="id">blk</span>, <span class="id">ty</span>)) (<span class="id">PTree.elements</span> <span class="id">e</span>) -&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">PTree.elements_complete</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">FREE</span> <span class="id">EXTENDS</span> <span class="id">WTENV</span> <span class="id">WTENV0</span>. <span class="id">revert</span> <span class="id">m</span>' <span class="id">cp</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id">PTree.elements</span> <span class="id">e</span>); <span class="id">ss</span>. <span class="id">ii</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="tactic">eauto</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">WTENV0</span> <span class="id">p</span> <span class="id">b</span> <span class="id">t</span>). <span class="id">exploit</span> <span class="id">WTENV0</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="tactic">eauto</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">WTENV0</span> <span class="id">p</span> <span class="id">b</span> <span class="id">t</span>). <span class="id">exploit</span> <span class="id">WTENV0</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">free_list_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">m</span> <span class="id">e</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTENV</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk</span> <span class="id">ty</span>, <span class="id">e</span> ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">blk</span>, <span class="id">ty</span>) -&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span> : <span class="kwd">forall</span> (<span class="id">id</span> : <span class="id">positive</span>) (<span class="id">cmp</span> : <span class="id">composite</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FREE</span> : <span class="id">Mem.free_list</span> <span class="id">m</span> (<span class="id">blocks_of_env</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">e</span>) = <span class="id">Some</span> <span class="id">m</span>'):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Mem.free_list</span> <span class="id">m</span> (<span class="id">blocks_of_env</span> <span class="id">ge_cp_link</span> <span class="id">e</span>) = <span class="id">Some</span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7474')">Proof.</div>
<div class="proofscript" id="proof7474">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">blocks_of_env</span>, <span class="id">block_of_binding</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">WTENV0</span>: <span class="kwd">forall</span> <span class="id">p</span> <span class="id">blk</span> <span class="id">ty</span>, <span class="id">In</span> (<span class="id">p</span>, (<span class="id">blk</span>, <span class="id">ty</span>)) (<span class="id">PTree.elements</span> <span class="id">e</span>) -&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">PTree.elements_complete</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">FREE</span> <span class="id">EXTENDS</span> <span class="id">WTENV</span> <span class="id">WTENV0</span>. <span class="id">revert</span> <span class="id">m</span>' <span class="id">cp</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id">PTree.elements</span> <span class="id">e</span>); <span class="id">ss</span>. <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="tactic">eauto</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">WTENV0</span> <span class="id">p</span> <span class="id">b</span> <span class="id">t</span>). <span class="id">exploit</span> <span class="id">WTENV0</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span> <span class="kwd">in</span> <span class="id">Heq0</span>; <span class="tactic">eauto</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">WTENV0</span> <span class="id">p</span> <span class="id">b</span> <span class="id">t</span>). <span class="id">exploit</span> <span class="id">WTENV0</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">alignof_blockcopy_wt_stable</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">ce</span> <span class="id">ce</span>' (<span class="id">extends</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id">ce</span>!<span class="id">id</span> = <span class="id">Some</span> <span class="id">co</span> -&gt; <span class="id">ce</span>'!<span class="id">id</span> = <span class="id">Some</span> <span class="id">co</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_type</span> <span class="id">ce</span> <span class="id">t</span> = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">alignof_blockcopy</span> <span class="id">ce</span> <span class="id">t</span> = <span class="id">alignof_blockcopy</span> <span class="id">ce</span>' <span class="id">t</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7475')">Proof.</div>
<div class="proofscript" id="proof7475">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">ce</span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">extends</span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">ce</span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">extends</span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">alloc_variables_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">m</span> <span class="id">e</span> <span class="id">m1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span> : <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">t</span> : <span class="id">type</span> =&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">t</span>) (<span class="id">map</span> <span class="id">snd</span> (<span class="id">fn_params</span> <span class="id">f</span> ++ <span class="id">fn_vars</span> <span class="id">f</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ALLOC</span> : <span class="id">alloc_variables</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">empty_env</span> <span class="id">m</span> (<span class="id">fn_params</span> <span class="id">f</span> ++ <span class="id">fn_vars</span> <span class="id">f</span>) <span class="id">e</span> <span class="id">m1</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">alloc_variables</span> <span class="id">ge_cp_link</span> <span class="id">empty_env</span> <span class="id">m</span> (<span class="id">fn_params</span> <span class="id">f</span> ++ <span class="id">fn_vars</span> <span class="id">f</span>) <span class="id">e</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7476')">Proof.</div>
<div class="proofscript" id="proof7476">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EMPTY</span>:<span class="kwd">forall</span> <span class="id">i</span> <span class="id">blk</span> <span class="id">ty</span>, <span class="id">empty_env</span> ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">blk</span>, <span class="id">ty</span>) -&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">erewrite</span> <span class="id">PTree.gempty</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">fn_params</span> <span class="id">f</span> ++ <span class="id">fn_vars</span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> <span class="id">empty_env</span> <span class="kwd">as</span> <span class="id">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heqev</span> <span class="id">Heql</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">l</span>; <span class="id">i</span>; <span class="id">ss</span>; <span class="id">inv</span> <span class="id">ALLOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WT</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">id</span> = <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gss</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">WT</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree.gso</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">bind_parameters_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">vargs</span>  <span class="id">m1</span> <span class="id">e</span> <span class="id">m2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span> : <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">t</span> : <span class="id">type</span> =&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">t</span>) (<span class="id">map</span> <span class="id">snd</span> (<span class="id">fn_params</span> <span class="id">f</span> ++ <span class="id">fn_vars</span> <span class="id">f</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span>, (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BIND</span> : <span class="id">bind_parameters</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">e</span> <span class="id">m1</span> (<span class="id">fn_params</span> <span class="id">f</span>) <span class="id">vargs</span> <span class="id">m2</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind_parameters</span> <span class="id">skenv_link</span> <span class="id">ge_cp_link</span> <span class="id">e</span> <span class="id">m1</span> (<span class="id">fn_params</span> <span class="id">f</span>) <span class="id">vargs</span> <span class="id">m2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7477')">Proof.</div>
<div class="proofscript" id="proof7477">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EMPTY</span>:<span class="kwd">forall</span> <span class="id">i</span> <span class="id">blk</span> <span class="id">ty</span>, <span class="id">empty_env</span> ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">blk</span>, <span class="id">ty</span>) -&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp</span>) <span class="id">ty</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">erewrite</span> <span class="id">PTree.gempty</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">fn_params</span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Heql</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">l</span>; <span class="id">i</span>; <span class="id">ss</span>; <span class="id">inv</span> <span class="id">BIND</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">erewrite</span> &lt;- <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:=<span class="id">f</span>). <span class="id">ss</span>. <span class="id">inv</span> <span class="id">WT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">preservation_alloc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp_top</span> <span class="id">m1</span> <span class="id">e</span> <span class="id">l</span> <span class="id">m0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOCUS1</span> : <span class="id">is_focus</span> <span class="id">cp_top</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ALLOC</span> : <span class="id">alloc_variables</span> <span class="id">ge_cp_link</span> <span class="id">empty_env</span> <span class="id">m0</span> <span class="id">l</span> <span class="id">e</span> <span class="id">m1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMP</span> : <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">t</span> : <span class="id">type</span> =&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp_top</span>) <span class="id">t</span>) (<span class="id">map</span> <span class="id">snd</span> <span class="id">l</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">alloc_variables</span> (<span class="id">geof</span> <span class="id">cp_top</span>) <span class="id">empty_env</span> <span class="id">m0</span> <span class="id">l</span> <span class="id">e</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7478')">Proof.</div>
<div class="proofscript" id="proof7478">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ALLOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">inv</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, (<span class="id">prog_comp_env</span> <span class="id">cp_top</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">co</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">co</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>. <span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">IHALLOC</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">preservation_bind_param</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp_top</span> <span class="id">m1</span> <span class="id">e</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">m2</span> <span class="id">vs_arg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOCUS1</span> : <span class="id">is_focus</span> <span class="id">cp_top</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PARAM</span> : <span class="id">bind_parameters</span> <span class="id">skenv_link</span> <span class="id">ge_cp_link</span> <span class="id">e</span> <span class="id">m1</span> <span class="id">l</span> <span class="id">vs_arg</span> <span class="id">m2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMP</span> : <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">t</span> : <span class="id">type</span> =&gt; <span class="id">wt_type</span> (<span class="id">prog_comp_env</span> <span class="id">cp_top</span>) <span class="id">t</span>) (<span class="id">map</span> <span class="id">snd</span> (<span class="id">l</span> ++ <span class="id">l</span>'))):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind_parameters</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp_top</span>) <span class="id">e</span> <span class="id">m1</span> <span class="id">l</span> <span class="id">vs_arg</span> <span class="id">m2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7479')">Proof.</div>
<div class="proofscript" id="proof7479">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">PARAM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">inv</span> <span class="id">COMP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHPARAM</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 2; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, (<span class="id">prog_comp_env</span> <span class="id">cp_top</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">co</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">co</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>. <span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des_safe</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>; <span class="id">econs</span> 3; <span class="tactic">eauto</span>; <span class="id">ss</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="id">i</span>; <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H10</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Scheme</span> <span class="id">statement_ind2</span> := <span class="kwd">Induction</span> <span class="kwd">for</span> <span class="id">statement</span> <span class="kwd">Sort</span> <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">labeled_statements_ind2</span> := <span class="kwd">Induction</span> <span class="kwd">for</span> <span class="id">labeled_statements</span> <span class="kwd">Sort</span> <span class="kwd">Prop</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_label_same_None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span> <span class="id">k0</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span> : <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LABEL</span> : <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7480')">Proof.</div>
<div class="proofscript" id="proof7480">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_until</span> <span class="id">s</span>. <span class="id">revert</span> <span class="id">s</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">statement_ind2</span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span> -&gt; <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) = <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">sl</span> =&gt; <span class="kwd">forall</span> <span class="id">K</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> <span class="id">k</span> = <span class="id">None</span> -&gt; <span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) = <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;); <span class="id">ss</span>; <span class="id">i</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; (<span class="tactic">try</span> <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="tactic">try</span> <span class="id">Eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">ss</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_label_same_None</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span> <span class="id">k0</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> <span class="id">k</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span> : <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LABEL</span> : <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span>' = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7481')">Proof.</div>
<div class="proofscript" id="proof7481">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_until</span> <span class="id">s</span>. <span class="id">revert</span> <span class="id">s</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">statement_ind2</span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span> <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span> -&gt; <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span>' = <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">sl</span> =&gt; <span class="kwd">forall</span> <span class="id">K</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span> <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> <span class="id">k</span> = <span class="id">None</span> -&gt; <span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> <span class="id">k</span>' = <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;); <span class="id">ss</span>; <span class="id">i</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; (<span class="tactic">try</span> <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="tactic">try</span> <span class="id">Eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="id">all</span>:<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_label_exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span> <span class="id">k0</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>' <span class="id">k1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span> : <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LABEL</span> : <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>')) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k1</span>', <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k1</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k1</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7482')">Proof.</div>
<div class="proofscript" id="proof7482">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">SUM</span>. <span class="id">revert_until</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span>. <span class="tactic">clear</span> <span class="id">INCL_FOCUS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">statement_ind2</span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt;  <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>' <span class="id">k1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt; <span class="id">exists</span> <span class="id">k1</span>', <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k1</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k1</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">sl</span> =&gt; <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>' <span class="id">k1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> <span class="id">k</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>') -&gt; <span class="id">exists</span> <span class="id">k1</span>', <span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> <span class="id">k1</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k1</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;); <span class="id">ss</span>; <span class="id">ii</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">i</span>; <span class="id">des_ifs</span>; <span class="tactic">eauto</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">des_ifs</span>; <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Heq0</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Heq2</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>'; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_label_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span> <span class="id">k0</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span> : <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LABEL</span> : <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>')) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">app_cont</span> <span class="id">k</span>' <span class="id">k0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7483')">Proof.</div>
<div class="proofscript" id="proof7483">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">SUM</span>. <span class="id">revert_until</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span>. <span class="tactic">clear</span> <span class="id">INCL_FOCUS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">statement_ind2</span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt;  <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt; <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">app_cont</span> <span class="id">k</span>' <span class="id">k0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">sl</span> =&gt; <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k0</span> <span class="id">tl_tgt</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> <span class="id">k</span> = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>') -&gt; <span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">sl</span> (<span class="id">app_cont</span> <span class="id">k</span> <span class="id">k0</span>) = <span class="id">Some</span> (<span class="id">s</span>', <span class="id">app_cont</span> <span class="id">k</span>' <span class="id">k0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;); <span class="id">ss</span>; <span class="id">ii</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">i</span>; <span class="id">des_ifs</span>; <span class="tactic">eauto</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">des_ifs</span>; <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Heq0</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Heq2</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">find_label_same_None</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">Eq</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WFSRC</span>: <span class="kwd">forall</span> <span class="id">md</span> : <span class="id">Mod.t</span>, <span class="id">In</span> <span class="id">md</span> <span class="id">prog_src</span> -&gt; <span class="id">Sk.wf</span> <span class="id">md</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WFTGT</span>: <span class="kwd">forall</span> <span class="id">md</span> : <span class="id">Mod.t</span>, <span class="id">In</span> <span class="id">md</span> <span class="id">prog_tgt</span> -&gt; <span class="id">Sk.wf</span> <span class="id">md</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lred_progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">f</span> <span class="id">C</span> <span class="id">a</span> <span class="id">k3</span> <span class="id">k0</span> <span class="id">e</span> <span class="id">m</span> <span class="id">a</span>' <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CTX</span>: <span class="id">context</span> <span class="id">LV</span> <span class="id">RV</span> <span class="id">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTSRC</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> <span class="id">ge_cp_link</span> (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">C</span> <span class="id">a</span>) (<span class="id">app_cont</span> <span class="id">k3</span> <span class="id">k0</span>) <span class="id">e</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">ExprState</span> <span class="id">f</span> (<span class="id">C</span> <span class="id">a</span>) <span class="id">k3</span> <span class="id">e</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> (<span class="id">id</span> : <span class="id">positive</span>) (<span class="id">cmp</span> : <span class="id">composite</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span> -&gt; (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LRED</span>: <span class="id">lred</span> <span class="id">ge_cp_link</span> <span class="id">e</span> <span class="id">a</span> <span class="id">m</span> <span class="id">a</span>' <span class="id">m</span>'):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a1</span> <span class="id">m1</span>, <span class="id">lred</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">e</span> <span class="id">a</span> <span class="id">m</span> <span class="id">a1</span> <span class="id">m1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7484')">Proof.</div>
<div class="proofscript" id="proof7484">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LRED</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">wt_rvalue_wt_expr</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">WTTENV</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">des</span>; <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="id">econs</span> 2; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="id">econs</span> 3; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tstruct</span> <span class="id">id</span> <span class="id">a0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="id">econs</span> 4; <span class="tactic">eauto</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">field_offset_same</span>; <span class="tactic">eauto</span>. <span class="id">exploit</span> <span class="id">EXTENDS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">linkorder_program</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">clear</span> - <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id">linkorder_program</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">linkorder_program</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">ss</span>. <span class="id">des</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">prog_comp_env_eq</span> <span class="id">cp</span>); <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">build_composite_env_consistent</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">co_consistent_complete</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tunion</span> <span class="id">id</span> <span class="id">a0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="id">econs</span> 5; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">match_focus_state_bsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cst_src0</span> <span class="id">cst_tgt0</span> <span class="id">cst_tgt1</span> <span class="id">k0</span> <span class="id">cp</span> <span class="id">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ST</span>: <span class="id">match_focus_state</span> <span class="id">cst_src0</span> <span class="id">cst_tgt0</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ISFOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTSRC</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> (<span class="id">geof</span> <span class="id">cp_link</span>) <span class="id">cst_src0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">cst_tgt0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STEP</span>: <span class="id">Csem.step</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">cst_tgt0</span> <span class="id">tr</span> <span class="id">cst_tgt1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span>: <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">STEP</span>: <span class="id">Csem.step</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp_link</span>) <span class="id">cst_src0</span> <span class="id">tr</span> (<span class="id">matched_state_source</span> <span class="id">cst_tgt1</span> <span class="id">k0</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7485')">Proof.</div>
<div class="proofscript" id="proof7485">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">FOC</span>: <span class="id">linkorder</span> <span class="id">cp</span> <span class="id">cp_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">cst_tgt1</span> <span class="kwd">as</span> <span class="id">XXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span> (<span class="id">IN</span>: (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">IN</span>: (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>&gt;&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">linkorder_program</span> <span class="kwd">in</span> <span class="id">FOC</span>. <span class="id">inv</span> <span class="id">FOC</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">NW</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">STEP</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">STEP</span>; <span class="id">inv</span> <span class="id">ST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;lred&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 2; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_symbol</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_key_spec</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">FOC</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">ss</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp</span> <span class="id">x</span>) <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> *. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp_link</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="id">exists</span> <span class="id">gd2</span>. <span class="tactic">eauto</span>. } <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">prog_comp_env_eq</span> <span class="id">cp</span>); <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">build_composite_env_consistent</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">co_consistent_complete</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">field_offset_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rred&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">C</span> <span class="id">into</span> <span class="id">CC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">WTTGT</span>; <span class="tactic">subst</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> (<span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">op</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">sem_add_same</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">sem_sub_same</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rpapply</span> <span class="id">red_sizeof</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H0</span> <span class="id">WTTGT</span> <span class="id">WTYE</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rpapply</span> <span class="id">red_alignof</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">wt_type_alignof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H0</span> <span class="id">WTTGT</span> <span class="id">WTYE</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 2; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;lred&nbsp;progress&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">lred_progress</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">econs</span> 4; <span class="tactic">eauto</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span> 4; <span class="tactic">eauto</span>. <span class="id">econs</span> 4; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">sem_binary_operation</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">H3</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">sem_add_same</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">H3</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">sem_sub_same</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H2</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">WTSRC</span>. <span class="tactic">eapply</span> <span class="id">WTTGT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">WTTGT</span>; <span class="tactic">subst</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>; <span class="id">econs</span> 4; <span class="tactic">eauto</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 2; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 3; <span class="tactic">eauto</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 5; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEP</span>; <span class="id">inv</span> <span class="id">ST</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">step_return_0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">free_list_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">erewrite</span> <span class="id">call_cont_app_cont</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">step_return_2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">free_list_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">erewrite</span> <span class="id">call_cont_app_cont</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">step_skip_call</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">Cstrategy.is_call_cont_call_cont</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H</span> <span class="id">T</span> <span class="id">SUM</span>. <span class="tactic">unfold</span> <span class="id">is_call_cont</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">SUM</span>; <span class="id">ss</span>. <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">free_list_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">step_goto</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">H</span> <span class="id">SUM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">call_cont_app_cont</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">fn_body</span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">s</span>. <span class="tactic">clear</span> <span class="id">Heqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">call_cont</span> <span class="id">k</span>) <span class="kwd">as</span> <span class="id">k1</span>. <span class="tactic">clear</span> <span class="id">Heqk1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">find_label_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">WTTGT</span>; <span class="tactic">subst</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">WTLOCAL</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">WT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">step_internal_function</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_find_defs_same_rev</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">alloc_variables_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">bind_parameters_same</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">is_external_ef</span> <span class="id">ef</span>)) <span class="id">eqn</span>:<span class="id">EXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">CSkEnv.project_revive_no_external</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">SkEnv.load_skenv_wf</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">link_list_preserves_wf_sk</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id">step_external_function</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:=<span class="id">cc</span>). <span class="id">instantiate</span> (1 := <span class="id">tres</span>). <span class="id">instantiate</span> (1 := <span class="id">targs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_find_defs_same_rev2</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ef</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">match_focus_state_progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cst_src0</span> <span class="id">cst_tgt0</span> <span class="id">cst_src1</span> <span class="id">k0</span> <span class="id">cp</span> <span class="id">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NCALLTGT</span> : ~ <span class="id">exists</span> <span class="id">args</span>, <span class="id">at_external</span> <span class="id">skenv_link</span> <span class="id">cp</span> <span class="id">cst_tgt0</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NCALLSRC</span> : ~ <span class="id">exists</span> <span class="id">args</span>, <span class="id">at_external</span> <span class="id">skenv_link</span> <span class="id">cp_link</span> <span class="id">cst_src0</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NRETTGT</span> : ~ <span class="id">ModSem.is_return</span> (<span class="id">modsem</span> <span class="id">skenv_link</span> <span class="id">cp</span>) <span class="id">cst_tgt0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NRETSRC</span> : ~ <span class="id">ModSem.is_return</span> (<span class="id">modsem</span> <span class="id">skenv_link</span> <span class="id">cp_link</span>) <span class="id">cst_src0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ST</span>: <span class="id">match_focus_state</span> <span class="id">cst_src0</span> <span class="id">cst_tgt0</span> <span class="id">k0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ISFOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTSRC</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> (<span class="id">geof</span> <span class="id">cp_link</span>) <span class="id">cst_src0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">cst_tgt0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STEP</span>: <span class="id">Csem.step</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp_link</span>) <span class="id">cst_src0</span> <span class="id">tr</span> <span class="id">cst_src1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span>: <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k0</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">STEP</span>: <span class="id">exists</span> <span class="id">cst_tgt1</span>, <span class="id">Csem.step</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">cst_tgt0</span> <span class="id">tr</span> <span class="id">cst_tgt1</span>&gt;&gt;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7486')">Proof.</div>
<div class="proofscript" id="proof7486">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">FOC</span>: <span class="id">linkorder</span> <span class="id">cp</span> <span class="id">cp_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">cst_src1</span> <span class="kwd">as</span> <span class="id">XXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">cmp</span> (<span class="id">IN</span>: (<span class="id">prog_comp_env</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">IN</span>: (<span class="id">prog_comp_env</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">cmp</span>&gt;&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">linkorder_program</span> <span class="kwd">in</span> <span class="id">FOC</span>. <span class="id">inv</span> <span class="id">FOC</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">NW</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">STEP</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">STEP</span>; <span class="id">inv</span> <span class="id">ST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;lred&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">lred_progress</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="id">left</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rred&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rename</span> <span class="id">C</span> <span class="id">into</span> <span class="id">CC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">WTTGT</span>; <span class="tactic">subst</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">by</span> (<span class="id">eexists</span>; <span class="id">econs</span>; <span class="id">econs</span> 2; <span class="tactic">eauto</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eexists</span>; <span class="id">econs</span>; <span class="id">econs</span> 2; <span class="tactic">eauto</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">sem_add_same</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">sem_sub_same</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eexists</span>. <span class="id">econs</span>. <span class="id">econs</span> 2; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span>  <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">econs</span>. <span class="id">econs</span> 3; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">econs</span>. <span class="id">econs</span> 4; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 2; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span> 3; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">m</span>'). <span class="id">instantiate</span> (1:=(<span class="id">Eloc</span> <span class="id">b</span> <span class="id">Ptrofs.zero</span> <span class="id">ty</span>)). <span class="id">econs</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="id">econs</span> 3; <span class="tactic">eauto</span>. <span class="id">econs</span> 2; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_symbol</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_filter_key_spec</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp</span> <span class="id">x</span>) <span class="tactic">by</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id">defs</span> <span class="id">cp_link</span> <span class="id">x</span>) <span class="tactic">by</span> (<span class="id">ii</span>; <span class="id">clarify</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> *. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">gd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">prog_defmap_exists_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">Gfun</span> <span class="id">func</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">prog_defmap_gvar_exists_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">Gvar</span> <span class="id">var</span>'). <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span> 3; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">econs</span> 3; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tstruct</span> <span class="id">id</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">econs</span> 4; <span class="tactic">eauto</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">field_offset_same</span>; <span class="tactic">eauto</span>. <span class="id">exploit</span> <span class="id">EXTENDS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">prog_comp_env_eq</span> <span class="id">cp</span>); <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">build_composite_env_consistent</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">co_consistent_complete</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">exploit</span> (<span class="id">WTYE</span> (<span class="id">Tunion</span> <span class="id">id</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">econs</span> 5; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">econs</span> 4; <span class="tactic">eauto</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span> 4; <span class="tactic">eauto</span>. <span class="id">econs</span> 4; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">sem_binary_operation</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">H3</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">sem_add_same</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">H3</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">sem_sub_same</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H2</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">WTSRC</span>. <span class="tactic">eapply</span> <span class="id">WTTGT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">context_compose</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">WTTGT</span>; <span class="tactic">subst</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">types_of_context1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tys</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>; <span class="id">econs</span> 4; <span class="tactic">eauto</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 2; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 3; <span class="tactic">eauto</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id">alignof_blockcopy_wt_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>; <span class="id">ss</span>; <span class="tactic">auto</span>; <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> &lt;- <span class="id">wt_type_sizeof_stable</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">WTYE</span> <span class="id">ty1</span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span> 5; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="tactic">inversion</span> <span class="id">STEP</span>; <span class="tactic">subst</span>; <span class="id">inv</span> <span class="id">ST</span>; <span class="id">ss</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">eexists</span>; <span class="id">right</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">try</span> <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">k3</span>; <span class="tactic">destruct</span> <span class="id">k0</span>; <span class="id">ss</span>; <span class="id">clarify</span>; <span class="tactic">try</span> (<span class="tactic">by</span>  <span class="id">eexists</span>; <span class="id">right</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SUM</span>; <span class="tactic">unfold</span> <span class="id">is_call_cont_strong</span> <span class="kwd">in</span> <span class="id">CALL</span>; <span class="id">des_ifs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">step_return_0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">exploit</span> <span class="id">free_list_exists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">k3</span>; <span class="tactic">destruct</span> <span class="id">k0</span>; <span class="id">ss</span>; <span class="id">clarify</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SUM</span>; <span class="tactic">unfold</span> <span class="id">is_call_cont_strong</span> <span class="kwd">in</span> *; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eexists</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">step_return_2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">exploit</span> <span class="id">free_list_exists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eexists</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">step_return_2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">exploit</span> <span class="id">free_list_exists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">right</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">step_skip_call</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">Cstrategy.is_call_cont_call_cont</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H</span> <span class="id">T</span> <span class="id">SUM</span>. <span class="tactic">unfold</span> <span class="id">is_call_cont</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k3</span>; <span class="tactic">destruct</span> <span class="id">k0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SUM</span>; <span class="id">ss</span>. <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k3</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k3</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">free_list_exists</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> -<span class="id">H</span> <span class="id">SUM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">call_cont_app_cont</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">find_label_exists</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="id">right</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">step_goto</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">lift_option</span> (<span class="id">Genv.find_funct</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">fptr</span>)) <span class="kwd">as</span> [[<span class="id">gd</span> <span class="id">TG</span>] | <span class="id">TG</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">gd</span> = <span class="id">Internal</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SKENV</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>, <span class="id">Heq1</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">LINKSYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">PROGSYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FPTR</span>, <span class="id">TG</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp_link</span> <span class="id">i0</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma2</span>. <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i1</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp</span> <span class="id">i1</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma1</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i1</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i1</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_internals</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="tactic">rewrite</span> <span class="id">DMAP0</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_func_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">step_internal_function</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">preservation_alloc</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">preservation_bind_param</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;not&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">NCALLTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Genv.find_funct</span> <span class="id">skenv_link</span> <span class="id">fptr</span> = <span class="id">Some</span> (<span class="id">AST.Internal</span> (<span class="id">signature_of_function</span> <span class="id">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">SkEnv.wf</span> <span class="id">skenv_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">SkEnv.load_skenv_wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">link_list_preserves_wf_sk</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dup</span> <span class="id">FPTR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_LINKED</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Genv.find_def</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">AST.Internal</span> (<span class="id">signature_of_function</span> <span class="id">f</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SKENV</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">CPLINKSYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp_link</span> <span class="id">i0</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma2</span>. <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">clear</span> - <span class="id">DMAP</span> <span class="id">DMAP0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">skdefs_of_gdefs</span> <span class="kwd">in</span> <span class="id">DMAP</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">prog_defmap_update_snd</span> <span class="kwd">in</span> <span class="id">DMAP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DMAP0</span> <span class="kwd">in</span> *. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">DEFKEPT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LO</span>. <span class="id">inv</span> <span class="id">H6</span>.  <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">signature_of_function</span>. <span class="tactic">unfold</span> <span class="id">signature_of_type</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="id">remember</span> (<span class="id">fn_params</span> <span class="id">f</span>) <span class="kwd">as</span> <span class="id">l</span>. <span class="tactic">clear</span> <span class="id">Heql</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>. <span class="id">ss</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">a</span>. <span class="id">ss</span>. <span class="id">clarify</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">WTK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">WTKS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id">fundef</span> <span class="kwd">in</span> *. <span class="id">Eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">lift_option</span> (<span class="id">Genv.find_funct</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">fptr</span>)) <span class="kwd">as</span> [[<span class="id">gd</span> <span class="id">TG</span>] | <span class="id">TG</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">gd</span> = (<span class="id">External</span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SKENV</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>, <span class="id">Heq1</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">LINKSYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">PROGSYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FPTR</span>, <span class="id">TG</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp_link</span> <span class="id">i0</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma2</span>. <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i1</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp</span> <span class="id">i1</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma1</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i1</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i1</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_internals</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="tactic">rewrite</span> <span class="id">DMAP0</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_func_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id">step_external_function</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;not&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">NCALLTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="id">dup</span> <span class="id">FPTR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">CPLINKSYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">defs</span> <span class="id">cp_link</span> <span class="id">i0</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma2</span>. <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Genv.find_funct</span> <span class="id">skenv_link</span> (<span class="id">Vptr</span> <span class="id">b</span> <span class="id">Ptrofs.zero</span>) = <span class="id">Some</span> (<span class="id">AST.External</span> <span class="id">ef</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">SkEnv.wf</span> <span class="id">skenv_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">SkEnv.load_skenv_wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">link_list_preserves_wf_sk</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_LINKED</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Genv.find_def</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">AST.External</span> <span class="id">ef</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SKENV</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">DMAP</span> <span class="id">DMAP0</span>. <span class="tactic">rewrite</span> <span class="id">DMAP</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">skdefs_of_gdefs</span> <span class="kwd">in</span> <span class="id">DMAP</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">prog_defmap_update_snd</span> <span class="kwd">in</span> <span class="id">DMAP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DMAP0</span> <span class="kwd">in</span> *. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">DEFKEPT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LO</span>. <span class="id">inv</span> <span class="id">H4</span>; <span class="id">des_ifs</span>; <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTPROGLINK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP0</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">PTree_Properties.in_of_list</span> <span class="kwd">in</span> <span class="id">DMAP0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">CSTYLE_EXTERN_LINK</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_ifs</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">WTKS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id">fundef</span> <span class="kwd">in</span> *. <span class="id">Eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">k3</span>; <span class="tactic">destruct</span> <span class="id">k0</span>; <span class="id">ss</span>; <span class="id">clarify</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">eexists</span>; <span class="id">right</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SUM</span>. <span class="tactic">unfold</span> <span class="id">is_call_cont_strong</span> <span class="kwd">in</span> <span class="id">CALL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">NRETTGT</span>. <span class="id">ss</span>. <span class="id">econs</span>. <span class="tactic">unfold</span> <span class="id">ModSem.final_frame</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="id">all</span>:<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">SIM</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
