
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CoqlibC</title>
<meta name="description" content="Documentation of Coq module CoqlibC" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CoqlibC</h1>
<div class="coq">
<div class="doc">copied &amp;&amp; added "C" *</div>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">ZArith</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Znumtheory</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">List</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Bool</span>.<br/>
<br/>
<div class="doc">newly added *</div>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Coqlib</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">check_safe</span> := <span class="kwd">let</span> <span class="id">n</span> := <span class="id">numgoals</span> <span class="kwd">in</span> <span class="id">guard</span> <span class="id">n</span> &lt; 2.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">sflib</span>.<br/>
<span class="id">From</span> <span class="id">Paco</span> <span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">paco</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Basics</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Relations</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">RelationClasses</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Wellfounded</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Classical_Prop</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Lia</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">AxiomsC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Relation_Operators</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">List</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">determ_tac</span> <span class="id">LEMMA</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tac</span> := <span class="tactic">eauto</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="id">rev_all</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="tactic">apply</span> <span class="id">f</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">y</span> := <span class="id">all</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="tactic">apply</span> <span class="id">f</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">first</span>[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">LEMMA</span>; [<span class="id">x</span>|<span class="id">y</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exploit</span> <span class="id">LEMMA</span>; [<span class="id">tac</span>|<span class="id">x</span>|<span class="id">y</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exploit</span> <span class="id">LEMMA</span>; [<span class="id">tac</span>|<span class="id">tac</span>|<span class="id">x</span>|<span class="id">y</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exploit</span> <span class="id">LEMMA</span>; [<span class="id">tac</span>|<span class="id">tac</span>|<span class="id">tac</span>|<span class="id">x</span>|<span class="id">y</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exploit</span> <span class="id">LEMMA</span>; [<span class="id">tac</span>|<span class="id">tac</span>|<span class="id">tac</span>|<span class="id">tac</span>|<span class="id">x</span>|<span class="id">y</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;];<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">update_fst</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>: <span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">C</span>) (<span class="id">ab</span>: <span class="id">A</span> * <span class="id">B</span>): <span class="id">C</span> * <span class="id">B</span> := (<span class="id">f</span> <span class="id">ab</span>.(<span class="id">fst</span>), <span class="id">ab</span>.(<span class="id">snd</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">update_snd</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>: <span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id">B</span> -&gt; <span class="id">C</span>) (<span class="id">ab</span>: <span class="id">A</span> * <span class="id">B</span>): <span class="id">A</span> * <span class="id">C</span> := (<span class="id">ab</span>.(<span class="id">fst</span>), <span class="id">f</span> <span class="id">ab</span>.(<span class="id">snd</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">dep_split_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Prop</span>) (<span class="id">PA</span>: <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PB</span>: &lt;&lt;<span class="id">LEFT</span>: <span class="id">A</span>&gt;&gt; -&gt; <span class="id">B</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SPLIT</span>: <span class="id">A</span> /\ <span class="id">B</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6192')">Proof.</div>
<div class="proofscript" id="proof6192">
 <span class="tactic">split</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">dep_split_left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PA</span>: &lt;&lt;<span class="id">RIGHT</span>: <span class="id">B</span>&gt;&gt; -&gt; <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PB</span>: <span class="id">B</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> /\ <span class="id">B</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6193')">Proof.</div>
<div class="proofscript" id="proof6193">
 <span class="tactic">split</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_forall2_map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> (<span class="id">f</span>: <span class="id">X</span> -&gt; <span class="id">Y</span>) <span class="id">xs</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; <span class="id">x1</span> = <span class="id">f</span> <span class="id">x0</span>) <span class="id">xs</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">xs</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6194')">Proof.</div>
<div class="proofscript" id="proof6194">
 <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_forall2_map_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> (<span class="id">f</span>: <span class="id">X</span> -&gt; <span class="id">Y</span>) <span class="id">xs</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; <span class="id">x0</span> = <span class="id">f</span> <span class="id">x1</span>) (<span class="id">map</span> <span class="id">f</span> <span class="id">xs</span>) <span class="id">xs</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6195')">Proof.</div>
<div class="proofscript" id="proof6195">
 <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_app</span> <span class="id">A</span> <span class="id">P</span> (<span class="id">l0</span> <span class="id">l1</span>: <span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL0</span>: <span class="id">Forall</span> <span class="id">P</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL1</span>: <span class="id">Forall</span> <span class="id">P</span> <span class="id">l1</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> (<span class="id">l0</span> ++ <span class="id">l1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6196')">Proof.</div>
<div class="proofscript" id="proof6196">
 <span class="id">ginduction</span> <span class="id">l0</span>; <span class="id">i</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">FORALL0</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_forall2_stronger</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> <span class="id">xs</span> <span class="id">ys</span> (<span class="id">P</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="kwd">Prop</span>) <span class="id">Q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL2</span>: <span class="id">list_forall2</span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STRONGER</span>: <span class="id">P</span> &lt;2= <span class="id">Q</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">FORALL2</span>: <span class="id">list_forall2</span> <span class="id">Q</span> <span class="id">xs</span> <span class="id">ys</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6197')">Proof.</div>
<div class="proofscript" id="proof6197">
 <span class="id">ginduction</span> <span class="id">FORALL2</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">IHFORALL2</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">incl_PreOrder</span> {<span class="id">A</span>}: <span class="id">PreOrder</span> (@<span class="id">incl</span> <span class="id">A</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6198')">Next Obligation.</div>
<div class="proofscript" id="proof6198">
 <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6199')">Next Obligation.</div>
<div class="proofscript" id="proof6199">
 <span class="id">ii</span>. <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">is_some</span> {<span class="id">X</span>} (<span class="id">x</span>: <span class="id">option</span> <span class="id">X</span>): <span class="id">bool</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">_</span> =&gt; <span class="id">true</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">false</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">is_none</span> {<span class="id">X</span>} := <span class="id">negb</span> &lt;*&gt; (@<span class="id">is_some</span> <span class="id">X</span>).<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">is_some</span> <span class="id">is_none</span>.<br/>
<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">x</span> $" := (<span class="id">x</span>.(<span class="id">proj1_sig</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span> ).<br/>
<br/>
<span class="kwd">Notation</span> <span class="id">top1</span> := (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">True</span>).<br/>
<span class="kwd">Notation</span> <span class="id">top2</span> := (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">True</span>).<br/>
<span class="kwd">Notation</span> <span class="id">top3</span> := (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">True</span>).<br/>
<span class="kwd">Notation</span> <span class="id">top4</span> := (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">True</span>).<br/>
<span class="kwd">Notation</span> <span class="id">top5</span> := (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">True</span>).<br/>
<span class="kwd">Notation</span> <span class="id">top6</span> := (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">True</span>).<br/>
<br/>
<span class="kwd">Notation</span> " '<span class="id">all1</span>' <span class="id">p</span>" := (<span class="kwd">forall</span> <span class="id">x0</span>, <span class="id">p</span> <span class="id">x0</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>, <span class="id">only</span> <span class="id">parsing</span>).<br/>
<span class="kwd">Notation</span> " '<span class="id">all2</span>' <span class="id">p</span>" := (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span>, <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>, <span class="id">only</span> <span class="id">parsing</span>).<br/>
<span class="kwd">Notation</span> " '<span class="id">all3</span>' <span class="id">p</span>" := (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>, <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>, <span class="id">only</span> <span class="id">parsing</span>).<br/>
<span class="kwd">Notation</span> " '<span class="id">all4</span>' <span class="id">p</span>" := (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>, <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>, <span class="id">only</span> <span class="id">parsing</span>).<br/>
<br/>
<span class="kwd">Notation</span> " ~1 <span class="id">p</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; ~ (<span class="id">p</span> <span class="id">x0</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> " ~2 <span class="id">p</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; ~ (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> " ~3 <span class="id">p</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> =&gt; ~ (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> " ~4 <span class="id">p</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> =&gt; ~ (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> /1\ <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; <span class="id">and</span> (<span class="id">p</span> <span class="id">x0</span>) (<span class="id">q</span> <span class="id">x0</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> /2\ <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; <span class="id">and</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> /3\ <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> =&gt; <span class="id">and</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> /4\ <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> =&gt; <span class="id">and</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -1&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; (<span class="kwd">forall</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span>: <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span>): <span class="kwd">Prop</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -2&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; (<span class="kwd">forall</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span>: <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span>): <span class="kwd">Prop</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -3&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> =&gt; ((<span class="kwd">forall</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>: <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>): <span class="kwd">Prop</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -4&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> =&gt; (<span class="kwd">forall</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>: <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>): <span class="kwd">Prop</span>) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Goal</span> <span class="id">all1</span> ((<span class="id">bot1</span>: <span class="id">unit</span> -&gt; <span class="kwd">Prop</span>) -1&gt; <span class="id">top1</span>). <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<span class="kwd">Goal</span> ((<span class="id">bot1</span>: <span class="id">unit</span> -&gt; <span class="kwd">Prop</span>) &lt;1= <span class="id">top1</span>). <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<span class="kwd">Goal</span> (<span class="id">bot2</span>: <span class="id">unit</span> -&gt; <span class="id">unit</span> -&gt; <span class="kwd">Prop</span>) &lt;2= <span class="id">top2</span>. <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">less1</span> <span class="id">X0</span> (<span class="id">p</span> <span class="id">q</span>: <span class="id">X0</span> -&gt; <span class="kwd">Prop</span>) := (<span class="kwd">forall</span> <span class="id">x0</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> : <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> : <span class="kwd">Prop</span>).<br/>
<span class="kwd">Definition</span> <span class="id">less2</span> <span class="id">X0</span> <span class="id">X1</span> (<span class="id">p</span> <span class="id">q</span>: <span class="id">X0</span> -&gt; <span class="id">X1</span> -&gt; <span class="kwd">Prop</span>) := (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> : <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> : <span class="kwd">Prop</span>).<br/>
<span class="kwd">Definition</span> <span class="id">less3</span> <span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span> (<span class="id">p</span> <span class="id">q</span>: <span class="id">X0</span> -&gt; <span class="id">X1</span> -&gt; <span class="id">X2</span> -&gt; <span class="kwd">Prop</span>) := (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> : <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> : <span class="kwd">Prop</span>).<br/>
<span class="kwd">Definition</span> <span class="id">less4</span> <span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> (<span class="id">p</span> <span class="id">q</span>: <span class="id">X0</span> -&gt; <span class="id">X1</span> -&gt; <span class="id">X2</span> -&gt; <span class="id">X3</span> -&gt; <span class="kwd">Prop</span>) := (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> (<span class="id">PR</span>: <span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> : <span class="kwd">Prop</span>), <span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> : <span class="kwd">Prop</span>).<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;1= <span class="id">q</span>" := (<span class="id">less1</span> <span class="id">p</span> <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;2= <span class="id">q</span>" := (<span class="id">less2</span> <span class="id">p</span> <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;3= <span class="id">q</span>" := (<span class="id">less3</span> <span class="id">p</span> <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;4= <span class="id">q</span>" := (<span class="id">less4</span> <span class="id">p</span> <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">less1_PreOrder</span> <span class="id">X0</span>: <span class="id">PreOrder</span> (@<span class="id">less1</span> <span class="id">X0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6200')">Next Obligation.</div>
<div class="proofscript" id="proof6200">
 <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6201')">Next Obligation.</div>
<div class="proofscript" id="proof6201">
 <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. Qed.</div>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">less2_PreOrder</span> <span class="id">X0</span> <span class="id">X1</span>: <span class="id">PreOrder</span> (@<span class="id">less2</span> <span class="id">X0</span> <span class="id">X1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6202')">Next Obligation.</div>
<div class="proofscript" id="proof6202">
 <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6203')">Next Obligation.</div>
<div class="proofscript" id="proof6203">
 <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. Qed.</div>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">less3_PreOrder</span> <span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span>: <span class="id">PreOrder</span> (@<span class="id">less3</span> <span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6204')">Next Obligation.</div>
<div class="proofscript" id="proof6204">
 <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6205')">Next Obligation.</div>
<div class="proofscript" id="proof6205">
 <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. Qed.</div>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">less4_PreOrder</span> <span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> : <span class="id">PreOrder</span> (@<span class="id">less4</span> <span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6206')">Next Obligation.</div>
<div class="proofscript" id="proof6206">
 <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6207')">Next Obligation.</div>
<div class="proofscript" id="proof6207">
 <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">less1</span> <span class="id">less2</span> <span class="id">less3</span> <span class="id">less4</span>.<br/>
<br/>
<span class="kwd">Goal</span> ((<span class="id">bot1</span>: <span class="id">unit</span> -&gt; <span class="kwd">Prop</span>) &lt;1= <span class="id">top1</span>). <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<span class="kwd">Goal</span> (<span class="id">bot2</span>: <span class="id">unit</span> -&gt; <span class="id">unit</span> -&gt; <span class="kwd">Prop</span>) &lt;2= <span class="id">top2</span>. <span class="id">ii</span>. <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> =1= <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; <span class="id">eq</span> (<span class="id">p</span> <span class="id">x0</span>) (<span class="id">q</span> <span class="id">x0</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> =2= <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; <span class="id">eq</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> =3= <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> =&gt; <span class="id">eq</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> =4= <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> =&gt; <span class="id">eq</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;1&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; <span class="id">iff</span> (<span class="id">p</span> <span class="id">x0</span>) (<span class="id">q</span> <span class="id">x0</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;2&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> =&gt; <span class="id">iff</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;3&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> =&gt; <span class="id">iff</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> &lt;4&gt; <span class="id">q</span>" := (<span class="kwd">fun</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> =&gt; <span class="id">iff</span> (<span class="id">p</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>) (<span class="id">q</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">prop_ext1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X0</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IFF</span>: <span class="id">all1</span> (<span class="id">P</span> &lt;1&gt; <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">all1</span> (<span class="id">P</span> =1= <span class="id">Q</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6208')">Proof.</div>
<div class="proofscript" id="proof6208">
 <span class="id">ss</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">prop_ext</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">prop_ext2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X0</span> <span class="id">X1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X0</span> -&gt; <span class="id">X1</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IFF</span>: <span class="id">all2</span> (<span class="id">P</span> &lt;2&gt; <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">all2</span> (<span class="id">P</span> =2= <span class="id">Q</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6209')">Proof.</div>
<div class="proofscript" id="proof6209">
 <span class="id">ss</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">prop_ext</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">prop_ext3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X0</span> -&gt; <span class="id">X1</span> -&gt; <span class="id">X2</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IFF</span>: <span class="id">all3</span> (<span class="id">P</span> &lt;3&gt; <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">all3</span> (<span class="id">P</span> =3= <span class="id">Q</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6210')">Proof.</div>
<div class="proofscript" id="proof6210">
 <span class="id">ss</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">prop_ext</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">prop_ext4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X0</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X0</span> -&gt; <span class="id">X1</span> -&gt; <span class="id">X2</span> -&gt; <span class="id">X3</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IFF</span>: <span class="id">all4</span> (<span class="id">P</span> &lt;4&gt; <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">all4</span> (<span class="id">P</span> =4= <span class="id">Q</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6211')">Proof.</div>
<div class="proofscript" id="proof6211">
 <span class="id">ss</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">prop_ext</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">func_ext1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X0</span> <span class="id">Y0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X0</span> -&gt; <span class="id">Y0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EQ</span>: <span class="id">all1</span> (<span class="id">P</span> =1= <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">P</span> = <span class="id">Q</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6212')">Proof.</div>
<div class="proofscript" id="proof6212">
 <span class="tactic">apply</span> <span class="id">Axioms.functional_extensionality</span>. <span class="id">ii</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">func_ext2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EQ</span>: <span class="id">all2</span> (<span class="id">P</span> =2= <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">P</span> = <span class="id">Q</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6213')">Proof.</div>
<div class="proofscript" id="proof6213">
 <span class="tactic">apply</span> <span class="id">func_ext1</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">func_ext1</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">func_ext3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> <span class="id">W</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span> -&gt; <span class="id">W</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EQ</span>: <span class="id">all3</span> (<span class="id">P</span> =3= <span class="id">Q</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">P</span> = <span class="id">Q</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6214')">Proof.</div>
<div class="proofscript" id="proof6214">
 <span class="tactic">apply</span> <span class="id">func_ext2</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">func_ext1</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">Basics.compose</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">well_founded_clos_trans</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">index</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">order</span>: <span class="id">index</span> -&gt; <span class="id">index</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id">well_founded</span> <span class="id">order</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">WF</span>: <span class="id">well_founded</span> (<span class="id">clos_trans</span> <span class="id">index</span> <span class="id">order</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6215')">Proof.</div>
<div class="proofscript" id="proof6215">
 <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">WF</span>. <span class="id">hnf</span>. <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">Acc_clos_trans</span>. <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_impl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>) (<span class="id">ys</span>: <span class="id">list</span> <span class="id">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IMPL</span>: (<span class="id">P</span> &lt;2= <span class="id">Q</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL</span>: <span class="id">Forall2</span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">FORALL</span>: <span class="id">Forall2</span> <span class="id">Q</span> <span class="id">xs</span> <span class="id">ys</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6216')">Proof.</div>
<div class="proofscript" id="proof6216">
 <span class="tactic">induction</span> <span class="id">FORALL</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id">Forall3</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> (<span class="id">R</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span> -&gt; <span class="kwd">Prop</span>): <span class="id">list</span> <span class="id">X</span> -&gt; <span class="id">list</span> <span class="id">Y</span> -&gt; <span class="id">list</span> <span class="id">Z</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id">Forall3_nil</span>: <span class="id">Forall3</span> <span class="id">R</span> [] [] []<br/>
| <span class="id">Forall3_cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id">Forall3</span> <span class="id">R</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall3</span> <span class="id">R</span> (<span class="id">x</span> :: <span class="id">xs</span>) (<span class="id">y</span> :: <span class="id">ys</span>) (<span class="id">z</span> :: <span class="id">zs</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall3_impl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>) (<span class="id">ys</span>: <span class="id">list</span> <span class="id">Y</span>) (<span class="id">zs</span>: <span class="id">list</span> <span class="id">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> <span class="id">Q</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IMPL</span>: (<span class="id">P</span> &lt;3= <span class="id">Q</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL</span>: <span class="id">Forall3</span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">FORALL</span>: <span class="id">Forall3</span> <span class="id">Q</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">zs</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6217')">Proof.</div>
<div class="proofscript" id="proof6217">
 <span class="tactic">induction</span> <span class="id">FORALL</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">o_map</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">oa</span>: <span class="id">option</span> <span class="id">A</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>): <span class="id">option</span> <span class="id">B</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">oa</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">a</span> =&gt; <span class="id">Some</span> (<span class="id">f</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">o_join</span> <span class="id">A</span> (<span class="id">a</span>: <span class="id">option</span> (<span class="id">option</span> <span class="id">A</span>)): <span class="id">option</span> <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">o_bind</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">oa</span>: <span class="id">option</span> <span class="id">A</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">option</span> <span class="id">B</span>): <span class="id">option</span> <span class="id">B</span> := <span class="id">o_join</span> (<span class="id">o_map</span> <span class="id">oa</span> <span class="id">f</span>).<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">o_map</span> <span class="id">o_join</span> <span class="id">o_bind</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">curry2</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>): (<span class="id">A</span> * <span class="id">B</span>) -&gt; <span class="id">C</span> := <span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">f</span> <span class="id">ab</span>.(<span class="id">fst</span>) <span class="id">ab</span>.(<span class="id">snd</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">o_bind2</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">oab</span>: <span class="id">option</span> (<span class="id">A</span> * <span class="id">B</span>)) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">option</span> <span class="id">C</span>) : <span class="id">option</span> <span class="id">C</span> :=<br/>
<span class="id">o_join</span> (<span class="id">o_map</span> <span class="id">oab</span> <span class="id">f</span>.(<span class="id">curry2</span>)).<br/>
<br/>
<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="tactic">do</span>' <span class="id">X</span> &lt;- <span class="id">A</span> ; <span class="id">B</span>" := (<span class="id">o_bind</span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200)<br/>
&nbsp;: <span class="id">o_monad_scope</span>.<br/>
<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="tactic">do</span>' ( <span class="id">X</span> , <span class="id">Y</span> ) &lt;- <span class="id">A</span> ; <span class="id">B</span>" := (<span class="id">o_bind2</span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> <span class="id">Y</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">Y</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200)<br/>
&nbsp;: <span class="id">o_monad_scope</span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">assertion</span>' <span class="id">A</span> ; <span class="id">B</span>" := (<span class="kwd">if</span> <span class="id">A</span> <span class="kwd">then</span> <span class="id">B</span> <span class="kwd">else</span> <span class="id">None</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">only</span> <span class="id">parsing</span>)<br/>
&nbsp;&nbsp;: <span class="id">o_monad_scope</span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">o_monad_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">o_bind_ignore</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span>: <span class="id">option</span> <span class="id">X</span>) (<span class="id">y</span>: <span class="id">option</span> <span class="id">Y</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">do</span> <span class="id">_</span> &lt;- <span class="id">x</span> ; <span class="id">y</span>) = <span class="id">assertion</span>(<span class="id">x</span>) ; <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6218')">Proof.</div>
<div class="proofscript" id="proof6218">
 <span class="id">des_ifs</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">subst_locals</span> := <span class="id">all</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">is_local_definition</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">H</span>).<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">flip</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -1 <span class="id">q</span>" := (<span class="id">p</span> /1\ ~1 <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -2 <span class="id">q</span>" := (<span class="id">p</span> /2\ ~2 <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -3 <span class="id">q</span>" := (<span class="id">p</span> /3\ ~3 <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<span class="kwd">Notation</span> "<span class="id">p</span> -4 <span class="id">q</span>" := (<span class="id">p</span> /4\ ~4 <span class="id">q</span>) (<span class="tactic">at</span> <span class="id">level</span> 50).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">u</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := <span class="tactic">repeat</span> (<span class="id">autounfold</span> <span class="kwd">with</span> * <span class="kwd">in</span> <span class="id">H</span>; <span class="id">cbn</span> <span class="kwd">in</span> <span class="id">H</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">u</span>" := <span class="tactic">repeat</span> (<span class="id">autounfold</span> <span class="kwd">with</span> *; <span class="id">cbn</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">u</span>" "<span class="kwd">in</span>" "*" := <span class="tactic">repeat</span> (<span class="id">autounfold</span> <span class="kwd">with</span> * <span class="kwd">in</span> *; <span class="id">cbn</span> <span class="kwd">in</span> *).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">dependent_split_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PA</span>: <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PB</span>: &lt;&lt;<span class="id">HINTLEFT</span>: <span class="id">A</span>&gt;&gt; -&gt; <span class="id">B</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">PAB</span>: <span class="id">A</span> /\ <span class="id">B</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6219')">Proof.</div>
<div class="proofscript" id="proof6219">
 <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">dependent_split_left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PA</span>: &lt;&lt;<span class="id">HINTRIGHT</span>: <span class="id">B</span>&gt;&gt; -&gt; <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PB</span>: <span class="id">B</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">PAB</span>: <span class="id">A</span> /\ <span class="id">B</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6220')">Proof.</div>
<div class="proofscript" id="proof6220">
 <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">dsplit_r</span> := <span class="tactic">eapply</span> <span class="id">dependent_split_right</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">dsplit_l</span> := <span class="tactic">eapply</span> <span class="id">dependent_split_left</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">dsplits</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="kwd">let</span> <span class="id">NAME</span> := <span class="tactic">fresh</span> "<span class="id">SPLITHINT</span>" <span class="kwd">in</span> <span class="tactic">try</span> (<span class="id">dsplit_r</span>; [|<span class="tactic">intro</span> <span class="id">NAME</span>])).<br/>
<br/>
<span class="id">Locate</span> <span class="id">des_sumbool</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">proj_sumbool_is_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>: {<span class="id">P</span>} + {~ <span class="id">P</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FALSE</span>: ~ <span class="id">P</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">FALSE</span>: <span class="id">proj_sumbool</span> <span class="id">a</span> = <span class="id">false</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6221')">Proof.</div>
<div class="proofscript" id="proof6221">
 <span class="tactic">unfold</span> <span class="id">proj_sumbool</span>. <span class="id">des_ifs</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">des_sumbool</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">unfold</span> <span class="id">Datatypes.is_true</span>, <span class="id">is_true</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">proj_sumbool</span> ?<span class="id">x</span> = <span class="id">true</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">proj_sumbool_true</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">proj_sumbool</span> ?<span class="id">x</span> = <span class="id">false</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">proj_sumbool_false</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">true</span> = <span class="id">proj_sumbool</span> ?<span class="id">x</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">proj_sumbool_true</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">false</span> = <span class="id">proj_sumbool</span> ?<span class="id">x</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">proj_sumbool_false</span> <span class="kwd">in</span> <span class="id">H</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">proj_sumbool</span> ?<span class="id">x</span> = <span class="id">true</span> ] =&gt; <span class="tactic">apply</span> <span class="id">proj_sumbool_is_true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">proj_sumbool</span> ?<span class="id">x</span> = <span class="id">false</span> ] =&gt; <span class="tactic">apply</span> <span class="id">proj_sumbool_is_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">true</span> = <span class="id">proj_sumbool</span> ?<span class="id">x</span> ] =&gt; <span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">proj_sumbool_is_true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">false</span> = <span class="id">proj_sumbool</span> ?<span class="id">x</span> ] =&gt; <span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">proj_sumbool_is_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">is_prop</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="kwd">Prop</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 1<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">all_prop</span> <span class="id">TAC</span> := <span class="id">all</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">tryif</span> <span class="id">is_prop</span> <span class="id">H</span> <span class="kwd">then</span> <span class="id">TAC</span> <span class="id">H</span> <span class="kwd">else</span> <span class="id">idtac</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">all_prop_inv</span> := <span class="id">all_prop</span> <span class="id">inv</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">all_rewrite</span> := <span class="id">all</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">rewrite_all</span> <span class="id">H</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">bar_True</span>: <span class="kwd">Type</span> := <span class="id">True</span>.<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id">bar_True</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">bar</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">NAME</span> := <span class="tactic">fresh</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">NAME</span>: <span class="id">bar_True</span>) <span class="tactic">by</span> <span class="id">ss</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">clear_until</span> <span class="id">id</span> :=<br/>
&nbsp;&nbsp;<span class="id">on_last_hyp</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">id</span>' =&gt; <span class="kwd">match</span> <span class="id">id</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">id</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">id</span>'; <span class="id">clear_until</span> <span class="id">id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">clear_until_bar</span> :=<br/>
&nbsp;&nbsp;<span class="id">on_last_hyp</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">id</span>' =&gt; <span class="kwd">match</span> (<span class="id">type</span> <span class="id">of</span> <span class="id">id</span>') <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">bar_True</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">id</span>'; <span class="id">clear_until_bar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Goal</span> <span class="id">True</span> -&gt; <span class="id">True</span> -&gt; <span class="id">False</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">bar</span>. <span class="tactic">intro</span>. <span class="id">clear_until</span> <span class="id">H0</span>. <span class="id">clear_until</span> <span class="id">H</span>. <span class="kwd">Undo</span> 2. <span class="id">clear_until_bar</span>. <span class="id">clear_tac</span>.<br/>
Abort.</div>
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">aof_true</span>: <span class="kwd">Type</span> := <span class="id">True</span>.<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id">aof_true</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">all_once_fast</span> <span class="id">TAC</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">I</span>: <span class="id">aof_true</span>);<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">name</span> := <span class="tactic">fresh</span> "<span class="id">bar</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">name</span>: <span class="id">aof_true</span>) <span class="tactic">by</span> <span class="id">constructor</span>; <span class="tactic">move</span> <span class="id">name</span> <span class="tactic">at</span> <span class="id">top</span>; <span class="id">revert_until</span> <span class="id">name</span>;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">aof_true</span> -&gt; <span class="id">_</span> ] =&gt; <span class="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">intro</span>; <span class="id">on_last_hyp</span> <span class="id">TAC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="id">on_last_hyp</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="tactic">clear</span> <span class="id">H</span>);<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">name</span>.<br/>
<br/>
<span class="kwd">Goal</span> <span class="kwd">forall</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">e</span>: <span class="id">bool</span>) <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">true</span> = <span class="id">false</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">false</span> = <span class="id">true</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">a</span> = <span class="id">true</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">b</span> = <span class="id">true</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">c</span> = <span class="id">true</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">True</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">d</span> = <span class="id">true</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> <span class="id">e</span> = <span class="id">true</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 :: 2 :: <span class="id">nil</span> = <span class="id">f</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">negb</span> (<span class="id">true</span> &amp;&amp; <span class="id">false</span>) = <span class="id">true</span>) -&gt; <span class="id">True</span> -&gt; <span class="id">False</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6222')">Proof.</div>
<div class="proofscript" id="proof6222">
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">revert</span> <span class="id">H9</span>. <span class="id">all_once_fast</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">negb_true_iff</span> <span class="kwd">in</span> <span class="id">H</span>).<br/>
Abort.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">spc</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">TAC</span> := <span class="id">ss</span>; <span class="tactic">eauto</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">eval</span> <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="kwd">forall</span> (<span class="id">a</span>: ?<span class="id">A</span>), <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span>, <span class="id">a3</span>: <span class="id">A</span>, <span class="id">a4</span>: <span class="id">A</span>, <span class="id">a5</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="tactic">fail</span> 2 "6 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span> "," <span class="id">a3</span> "," <span class="id">a4</span> "," <span class="id">a5</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span>, <span class="id">a3</span>: <span class="id">A</span>, <span class="id">a4</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="tactic">fail</span> 2 "5 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span> "," <span class="id">a3</span> "," <span class="id">a4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span>, <span class="id">a3</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="tactic">fail</span> 2 "4 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span> "," <span class="id">a3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="tactic">fail</span> 2 "3 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="tactic">fail</span> 2 "2 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tryif</span> <span class="id">is_prop</span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">name</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">name</span>: <span class="id">A</span>) <span class="tactic">by</span> <span class="id">TAC</span>; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">name</span>); <span class="tactic">clear</span> <span class="id">name</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fail</span> 2 "<span class="id">No</span> <span class="id">specialization</span> <span class="id">possible</span>!"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 1 "<span class="id">Nothing</span> <span class="id">to</span> <span class="id">specialize</span>!"<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">spcN</span> <span class="id">n</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">TAC</span> := <span class="id">ss</span>; <span class="tactic">eauto</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Z</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> "<span class="id">second</span> <span class="id">argument</span> <span class="id">should</span> <span class="id">be</span> '<span class="id">Z</span>'"<br/>
&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">eval</span> <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="kwd">forall</span> (<span class="id">a</span>: ?<span class="id">A</span>), <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span>, <span class="id">a3</span>: <span class="id">A</span>, <span class="id">a4</span>: <span class="id">A</span>, <span class="id">a5</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 5 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 4 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 3 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 2 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 1 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a5</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 3%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 4%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 5%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a5</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 2 "6 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span> "," <span class="id">a3</span> "," <span class="id">a4</span> "," <span class="id">a5</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span>, <span class="id">a3</span>: <span class="id">A</span>, <span class="id">a4</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 4 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 3 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 2 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 1 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 3%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 4%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 2 "5 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span> "," <span class="id">a3</span> "," <span class="id">a4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span>, <span class="id">a3</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 3 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 2 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 1 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 3%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 2 "4 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span> "," <span class="id">a3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span>, <span class="id">a2</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 2 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 1 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 2 "3 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span> "," <span class="id">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span>, <span class="id">a1</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| - 1 =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1%<span class="id">Z</span> =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 2 "2 <span class="id">candidates</span>!" <span class="id">a0</span> "," <span class="id">a1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">a0</span>: <span class="id">A</span> |- <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">a0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tryif</span> <span class="id">is_prop</span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">name</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">name</span>: <span class="id">A</span>) <span class="tactic">by</span> <span class="id">TAC</span>; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">name</span>); <span class="tactic">clear</span> <span class="id">name</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fail</span> 2 "<span class="id">No</span> <span class="id">specialization</span> <span class="id">possible</span>!"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">fail</span> 1 "<span class="id">Nothing</span> <span class="id">to</span> <span class="id">specialize</span>!"<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Goal</span> <span class="kwd">let</span> <span class="id">my_nat</span> := <span class="id">nat</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">my_f</span> := <span class="id">my_nat</span> -&gt; <span class="kwd">Prop</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">f</span>: <span class="id">my_f</span>) (<span class="id">g</span>: <span class="id">nat</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">x</span>: <span class="id">nat</span>) (<span class="id">y</span>: <span class="id">my_nat</span>), <span class="id">False</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">spc</span> <span class="id">f</span>. <span class="id">spc</span> <span class="id">g</span>.<br/>
Abort.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_ext_strong</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> (<span class="id">f</span> <span class="id">g</span>: <span class="id">X</span> -&gt; <span class="id">Y</span>) <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXT</span>: <span class="kwd">forall</span> <span class="id">x</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">x</span> <span class="id">xs</span>), <span class="id">f</span> <span class="id">x</span> = <span class="id">g</span> <span class="id">x</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> <span class="id">xs</span> = <span class="id">map</span> <span class="id">g</span> <span class="id">xs</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6223')">Proof.</div>
<div class="proofscript" id="proof6223">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">EXT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 998 (<span class="id">_</span> = <span class="id">_</span>) =&gt; <span class="tactic">f_equal</span> : <span class="tactic">f_equal</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 999 =&gt; <span class="tactic">congruence</span> : <span class="tactic">congruence</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 1000 =&gt; <span class="id">lia</span> : <span class="id">lia</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id">ALIGN</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">align_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NONNEG</span>: <span class="id">x</span> &gt;= 0):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">ALIGN</span>: <span class="id">align</span> <span class="id">x</span> <span class="id">x</span> = <span class="id">x</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6224')">Proof.</div>
<div class="proofscript" id="proof6224">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Z.eqb</span> <span class="id">x</span> 0) <span class="id">eqn</span>: <span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Z.eqb_eq</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Z.eqb_neq</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">red</span>. <span class="tactic">unfold</span> <span class="id">align</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">x</span> + <span class="id">x</span> - 1) / <span class="id">x</span>) <span class="kwd">with</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">x</span> - 1) <span class="kwd">with</span> (1 * <span class="id">x</span> + (1 * <span class="id">x</span> + (- 1))); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Z.div_add_l</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Z.div_add_l</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">Z.div</span> (<span class="id">Zneg</span> <span class="id">xH</span>) <span class="id">x</span>) <span class="kwd">with</span> (<span class="id">Zneg</span> <span class="id">xH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="id">ss</span>. <span class="tactic">clear</span> - <span class="id">p</span>. <span class="tactic">unfold</span> <span class="id">Z.div</span>. <span class="id">des_ifs</span>. <span class="id">ginduction</span> <span class="id">p</span>; <span class="id">i</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">align_zero</span>: <span class="kwd">forall</span> <span class="id">x</span>, &lt;&lt;<span class="id">ALIGN</span>: <span class="id">align</span> <span class="id">x</span> 0 = 0&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6225')">Proof.</div>
<div class="proofscript" id="proof6225">
 <span class="id">i</span>. <span class="tactic">unfold</span> <span class="id">align</span>. <span class="tactic">red</span>. <span class="id">ss</span>. <span class="id">xomega</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">align_divisible</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">z</span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DIV</span>: (<span class="id">y</span> | <span class="id">z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NONNEG</span>: <span class="id">y</span> &gt; 0):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">ALIGN</span>: <span class="id">align</span> <span class="id">z</span> <span class="id">y</span> = <span class="id">z</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6226')">Proof.</div>
<div class="proofscript" id="proof6226">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">unfold</span> <span class="id">align</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">z</span> + <span class="id">y</span> - 1) / <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">z</span> / <span class="id">y</span> + (<span class="id">y</span> - 1) / <span class="id">y</span>); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Z.divide</span> <span class="kwd">in</span> *. <span class="id">des</span>. <span class="id">clarify</span>. <span class="tactic">rewrite</span> <span class="id">Z_div_mult</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">z0</span> * <span class="id">y</span> + <span class="id">y</span> - 1) <span class="kwd">with</span> (<span class="id">z0</span> * <span class="id">y</span> + (<span class="id">y</span> - 1)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Z.div_add_l</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">y</span>); <span class="id">ss</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">y</span> - 1) / <span class="id">y</span>) <span class="kwd">with</span> 0; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">Zdiv_small</span>; <span class="id">ss</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Z.divide</span> <span class="kwd">in</span> *. <span class="id">des</span>. <span class="id">clarify</span>. <span class="tactic">rewrite</span> <span class="id">Z_div_mult</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">Z.add_0_r</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">align_idempotence</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NONNEG</span>: <span class="id">y</span> &gt; 0):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">ALIGN</span>: <span class="id">align</span> (<span class="id">align</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">y</span> = <span class="id">align</span> <span class="id">x</span> <span class="id">y</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6227')">Proof.</div>
<div class="proofscript" id="proof6227">
 <span class="tactic">apply</span> <span class="id">align_divisible</span>; <span class="id">ss</span>. <span class="tactic">apply</span> <span class="id">align_divides</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">ALIGN</span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">align_refl</span>: <span class="id">align</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">align_zero</span>: <span class="id">align</span>.<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id">align_idempotence</span>: <span class="id">align</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">inv_all_once</span> := <span class="id">all_once_fast</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">H</span>).<br/>
<span class="kwd">Ltac</span> <span class="id">apply_all_once</span> <span class="id">LEMMA</span> :=  <span class="id">all_once_fast</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">LEMMA</span> <span class="kwd">in</span> <span class="id">H</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">find_map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> (<span class="id">f</span>: <span class="id">Y</span> -&gt; <span class="id">bool</span>) (<span class="id">x2y</span>: <span class="id">X</span> -&gt; <span class="id">Y</span>) <span class="id">xs</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">x2y</span> <span class="id">xs</span>) = <span class="id">o_map</span> (<span class="id">find</span> (<span class="id">f</span> &lt;*&gt; <span class="id">x2y</span>) <span class="id">xs</span>) <span class="id">x2y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6228')">Proof.</div>
<div class="proofscript" id="proof6228">
 <span class="id">u</span>. <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">revert_until_bar</span> :=<br/>
&nbsp;&nbsp;<span class="id">on_last_hyp</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">id</span>' =&gt; <span class="kwd">match</span> (<span class="id">type</span> <span class="id">of</span> <span class="id">id</span>') <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">bar_True</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">revert</span> <span class="id">id</span>'; <span class="id">revert_until_bar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">folder</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">multimatch</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="id">is_local_definition</span> <span class="id">H</span>; <span class="id">fold_all</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">refl</span> := <span class="tactic">reflexivity</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">etrans</span> := <span class="id">etransitivity</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">congr</span> := <span class="tactic">congruence</span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id">rtc</span> := (<span class="id">clos_refl_trans_1n</span> <span class="id">_</span>). <br/>
<span class="kwd">Notation</span> <span class="id">rc</span> := (<span class="id">clos_refl</span> <span class="id">_</span>). <br/>
<span class="kwd">Notation</span> <span class="id">tc</span> := (<span class="id">clos_trans</span> <span class="id">_</span>). <br/>
<span class="kwd">Hint</span> <span class="kwd">Immediate</span> <span class="id">rt1n_refl</span> <span class="id">rt1n_trans</span> <span class="id">t_step</span>.<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">rtc_PreOrder</span> <span class="id">A</span> (<span class="id">R</span>:<span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>): <span class="id">PreOrder</span> (<span class="id">rtc</span> <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6229')">Next Obligation.</div>
<div class="proofscript" id="proof6229">
&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">revert</span> <span class="id">H0</span>. <span class="tactic">induction</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">IHclos_refl_trans_1n</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">rtc_tail</span> <span class="id">A</span> <span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a1</span> <span class="id">a3</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">REL</span>: <span class="id">rtc</span> <span class="id">R</span> <span class="id">a1</span> <span class="id">a3</span>):<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">a2</span>, <span class="id">rtc</span> <span class="id">R</span> <span class="id">a1</span> <span class="id">a2</span> /\ <span class="id">R</span> <span class="id">a2</span> <span class="id">a3</span>) \/<br/>
&nbsp;&nbsp;(<span class="id">a1</span> = <span class="id">a3</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6230')">Proof.</div>
<div class="proofscript" id="proof6230">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">REL</span>; <span class="tactic">auto</span>. <span class="id">des</span>; <span class="tactic">subst</span>; <span class="id">left</span>; <span class="id">eexists</span>; <span class="id">splits</span>; [|<span class="tactic">eauto</span>| | <span class="tactic">eauto</span>]; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">rtc_implies</span> <span class="id">A</span> (<span class="id">R1</span> <span class="id">R2</span>: <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IMPL</span>: <span class="id">R1</span> &lt;2= <span class="id">R2</span>):<br/>
&nbsp;&nbsp;<span class="id">rtc</span> <span class="id">R1</span> &lt;2= <span class="id">rtc</span> <span class="id">R2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6231')">Proof.</div>
<div class="proofscript" id="proof6231">
&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">induction</span> <span class="id">PR</span>; <span class="tactic">eauto</span>. <span class="id">etrans</span>; [|<span class="tactic">eauto</span>]. <span class="id">econs</span> 2; [|<span class="id">econs</span> 1]. <span class="tactic">apply</span> <span class="id">IMPL</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">rtc_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">R</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EQ</span>: <span class="id">a</span> = <span class="id">b</span>):<br/>
&nbsp;&nbsp;<span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6232')">Proof.</div>
<div class="proofscript" id="proof6232">
 <span class="tactic">subst</span>. <span class="id">econs</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">rtc_n1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">R</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AB</span>: <span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BC</span>: <span class="id">R</span> <span class="id">b</span> <span class="id">c</span>):<br/>
&nbsp;&nbsp;<span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">c</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6233')">Proof.</div>
<div class="proofscript" id="proof6233">
 <span class="id">etrans</span>; <span class="tactic">eauto</span>. <span class="id">econs</span> 2; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">rtc_reverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> <span class="id">R</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RTC</span>: <span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">b</span>):<br/>
&nbsp;&nbsp;<span class="id">rtc</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">R</span> <span class="id">y</span> <span class="id">x</span>) <span class="id">b</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6234')">Proof.</div>
<div class="proofscript" id="proof6234">
 <span class="tactic">induction</span> <span class="id">RTC</span>; <span class="tactic">eauto</span>. <span class="id">etrans</span>; <span class="tactic">eauto</span>. <span class="id">econs</span> 2; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">rtc_once</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> (<span class="id">R</span>: <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">a</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ONCE</span>: <span class="id">R</span> <span class="id">a</span> <span class="id">b</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rtc</span> <span class="id">R</span> <span class="id">a</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6235')">Proof.</div>
<div class="proofscript" id="proof6235">
 <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> (<span class="id">P</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span> <span class="id">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL2</span>: <span class="id">Forall2</span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">length</span> <span class="id">xs</span> = <span class="id">length</span> <span class="id">ys</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6236')">Proof.</div>
<div class="proofscript" id="proof6236">
 <span class="id">ginduction</span> <span class="id">FORALL2</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">xomega</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">hexpl_aux</span> <span class="id">H</span> <span class="id">NAME</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="tactic">fresh</span> <span class="id">NAME</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">first</span>[<span class="id">hexploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="id">check_safe</span>; <span class="tactic">repeat</span> <span class="tactic">intro</span> <span class="id">n</span>; <span class="id">des</span>].<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hexpl</span>" <span class="id">constr</span>(<span class="id">H</span>) := <span class="id">hexpl_aux</span> <span class="id">H</span> <span class="id">H</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hexpl</span>" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">ident</span>(<span class="id">NAME</span>) := <span class="id">hexpl_aux</span> <span class="id">H</span> <span class="id">NAME</span>.<br/>
<br/>
<span class="kwd">Goal</span> <span class="kwd">forall</span> (<span class="id">mytt</span>: <span class="id">unit</span>) (<span class="id">H</span>: <span class="id">unit</span> -&gt; <span class="id">False</span>), <span class="id">False</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">hexpl</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Goal</span> <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id">nat</span> -&gt; <span class="id">False</span>), <span class="id">False</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">hexpl</span> <span class="id">H</span>.<br/>
Abort.</div>
<br/>
<span class="kwd">Goal</span> <span class="kwd">forall</span> (<span class="id">H</span>: <span class="id">nat</span> -&gt; <span class="id">nat</span> -&gt; <span class="id">False</span>), <span class="id">False</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">Fail</span> <span class="id">hexpl</span> <span class="id">H</span>.<br/>
Abort.</div>
<br/>
<span class="kwd">Goal</span> <span class="kwd">forall</span> (<span class="id">mytt</span>: <span class="id">unit</span>) (<span class="id">HH</span>: <span class="id">unit</span> -&gt; (<span class="id">True</span> -&gt; <span class="id">True</span> /\ <span class="id">True</span>)), <span class="id">False</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">hexpl</span> <span class="id">HH</span> <span class="id">ABC</span>. <span class="id">hexpl</span> <span class="id">HH</span>.<br/>
Abort.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 997 =&gt; <span class="id">xomega</span> : <span class="id">xomega</span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.add_0_l</span> <span class="id">Z.add_0_r</span> <span class="id">Z.add_assoc</span> <span class="id">Z.add_simpl_l</span> <span class="id">Z.add_simpl_r</span> <span class="id">Z.add_opp_r</span> <span class="id">Z.add_opp_l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.mul_0_l</span> <span class="id">Z.mul_0_r</span> <span class="id">Z.mul_assoc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.sub_0_r</span> <span class="id">Z.sub_diag</span> <span class="id">Z.sub_simpl_l</span> <span class="id">Z.sub_simpl_r</span> <span class="id">Z.sub_0_l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.div_0_l</span> <span class="id">Zdiv_0_r</span> <span class="id">Z.div_1_r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.mod_1_r</span> <span class="id">Z.mod_0_l</span> <span class="id">Z.mod_same</span> <span class="id">Z.mod_mul</span> <span class="id">Z.mod_mod</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.sub_add</span><br/>
&nbsp;&nbsp;: <span class="id">zsimpl</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">zsimpl</span> := <span class="tactic">repeat</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">zsimpl</span> <span class="kwd">in</span> *.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">rp</span> := <span class="id">first</span> [<span class="id">erewrite</span> <span class="id">f_equal8</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">f_equal7</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">f_equal6</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">f_equal5</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">f_equal4</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">f_equal3</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">f_equal2</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="tactic">f_equal</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fail</span>].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">align_bool</span> :=<br/>
&nbsp;&nbsp;(<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">true</span> &lt;&gt; <span class="id">true</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">false</span> &lt;&gt; <span class="id">false</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">true</span> &lt;&gt; <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">false</span> &lt;&gt; <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">_</span> &lt;&gt; <span class="id">true</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">not_true_is_false</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">_</span> &lt;&gt; <span class="id">false</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">not_false_is_true</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<span class="kwd">Ltac</span> <span class="id">simpl_bool</span> := <span class="tactic">unfold</span> <span class="id">Datatypes.is_true</span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id">is_true</span> <span class="kwd">in</span> *; <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">simpl_bool</span> <span class="kwd">in</span> *.<br/>
<span class="kwd">Ltac</span> <span class="id">bsimpl</span> := <span class="id">simpl_bool</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">range</span> (<span class="id">lo</span> <span class="id">hi</span>: <span class="id">Z</span>): <span class="id">Z</span> -&gt; <span class="kwd">Prop</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">lo</span> &lt;= <span class="id">x</span> &lt; <span class="id">hi</span>. <br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">range</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">sym</span> := <span class="tactic">symmetry</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sym</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">eapply_all_once</span> <span class="id">LEMMA</span> :=<br/>
&nbsp;&nbsp;<span class="id">all_once_fast</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">LEMMA</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">eassumption</span>; <span class="id">check_safe</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">Nsimpl</span> := <span class="id">all_once_fast</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">NNPP</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">not_and_or</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">not_or_and</span> <span class="kwd">in</span> <span class="id">H</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">hexploit1</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: ?<span class="id">A</span> -&gt; ?<span class="id">B</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">mp</span> <span class="id">B</span>); [<span class="tactic">apply</span> <span class="id">H</span>|<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intro</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">rev_nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NIL</span>: <span class="id">rev</span> <span class="id">xs</span> = []):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6237')">Proof.</div>
<div class="proofscript" id="proof6237">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="tactic">f_equal</span> (@<span class="id">length</span> <span class="id">_</span>) <span class="id">NIL</span>). <span class="id">i</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">xs</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">app_length</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">last_opt</span> <span class="id">X</span> (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>): <span class="id">option</span> <span class="id">X</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">xs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;| [<span class="id">hd</span>] =&gt; <span class="id">Some</span> <span class="id">hd</span><br/>
&nbsp;&nbsp;| <span class="id">hd</span> :: <span class="id">tl</span> =&gt; <span class="id">last_opt</span> <span class="id">tl</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">last_none</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NONE</span>: <span class="id">last_opt</span> <span class="id">xs</span> = <span class="id">None</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xs</span> = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6238')">Proof.</div>
<div class="proofscript" id="proof6238">
 <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">spc</span> <span class="id">IHxs</span>. <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">last_some</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SOME</span>: <span class="id">last_opt</span> <span class="id">xs</span> = <span class="id">Some</span> <span class="id">x</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">hds</span>, <span class="id">xs</span> = <span class="id">hds</span> ++ [<span class="id">x</span>].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6239')">Proof.</div>
<div class="proofscript" id="proof6239">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;{ <span class="id">exists</span> <span class="id">nil</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="id">exists</span> (<span class="id">a</span> :: <span class="id">hds</span>). <span class="id">ss</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">forall2_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> (<span class="id">P</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="kwd">Prop</span>) <span class="id">xs</span> <span class="id">ys</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span> &lt;-&gt; <span class="id">Forall2</span> <span class="id">P</span> <span class="id">xs</span> <span class="id">ys</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6240')">Proof.</div>
<div class="proofscript" id="proof6240">
 <span class="tactic">split</span>; <span class="id">i</span>; <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">ss</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">zip</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> (<span class="id">f</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span>) (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>) (<span class="id">ys</span>: <span class="id">list</span> <span class="id">Y</span>): <span class="id">list</span> <span class="id">Z</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">xs</span>, <span class="id">ys</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">xhd</span> :: <span class="id">xtl</span>, <span class="id">yhd</span> :: <span class="id">ytl</span> =&gt; <span class="id">f</span> <span class="id">xhd</span> <span class="id">yhd</span> :: <span class="id">zip</span> <span class="id">f</span> <span class="id">xtl</span> <span class="id">ytl</span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; []<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">zip_length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> (<span class="id">f</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span>) <span class="id">xs</span> <span class="id">ys</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">length</span> (<span class="id">zip</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>) = <span class="id">min</span> <span class="id">xs</span>.(<span class="id">length</span>) <span class="id">ys</span>.(<span class="id">length</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6241')">Proof.</div>
<div class="proofscript" id="proof6241">
 <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">IHxs</span>. <span class="id">xomega</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">in_zip_iff</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y</span> <span class="id">Z</span> (<span class="id">f</span>: <span class="id">X</span> -&gt; <span class="id">Y</span> -&gt; <span class="id">Z</span>) <span class="id">xs</span> <span class="id">ys</span> <span class="id">z</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">ZIP</span>: <span class="id">In</span> <span class="id">z</span> (<span class="id">zip</span> <span class="id">f</span> <span class="id">xs</span> <span class="id">ys</span>)&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; (<span class="id">exists</span> <span class="id">x</span> <span class="id">y</span>, &lt;&lt;<span class="id">F</span>: <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">z</span>&gt;&gt; /\ <span class="id">exists</span> <span class="id">n</span>, &lt;&lt;<span class="id">X</span>: <span class="id">nth_error</span> <span class="id">xs</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">x</span>&gt;&gt; /\ &lt;&lt;<span class="id">Y</span>: <span class="id">nth_error</span> <span class="id">ys</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">y</span>&gt;&gt;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6242')">Proof.</div>
<div class="proofscript" id="proof6242">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">ii</span>.<br/>
&nbsp;&nbsp;- <span class="id">ginduction</span> <span class="id">xs</span>; <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">esplits</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">instantiate</span> (1 := 0%<span class="id">nat</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">IHxs</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">instantiate</span> (1:= (1+<span class="id">n</span>)%<span class="id">nat</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">des</span>. <span class="id">ginduction</span> <span class="id">n</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="id">left</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="id">exploit</span> (@<span class="id">IHn</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>); <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id">Z.mul</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">unit_ord_wf</span>: <span class="id">well_founded</span> (<span class="id">bot2</span>: <span class="id">unit</span> -&gt; <span class="id">unit</span> -&gt; <span class="kwd">Prop</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6243')">Proof.</div>
<div class="proofscript" id="proof6243">
 <span class="id">ii</span>. <span class="tactic">induction</span> <span class="id">a</span>; <span class="id">ii</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">et</span>:= <span class="tactic">eauto</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="kwd">Program</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">f_equal_h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> (<span class="id">f1</span>: <span class="id">X1</span> -&gt; <span class="id">Y1</span>) (<span class="id">f2</span>: <span class="id">X2</span> -&gt; <span class="id">Y2</span>) <span class="id">x1</span> <span class="id">x2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TYPX</span>: <span class="id">X1</span> = <span class="id">X2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FUNC</span>: <span class="id">f1</span> ~= <span class="id">f2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARG</span>: <span class="id">x1</span> ~= <span class="id">x2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TYPY</span>: <span class="id">Y1</span> = <span class="id">Y2</span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f1</span> <span class="id">x1</span> ~= <span class="id">f2</span> <span class="id">x2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6244')">Proof.</div>
<div class="proofscript" id="proof6244">
 <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id">JMeq_eq</span> <span class="kwd">in</span> <span class="id">ARG</span>. <span class="tactic">subst</span>. <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">f_equal_hr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X1</span> <span class="id">X2</span> <span class="id">Y</span> (<span class="id">f1</span>: <span class="id">X1</span> -&gt; <span class="id">Y</span>) (<span class="id">f2</span>: <span class="id">X2</span> -&gt; <span class="id">Y</span>) <span class="id">x1</span> <span class="id">x2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FUNC</span>: <span class="id">f1</span> ~= <span class="id">f2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TYP</span>: <span class="id">X1</span> = <span class="id">X2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARG</span>: <span class="id">x1</span> ~= <span class="id">x2</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f1</span> <span class="id">x1</span> = <span class="id">f2</span> <span class="id">x2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6245')">Proof.</div>
<div class="proofscript" id="proof6245">
 <span class="tactic">eapply</span> <span class="id">JMeq_eq</span>. <span class="tactic">eapply</span> <span class="id">f_equal_h</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">f_equal_rh</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">Y1</span> <span class="id">Y2</span> (<span class="id">f1</span>: <span class="id">X</span> -&gt; <span class="id">Y1</span>) (<span class="id">f2</span>: <span class="id">X</span> -&gt; <span class="id">Y2</span>) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FUNC</span>: <span class="id">f1</span> ~= <span class="id">f2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TYP</span>: <span class="id">Y1</span> = <span class="id">Y2</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f1</span> <span class="id">x</span> ~= <span class="id">f2</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6246')">Proof.</div>
<div class="proofscript" id="proof6246">
 <span class="tactic">eapply</span> <span class="id">f_equal_h</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">cons_app</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">xhd</span> (<span class="id">xtl</span>: <span class="id">list</span> <span class="id">X</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xhd</span> :: <span class="id">xtl</span> = [<span class="id">xhd</span>] ++ <span class="id">xtl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6247')">Proof.</div>
<div class="proofscript" id="proof6247">
 <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_map_injective</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJECTIVE</span>: <span class="kwd">forall</span> <span class="id">a0</span> <span class="id">a1</span> (<span class="id">EQ</span>: <span class="id">f</span> <span class="id">a0</span> = <span class="id">f</span> <span class="id">a1</span>), <span class="id">a0</span> = <span class="id">a1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> <span class="id">l1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LEQ</span>: <span class="id">map</span> <span class="id">f</span> <span class="id">l0</span> = <span class="id">map</span> <span class="id">f</span> <span class="id">l1</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> = <span class="id">l1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6248')">Proof.</div>
<div class="proofscript" id="proof6248">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l1</span> <span class="id">LEQ</span>. <span class="tactic">induction</span> <span class="id">l0</span>; <span class="id">i</span>; <span class="id">ss</span>; <span class="tactic">destruct</span> <span class="id">l1</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">LEQ</span>. <span class="tactic">f_equal</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_in_map</span> <span class="id">A</span> <span class="id">B</span> <span class="id">al</span> (<span class="id">R</span>: <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RMAP</span>: <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">a</span> <span class="id">al</span>), <span class="id">R</span> (<span class="id">f</span> <span class="id">a</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">R</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">al</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6249')">Proof.</div>
<div class="proofscript" id="proof6249">
 <span class="tactic">induction</span> <span class="id">al</span>; <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_in_map</span> <span class="id">A</span> <span class="id">B</span> <span class="id">al</span> (<span class="id">R</span>: <span class="id">B</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RMAP</span>: <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">a</span> <span class="id">al</span>), <span class="id">R</span> (<span class="id">f</span> <span class="id">a</span>) <span class="id">a</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> <span class="id">R</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">al</span>) <span class="id">al</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6250')">Proof.</div>
<div class="proofscript" id="proof6250">
 <span class="tactic">induction</span> <span class="id">al</span>; <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eq_Forall2_eq</span> <span class="id">A</span> (<span class="id">al0</span> <span class="id">al1</span> : <span class="id">list</span> <span class="id">A</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> <span class="id">eq</span> <span class="id">al0</span> <span class="id">al1</span> &lt;-&gt; <span class="id">al0</span> = <span class="id">al1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6251')">Proof.</div>
<div class="proofscript" id="proof6251">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">al1</span>. <span class="tactic">induction</span> <span class="id">al0</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="tactic">split</span>; <span class="id">i</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">f_equal</span>. <span class="tactic">eapply</span> <span class="id">IHal0</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHal0</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_forall2_lift</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">R0</span> <span class="id">R1</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">al</span> <span class="id">bl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SAME</span>: <span class="kwd">forall</span> <span class="id">a</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">a</span> <span class="id">al</span>) <span class="id">b</span>, <span class="id">R0</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id">R1</span> <span class="id">a</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL</span>: <span class="id">list_forall2</span> <span class="id">R0</span> <span class="id">al</span> <span class="id">bl</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> <span class="id">R1</span> <span class="id">al</span> <span class="id">bl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6252')">Proof.</div>
<div class="proofscript" id="proof6252">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">bl</span>. <span class="id">revert</span> <span class="id">SAME</span>. <span class="tactic">induction</span> <span class="id">al</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">inv</span> <span class="id">FORALL</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall_map</span> <span class="id">A</span> <span class="id">B</span> <span class="id">la</span> (<span class="id">R</span>: <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RMAP</span>: <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">R</span> (<span class="id">f</span> <span class="id">a</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">R</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">la</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6253')">Proof.</div>
<div class="proofscript" id="proof6253">
 <span class="tactic">induction</span> <span class="id">la</span>; <span class="id">econs</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">f_hequal</span> <span class="id">A</span> (<span class="id">B</span> : <span class="id">A</span> -&gt; <span class="kwd">Type</span>) (<span class="id">f</span> : <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">B</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a1</span> <span class="id">a2</span> (<span class="id">EQ</span> : <span class="id">a1</span> = <span class="id">a2</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">a1</span> ~= <span class="id">f</span> <span class="id">a2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6254')">Proof.</div>
<div class="proofscript" id="proof6254">
 <span class="tactic">destruct</span> <span class="id">EQ</span>. <span class="id">econs</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_forall2_rev</span> <span class="id">A</span> <span class="id">B</span> <span class="id">R</span> (<span class="id">la</span>: <span class="id">list</span> <span class="id">A</span>) (<span class="id">lb</span>: <span class="id">list</span> <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL</span>: <span class="id">list_forall2</span> <span class="id">R</span> <span class="id">la</span> <span class="id">lb</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> (<span class="id">flip</span> <span class="id">R</span>) <span class="id">lb</span> <span class="id">la</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6255')">Proof.</div>
<div class="proofscript" id="proof6255">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">lb</span>. <span class="tactic">induction</span> <span class="id">la</span>; <span class="id">i</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">FORALL</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">uo</span> := <span class="tactic">unfold</span> <span class="id">o_bind</span>, <span class="id">o_map</span>, <span class="id">o_join</span> <span class="kwd">in</span> *.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">some_injective</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> (<span class="id">x0</span> <span class="id">x1</span>: <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EQ</span>: <span class="id">Some</span> <span class="id">x0</span> = <span class="id">Some</span> <span class="id">x1</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x0</span> = <span class="id">x1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6256')">Proof.</div>
<div class="proofscript" id="proof6256">
 <span class="tactic">injection</span> <span class="id">EQ</span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">align_opt</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">Some</span> ?<span class="id">x</span> = <span class="id">Some</span> ?<span class="id">y</span> |- <span class="id">_</span> =&gt; <span class="tactic">rewrite</span> <span class="id">some_injective</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">Some</span> <span class="id">_</span> = <span class="id">None</span> |- <span class="id">_</span> =&gt; <span class="tactic">by</span> (<span class="tactic">inversion</span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">None</span> = <span class="id">Some</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">by</span> (<span class="tactic">inversion</span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">None</span> = <span class="id">None</span> |- <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">Some</span> <span class="id">_</span> = ?<span class="id">x</span> |- <span class="id">_</span> =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">None</span> = ?<span class="id">x</span> |- <span class="id">_</span> =&gt; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">list_diff</span> <span class="id">X</span> (<span class="id">dec</span>: (<span class="kwd">forall</span> <span class="id">x0</span> <span class="id">x1</span>, {<span class="id">x0</span> = <span class="id">x1</span>} + {<span class="id">x0</span> &lt;&gt; <span class="id">x1</span>})) (<span class="id">xs0</span> <span class="id">xs1</span>: <span class="id">list</span> <span class="id">X</span>): <span class="id">list</span> <span class="id">X</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">xs0</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;| <span class="id">hd</span> :: <span class="id">tl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">dec</span> <span class="id">hd</span> <span class="id">xs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">list_diff</span> <span class="id">dec</span> <span class="id">tl</span> <span class="id">xs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">hd</span> :: <span class="id">list_diff</span> <span class="id">dec</span> <span class="id">tl</span> <span class="id">xs1</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_diff_spec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">dec</span> (<span class="id">xs0</span> <span class="id">xs1</span> <span class="id">xs2</span>: <span class="id">list</span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DIFF</span>: <span class="id">list_diff</span> <span class="id">dec</span> <span class="id">xs0</span> <span class="id">xs1</span> = <span class="id">xs2</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SPEC</span>: <span class="kwd">forall</span> <span class="id">x0</span>, <span class="id">In</span> <span class="id">x0</span> <span class="id">xs2</span> &lt;-&gt; (<span class="id">In</span> <span class="id">x0</span> <span class="id">xs0</span> /\ ~ <span class="id">In</span> <span class="id">x0</span> <span class="id">xs1</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6257')">Proof.</div>
<div class="proofscript" id="proof6257">
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">split</span>; <span class="id">i</span>.<br/>
&nbsp;&nbsp;- <span class="id">ginduction</span> <span class="id">xs0</span>; <span class="id">ii</span>; <span class="id">des</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">IHxs0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHxs0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;- <span class="id">ginduction</span> <span class="id">xs0</span>; <span class="id">ii</span>; <span class="id">des</span>; <span class="id">ss</span>. <span class="id">des</span>; <span class="id">clarify</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="id">exploit</span> <span class="id">IHxs0</span>; <span class="id">et</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">last_option</span> <span class="id">X</span> (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>): <span class="id">option</span> <span class="id">X</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">xs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [] =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;| <span class="id">hd</span> :: <span class="id">nil</span> =&gt; <span class="id">Some</span> <span class="id">hd</span><br/>
&nbsp;&nbsp;| <span class="id">hd</span> :: <span class="id">tl</span> =&gt; <span class="id">last_option</span> <span class="id">tl</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">not_ex_all_not</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">U</span> (<span class="id">P</span>: <span class="id">U</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NEX</span>: ~ (<span class="id">exists</span> <span class="id">n</span> : <span class="id">U</span>, <span class="id">P</span> <span class="id">n</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">NALL</span>: <span class="kwd">forall</span> <span class="id">n</span> : <span class="id">U</span>, ~ <span class="id">P</span> <span class="id">n</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6258')">Proof.</div>
<div class="proofscript" id="proof6258">
 <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">econsr</span> :=<br/>
&nbsp;&nbsp;<span class="id">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id">econstructor</span> 16<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span> 15<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span> 14<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span> 13<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span> 12<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span> 11<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span> 10<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  9<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  8<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  7<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  6<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  5<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  3<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">econstructor</span>  1].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">it</span> <span class="id">TERM</span> := <span class="id">instantiate</span> (1:=<span class="id">TERM</span>).<br/>
<span class="kwd">Ltac</span> <span class="id">itl</span> <span class="id">TERM</span> :=<br/>
&nbsp;&nbsp;<span class="id">first</span>[ <span class="id">instantiate</span> (10:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (9:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (8:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (7:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (6:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (5:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (4:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (3:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id">TERM</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fail</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">NoDup_norepet</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> (<span class="id">xs</span>: <span class="id">list</span> <span class="id">X</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NoDup</span> <span class="id">xs</span> &lt;-&gt; <span class="id">list_norepet</span> <span class="id">xs</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6259')">Proof.</div>
<div class="proofscript" id="proof6259">
 <span class="tactic">split</span>; <span class="tactic">induction</span> 1; <span class="id">econs</span>; <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">swapname</span> <span class="id">NAME1</span> <span class="id">NAME2</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tmp</span> := <span class="tactic">fresh</span> "<span class="id">TMP</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">NAME1</span> <span class="id">into</span> <span class="id">tmp</span>; <span class="tactic">rename</span> <span class="id">NAME2</span> <span class="id">into</span> <span class="id">NAME1</span>; <span class="id">idtac</span> <span class="id">NAME1</span>; <span class="tactic">rename</span> <span class="id">tmp</span> <span class="id">into</span> <span class="id">NAME2</span><br/>
.<br/>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">top2_PreOrder</span> <span class="id">X</span>: <span class="id">PreOrder</span> (<span class="id">top2</span>: <span class="id">X</span> -&gt; <span class="id">X</span> -&gt; <span class="kwd">Prop</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">app_eq_inv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> (<span class="id">x0</span> <span class="id">x1</span> <span class="id">y0</span> <span class="id">y1</span>: <span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EQ</span>: <span class="id">x0</span> ++ <span class="id">x1</span> = <span class="id">y0</span> ++ <span class="id">y1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LEN</span>: <span class="id">x0</span>.(<span class="id">length</span>) = <span class="id">y0</span>.(<span class="id">length</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x0</span> = <span class="id">y0</span> /\ <span class="id">x1</span> = <span class="id">y1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6260')">Proof.</div>
<div class="proofscript" id="proof6260">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">x0</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">y0</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">y0</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">IHx0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pos_elim_succ</span>: <span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">ONE</span>: <span class="id">p</span> = 1%<span class="id">positive</span>&gt;&gt; \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SUCC</span>: <span class="id">exists</span> <span class="id">q</span>, <span class="id">q</span>.(<span class="id">Pos.succ</span>) = <span class="id">p</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6261')">Proof.</div>
<div class="proofscript" id="proof6261">
 <span class="id">i</span>. <span class="id">hexploit</span> (<span class="id">Pos.succ_pred_or</span> <span class="id">p</span>); <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ple_elim_succ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> <span class="id">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PLE</span>: <span class="id">Ple</span> <span class="id">p</span> <span class="id">q</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id">p</span> = <span class="id">q</span>&gt;&gt; \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SUCC</span>: <span class="id">Ple</span> <span class="id">p</span>.(<span class="id">Pos.succ</span>) <span class="id">q</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6262')">Proof.</div>
<div class="proofscript" id="proof6262">
&nbsp;&nbsp;<span class="id">revert_until</span> <span class="id">p</span>. <span class="tactic">pattern</span> <span class="id">p</span>. <span class="tactic">apply</span> <span class="id">Pos.peano_ind</span>; <span class="tactic">clear</span> <span class="id">p</span>; <span class="id">i</span>.<br/>
&nbsp;&nbsp;{ <span class="id">hexploit</span> (<span class="id">pos_elim_succ</span> <span class="id">q</span>); <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="id">clarify</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="id">r</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">pos_elim_succ</span> <span class="id">q</span>); <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">it</span> <span class="id">q0</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">r</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">r</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">FLIPS</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">flip2</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span>: (<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span> -&gt; <span class="id">D</span>) -&gt; <span class="id">A</span> -&gt; <span class="id">C</span> -&gt; <span class="id">B</span> -&gt; <span class="id">D</span>. <span class="tactic">intros</span>; <span class="tactic">eauto</span>. Defined.</div>
<span class="kwd">Definition</span> <span class="id">flip3</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span> <span class="id">E</span>: (<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span> -&gt; <span class="id">D</span> -&gt; <span class="id">E</span>) -&gt; <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">D</span> -&gt; <span class="id">C</span> -&gt; <span class="id">E</span>. <span class="tactic">intros</span>; <span class="tactic">eauto</span>. Defined.</div>
<span class="kwd">Definition</span> <span class="id">flip4</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span> <span class="id">E</span> <span class="id">F</span>: (<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span> -&gt; <span class="id">D</span> -&gt; <span class="id">E</span> -&gt; <span class="id">F</span>) -&gt; <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span> -&gt; <span class="id">E</span> -&gt; <span class="id">D</span> -&gt; <span class="id">F</span>. <span class="tactic">intros</span>; <span class="tactic">eauto</span>. Defined.</div>
<br/>
<span class="kwd">Variable</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span>: <span class="kwd">Type</span>.<br/>
<span class="kwd">Variable</span> <span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span> -&gt; <span class="id">D</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">put_dummy_arg_without_filp</span> <span class="id">A</span> <span class="id">DUMMY</span> <span class="id">B</span>: (<span class="id">A</span> -&gt; <span class="id">B</span>) -&gt; (<span class="id">A</span> -&gt; <span class="id">DUMMY</span> -&gt; <span class="id">B</span>) := <span class="kwd">fun</span> <span class="id">f</span> =&gt; (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">_</span> =&gt; <span class="id">f</span> <span class="id">a</span>).<br/>
<span class="kwd">Let</span> <span class="id">put_dummy_arg1</span> <span class="id">A</span> <span class="id">DUMMY</span> <span class="id">B</span>: (<span class="id">A</span> -&gt; <span class="id">B</span>) -&gt; (<span class="id">A</span> -&gt; <span class="id">DUMMY</span> -&gt; <span class="id">B</span>) := <span class="kwd">fun</span> <span class="id">f</span> =&gt; (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>).(<span class="id">flip</span>).<br/>
<span class="kwd">Let</span> <span class="id">put_dummy_arg21</span> <span class="id">A</span> <span class="id">DUMMY</span> <span class="id">B</span> <span class="id">C</span>: (<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) -&gt; (<span class="id">A</span> -&gt; <span class="id">DUMMY</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) := <span class="kwd">fun</span> <span class="id">f</span> =&gt; (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>).(<span class="id">flip</span>).<br/>
<span class="kwd">Let</span> <span class="id">put_dummy_arg22</span> <span class="id">A</span> <span class="id">B</span> <span class="id">DUMMY</span> <span class="id">C</span>: (<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">C</span>) -&gt; (<span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id">DUMMY</span> -&gt; <span class="id">C</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">f</span> =&gt; (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>).(<span class="id">flip</span>).(<span class="id">flip2</span>).<br/>
<br/>
<span class="kwd">End</span> <span class="id">FLIPS</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">flip2</span> <span class="id">flip3</span> <span class="id">flip4</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">DUMMY_PROP</span> := <span class="id">True</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">DUMMY_PROP</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">clarify_meq</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H0</span>: ?<span class="id">A</span> <span class="id">m</span>= ?<span class="id">B</span> |- <span class="id">_</span> ] =&gt; <span class="id">inv</span> <span class="id">H0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H0</span>: ?<span class="id">A</span> = ?<span class="id">A</span> -&gt; <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="id">check_safe</span>; <span class="tactic">intro</span>; <span class="id">des</span>; <span class="tactic">clear</span> <span class="id">H0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">list_nth_z</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">list_nth_z_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> (<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>) <span class="id">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">POS</span>: 0 &lt;= <span class="id">z</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_nth_z</span> <span class="id">l</span> <span class="id">z</span> = <span class="id">List.nth_error</span> <span class="id">l</span> <span class="id">z</span>.(<span class="id">Z.to_nat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6263')">Proof.</div>
<div class="proofscript" id="proof6263">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">l</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> ((<span class="id">Z.to_nat</span> <span class="id">z</span>)); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">des_ifs</span>. <span class="tactic">destruct</span> (<span class="id">Z.to_nat</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">z</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="id">ss</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="tactic">rewrite</span> <span class="id">Z2Nat.inj_pred</span>. <span class="tactic">rewrite</span> <span class="id">T</span>. <span class="id">ss</span>.<br/>
Qed.</div>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id">list_nth_z</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_nth_z_firstn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">T</span>:<span class="id">list_nth_z</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">x</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_nth_z</span> (<span class="id">firstn</span> (<span class="id">Z.to_nat</span> (<span class="id">n</span> + 1)) <span class="id">l</span>) <span class="id">n</span> = <span class="id">Some</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6264')">Proof.</div>
<div class="proofscript" id="proof6264">
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">list_nth_z_range</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">RANGE</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">list_nth_z_eq</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="tactic">rewrite</span> <span class="id">Z2Nat.inj_add</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">Pos2Nat.inj_1</span>. <span class="tactic">rewrite</span> <span class="id">Nat.add_comm</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">nth_error_Some</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">X</span>. <span class="tactic">rewrite</span> <span class="id">T</span> <span class="kwd">in</span> <span class="id">X</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">X</span>; <span class="tactic">eauto</span>. { <span class="id">ss</span>. } <span class="tactic">intro</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- (<span class="id">firstn_skipn</span> (1 + (<span class="id">Z.to_nat</span> <span class="id">n</span>)) <span class="id">l</span>) <span class="kwd">in</span> <span class="id">T</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">nth_error_app1</span> <span class="kwd">in</span> <span class="id">T</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">firstn_length</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">firstn_S</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">le</span> (<span class="id">Datatypes.length</span> <span class="id">l</span>) <span class="id">n</span> /\ <span class="id">firstn</span> (<span class="id">n</span> + 1) <span class="id">l</span> = <span class="id">firstn</span> <span class="id">n</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id">lt</span> <span class="id">n</span> (<span class="id">Datatypes.length</span> <span class="id">l</span>) /\ <span class="id">exists</span> <span class="id">x</span>, <span class="id">firstn</span> (<span class="id">n</span> + 1) <span class="id">l</span> = (<span class="id">firstn</span> <span class="id">n</span> <span class="id">l</span>) ++ [<span class="id">x</span>]).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6265')">Proof.</div>
<div class="proofscript" id="proof6265">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">l</span>; <span class="id">i</span>; <span class="tactic">try</span> <span class="tactic">by</span> (<span class="id">left</span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">firstn_nil</span>; <span class="tactic">split</span>; <span class="id">ss</span>; <span class="tactic">omega</span>). <span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id">right</span>. <span class="id">ss</span>. <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">n</span>). <span class="id">ss</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id">IHl0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id">IHl0</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">map_firstn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>) (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>) <span class="id">n</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> (<span class="id">firstn</span> <span class="id">n</span> <span class="id">l</span>) = <span class="id">firstn</span> <span class="id">n</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6266')">Proof.</div>
<div class="proofscript" id="proof6266">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">l</span>; <span class="id">ss</span>; <span class="id">i</span>.<br/>
&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">firstn_nil</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">IHl</span>. <span class="id">ss</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_nth_z_map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>) <span class="id">n</span> <span class="id">x</span> (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NTH</span>: <span class="id">list_nth_z</span> <span class="id">l</span> <span class="id">n</span> = <span class="id">Some</span> <span class="id">x</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_nth_z</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>) <span class="id">n</span> = <span class="id">Some</span> (<span class="id">f</span> <span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6267')">Proof.</div>
<div class="proofscript" id="proof6267">
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">list_nth_z_range</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">RANGE</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">list_nth_z_eq</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="tactic">rewrite</span> <span class="id">list_map_nth</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">NTH</span>. <span class="id">ss</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tail_In</span> <span class="id">A</span> <span class="id">l0</span> <span class="id">l1</span> (<span class="id">a</span>: <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IN</span>: <span class="id">In</span> <span class="id">a</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id">is_tail</span> <span class="id">l0</span> <span class="id">l1</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">a</span> <span class="id">l1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6268')">Proof.</div>
<div class="proofscript" id="proof6268">
 <span class="tactic">induction</span> <span class="id">TAIL</span>; <span class="tactic">auto</span>. <span class="id">econs</span> 2; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Forall2_apply_Forall2</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span> (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">C</span>) (<span class="id">g</span> : <span class="id">B</span> -&gt; <span class="id">D</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">Q</span>: <span class="id">C</span> -&gt; <span class="id">D</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">la</span> <span class="id">lb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FORALL</span>: <span class="id">Forall2</span> <span class="id">P</span> <span class="id">la</span> <span class="id">lb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IMPLY</span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">INA</span>: <span class="id">In</span> <span class="id">a</span> <span class="id">la</span>) (<span class="id">INB</span>: <span class="id">In</span> <span class="id">b</span> <span class="id">lb</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id">Q</span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id">g</span> <span class="id">b</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall2</span> <span class="id">Q</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">la</span>) (<span class="id">map</span> <span class="id">g</span> <span class="id">lb</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6269')">Proof.</div>
<div class="proofscript" id="proof6269">
&nbsp;&nbsp;<span class="id">ginduction</span> <span class="id">la</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="id">inv</span> <span class="id">FORALL</span>; <span class="id">ss</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">forall2_in_exists</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">la</span> <span class="id">lb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ALL</span>: <span class="id">list_forall2</span> <span class="id">P</span> <span class="id">la</span> <span class="id">lb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IN</span>: <span class="id">In</span> <span class="id">a</span> <span class="id">la</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>, (&lt;&lt;<span class="id">IN</span>: <span class="id">In</span> <span class="id">b</span> <span class="id">lb</span>&gt;&gt;) /\ (&lt;&lt;<span class="id">SAT</span>: <span class="id">P</span> <span class="id">a</span> <span class="id">b</span>&gt;&gt;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6270')">Proof.</div>
<div class="proofscript" id="proof6270">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">la</span> <span class="id">lb</span> <span class="id">ALL</span> <span class="id">a</span> <span class="id">IN</span>. <span class="tactic">induction</span> <span class="id">la</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">ALL</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;- <span class="id">clarify</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHla</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">econs</span> 2. <span class="tactic">auto</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
