
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module UpperBound_A</title>
<meta name="description" content="Documentation of Coq module UpperBound_A" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module UpperBound_A</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CoqlibC</span> <span class="id">MapsC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ASTC</span> <span class="id">Integers</span> <span class="id">Floats</span> <span class="id">Values</span> <span class="id">MemoryC</span> <span class="id">Events</span> <span class="id">Globalenvs</span> <span class="id">Smallstep</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Locations</span> <span class="id">Stacklayout</span> <span class="id">Conventions</span> <span class="id">Linking</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Csem</span> <span class="id">Cop</span> <span class="id">Ctypes</span> <span class="id">Ctyping</span> <span class="id">Csyntax</span> <span class="id">Cexec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Simulation</span> <span class="id">Memory</span> <span class="id">ValuesC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Skeleton</span> <span class="id">ModSem</span> <span class="id">Mod</span> <span class="id">sflib</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CtypesC</span> <span class="id">CsemC</span> <span class="id">Sem</span> <span class="kwd">Syntax</span> <span class="id">LinkingC</span> <span class="kwd">Program</span> <span class="id">SemProps</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Equality</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CtypingC</span> <span class="id">LinkingC2</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">UpperBound_AExtra</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id">LINKLEMMAS</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">internal_link_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp1</span>:<span class="id">Csyntax.program</span>) <span class="id">cp2</span> <span class="id">cp_link</span> <span class="id">id</span> <span class="id">func1</span> <span class="id">func2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id">link</span> <span class="id">cp1</span> <span class="id">cp2</span> = <span class="id">Some</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP1</span>: (<span class="id">prog_defmap</span> <span class="id">cp1</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP2</span>: (<span class="id">prog_defmap</span> <span class="id">cp2</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func2</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">False</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7305')">Proof.</div>
<div class="proofscript" id="proof7305">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">link_prog_inv</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heq</span>). <span class="tactic">intro</span> <span class="id">LINKSPEC</span>; <span class="id">des</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">LINKSPEC0</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_def</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">internal_link_internal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp1</span>:<span class="id">Csyntax.program</span>) <span class="id">cp2</span> <span class="id">cp</span> <span class="id">cp_link</span> <span class="id">id</span> <span class="id">func1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id">link</span> <span class="id">cp1</span> <span class="id">cp2</span> = <span class="id">Some</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CP</span>: <span class="id">cp</span> = <span class="id">cp1</span> \/ <span class="id">cp</span> = <span class="id">cp2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP1</span>: (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func1</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">func2</span>, (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7306')">Proof.</div>
<div class="proofscript" id="proof7306">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">link_prog_inv</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heq</span>). <span class="tactic">intro</span> <span class="id">LINKSPEC</span>; <span class="id">des_safe</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">AST.prog_defs</span> := <span class="id">PTree.elements</span> (<span class="id">PTree.combine</span> <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">cp1</span>) (<span class="id">prog_defmap</span> <span class="id">cp2</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">AST.prog_public</span> := <span class="id">AST.prog_public</span> <span class="id">cp1</span> ++ <span class="id">AST.prog_public</span> <span class="id">cp2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">AST.prog_main</span> := <span class="id">AST.prog_main</span> <span class="id">cp1</span> |} <span class="kwd">as</span> <span class="id">p</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">DEFS</span>: <span class="id">AST.prog_defs</span> <span class="id">p</span> = <span class="id">PTree.elements</span> (<span class="id">PTree.combine</span> <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">cp1</span>) (<span class="id">prog_defmap</span> <span class="id">cp2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clarify</span>; <span class="id">ss</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">DEFREL</span>: <span class="kwd">forall</span> <span class="id">id</span> : <span class="id">positive</span>, (<span class="id">prog_defmap</span> <span class="id">p</span>) ! <span class="id">id</span> = <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">cp1</span>) ! <span class="id">id</span> (<span class="id">prog_defmap</span> <span class="id">cp2</span>) ! <span class="id">id</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_Properties.of_list_elements</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DEFREL</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_prog_merge</span> <span class="kwd">in</span> *. <span class="id">des</span>; <span class="tactic">subst</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">LINKSPEC0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_def</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_fundef</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">LINKSPEC0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_def</span>. <span class="tactic">unfold</span> <span class="id">link_def</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_fundef</span>. <span class="tactic">unfold</span> <span class="id">link_fundef</span> <span class="kwd">in</span> <span class="id">Heq4</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_defmap_exists_aux</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp</span>:<span class="id">Csyntax.program</span>) <span class="id">cps</span> <span class="id">cp_link</span> <span class="id">id</span> <span class="id">func</span> <span class="id">cp_part</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id">link_list</span> (<span class="id">cp</span>::<span class="id">cps</span>) = <span class="id">Some</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK0</span>: <span class="id">link_list</span> <span class="id">cps</span> = <span class="id">Some</span> <span class="id">cp_part</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFMAP</span>: (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/ ((<span class="id">prog_defmap</span> <span class="id">cp_part</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7307')">Proof.</div>
<div class="proofscript" id="proof7307">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">link</span> <span class="id">cp</span> <span class="id">cp_part</span> = <span class="id">Some</span> <span class="id">cp_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">cps</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>. <span class="tactic">eapply</span> <span class="id">LINK</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Csyntax.program</span> <span class="kwd">in</span> *. <span class="id">des</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">link_prog_inv</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heq</span>). <span class="tactic">intro</span> <span class="id">LINKSPEC</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">DEFS</span>: <span class="id">AST.prog_defs</span> <span class="id">p</span> = <span class="id">PTree.elements</span> (<span class="id">PTree.combine</span> <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">cp</span>) (<span class="id">prog_defmap</span> <span class="id">cp_part</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clarify</span>; <span class="id">ss</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">DEFREL</span>: <span class="kwd">forall</span> <span class="id">id</span> : <span class="id">positive</span>, (<span class="id">prog_defmap</span> <span class="id">p</span>) ! <span class="id">id</span> = <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">id</span> (<span class="id">prog_defmap</span> <span class="id">cp_part</span>) ! <span class="id">id</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree_Properties.of_list_elements</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DEFREL</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_prog_merge</span> <span class="kwd">in</span> <span class="id">DEFMAP</span>. <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">LINKSPEC0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_def</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_def</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_fundef</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_fundef</span> <span class="kwd">in</span> <span class="id">Heq4</span>. <span class="id">des_ifs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">same_prog_aux</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp</span>:<span class="id">Csyntax.program</span>) <span class="id">cps</span> <span class="id">cp_link</span> <span class="id">id</span> (<span class="id">if_sig</span>:<span class="id">function</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id">link_list</span> <span class="id">cps</span> = <span class="id">Some</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">if_sig0</span>, (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig0</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7308')">Proof.</div>
<div class="proofscript" id="proof7308">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">DMAP</span>. <span class="id">revert</span> <span class="id">LINK</span>. <span class="id">revert</span> <span class="id">FOC</span>. <span class="id">revert</span> <span class="id">if_sig</span>. <span class="id">revert</span> <span class="id">id</span>. <span class="id">revert</span> <span class="id">cp_link</span>. <span class="id">revert</span> <span class="id">cp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cps</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="tactic">destruct</span> <span class="id">cps</span> <span class="kwd">as</span> [|<span class="id">cp</span>' <span class="id">cps</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id">link_list</span> <span class="kwd">in</span> <span class="id">LINK</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des_safe</span>. <span class="id">inv</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">cp</span> = <span class="id">cp</span>) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">internal_link_internal</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1:= <span class="id">cp</span>). <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHcps</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">internal_link_internal</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">restl</span>). <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">same_prog_aux1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cp1</span>:<span class="id">Csyntax.program</span>) <span class="id">cp2</span> <span class="id">cps</span> <span class="id">cp_link</span> <span class="id">id</span> <span class="id">func1</span> <span class="id">func2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC1</span> : <span class="id">In</span> <span class="id">cp1</span> <span class="id">cps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC2</span> : <span class="id">In</span> <span class="id">cp2</span> <span class="id">cps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id">link_list</span> <span class="id">cps</span> = <span class="id">Some</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP1</span>: (<span class="id">prog_defmap</span> <span class="id">cp1</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP2</span>: (<span class="id">prog_defmap</span> <span class="id">cp2</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NEQ</span>: <span class="id">cp1</span> &lt;&gt; <span class="id">cp2</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">False</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7309')">Proof.</div>
<div class="proofscript" id="proof7309">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">NEQ</span>. <span class="id">revert</span> <span class="id">DMAP1</span>. <span class="id">revert</span> <span class="id">DMAP2</span>. <span class="id">revert</span> <span class="id">LINK</span>. <span class="id">revert</span> <span class="id">FOC1</span>. <span class="id">revert</span> <span class="id">FOC2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">func1</span>. <span class="id">revert</span> <span class="id">func2</span>. <span class="id">revert</span> <span class="id">id</span>. <span class="id">revert</span> <span class="id">cp_link</span>. <span class="id">revert</span> <span class="id">cp1</span>. <span class="id">revert</span> <span class="id">cp2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cps</span>; <span class="id">ss</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">cps</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">same_prog_aux</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">TL</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">internal_link_false</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">cps</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">same_prog_aux</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">TL</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">internal_link_false</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">cps</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHcps</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">LINKLEMMAS</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">PRESERVATION</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">cp_link</span>: <span class="id">Csyntax.program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">cps</span>: <span class="id">list</span> <span class="id">Csyntax.program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">ctx</span>: <span class="id">Syntax.program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">FOCUS</span>: <span class="id">link_list</span> <span class="id">cps</span> = <span class="id">Some</span> <span class="id">cp_link</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">prog_src</span> := <span class="id">ctx</span> ++ [<span class="id">cp_link</span>.(<span class="id">CsemC.module</span>)].<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">prog_tgt</span> := <span class="id">ctx</span> ++ <span class="id">map</span> <span class="id">CsemC.module</span> <span class="id">cps</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">sk_link</span>: <span class="id">Sk.t</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">skenv_link</span>: <span class="id">SkEnv.t</span> := (<span class="id">Sk.load_skenv</span> <span class="id">sk_link</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id">LINKSRC</span>: <span class="id">link_sk</span> <span class="id">prog_src</span> = <span class="id">Some</span> <span class="id">sk_link</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> " '<span class="id">geof</span>' <span class="id">cp</span>" := (<span class="id">Build_genv</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> <span class="id">cp</span>.(<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span>)) <span class="id">cp</span>) <span class="id">cp</span>.(<span class="id">prog_comp_env</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 50, <span class="id">no</span> <span class="id">associativity</span>, <span class="id">only</span> <span class="id">parsing</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">ge_cp_link</span>: <span class="id">genv</span> := <span class="id">geof</span> <span class="id">cp_link</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WTPROGLINK</span>: <span class="id">wt_program</span> <span class="id">cp_link</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WTSKLINK</span>: <span class="id">Sk.wf</span> <span class="id">cp_link</span>.(<span class="id">CsemC.module</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WTPROGS</span>: <span class="kwd">forall</span> <span class="id">cp</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>), <span class="id">wt_program</span> <span class="id">cp</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WTSKS</span>: <span class="kwd">forall</span> <span class="id">cp</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>), <span class="id">Sk.wf</span> <span class="id">cp</span>.(<span class="id">CsemC.module</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WT_EXTERNALLINK</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> <span class="id">cc</span> <span class="id">vargs</span> <span class="id">m</span> <span class="id">t</span> <span class="id">vres</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> (<span class="id">External</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> <span class="id">cc</span>)) <span class="id">cp_link</span>.(<span class="id">prog_defs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call</span> <span class="id">ef</span> <span class="id">skenv_link</span> <span class="id">vargs</span> <span class="id">m</span> <span class="id">t</span> <span class="id">vres</span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_retval</span> <span class="id">vres</span> <span class="id">res</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WT_EXTERNALS</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cp</span> (<span class="id">IN</span>: <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> <span class="id">cc</span> <span class="id">vargs</span> <span class="id">m</span> <span class="id">t</span> <span class="id">vres</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> (<span class="id">External</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> <span class="id">cc</span>)) <span class="id">cp</span>.(<span class="id">prog_defs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call</span> <span class="id">ef</span> <span class="id">skenv_link</span> <span class="id">vargs</span> <span class="id">m</span> <span class="id">t</span> <span class="id">vres</span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wt_retval</span> <span class="id">vres</span> <span class="id">res</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">is_focus</span> (<span class="id">cp</span>: <span class="id">Csyntax.program</span>): <span class="kwd">Prop</span> := <span class="id">In</span> <span class="id">cp</span> <span class="id">cps</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id">builtins</span>: <span class="id">list</span> (<span class="id">ident</span> * <span class="id">globdef</span> (<span class="id">Ctypes.fundef</span> <span class="id">function</span>) <span class="id">type</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">BINCLLINK</span>: <span class="id">incl</span> <span class="id">builtins</span> (<span class="id">prog_defs</span> <span class="id">cp_link</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">BINTERNALLINK</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">fd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> <span class="id">fd</span>) (<span class="id">prog_defs</span> <span class="id">cp_link</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">is_external_fd</span> <span class="id">fd</span> -&gt; <span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> <span class="id">fd</span>) <span class="id">builtins</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">BINCL</span>: <span class="kwd">forall</span> <span class="id">cp</span>, <span class="id">is_focus</span> <span class="id">cp</span> -&gt; <span class="id">incl</span> <span class="id">builtins</span> (<span class="id">prog_defs</span> <span class="id">cp</span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">BINTERNAL</span>: <span class="kwd">forall</span> <span class="id">cp</span> (<span class="id">IN</span>: <span class="id">is_focus</span> <span class="id">cp</span>) <span class="id">id</span> <span class="id">fd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> <span class="id">fd</span>) (<span class="id">prog_defs</span> <span class="id">cp</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">is_external_fd</span> <span class="id">fd</span> -&gt; <span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> <span class="id">fd</span>) <span class="id">builtins</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">CSTYLE_EXTERN_LINK</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, (<span class="id">Gfun</span> (<span class="id">Ctypes.External</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span>))) <span class="id">cp_link</span>.(<span class="id">prog_defs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ef</span>.(<span class="id">ef_sig</span>).(<span class="id">sig_cstyle</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">CSTYLE_EXTERN</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span> <span class="id">cp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_focus</span> <span class="id">cp</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">id</span>, (<span class="id">Gfun</span> (<span class="id">Ctypes.External</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">ty</span> <span class="id">cc</span>))) <span class="id">cp</span>.(<span class="id">prog_defs</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ef</span>.(<span class="id">ef_sig</span>).(<span class="id">sig_cstyle</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">INCL</span>: <span class="id">SkEnv.includes</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7310')">Proof.</div>
<div class="proofscript" id="proof7310">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_includes</span>. <span class="tactic">eapply</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">prog_src</span>. <span class="id">instantiate</span> (1 := (<span class="id">module</span> <span class="id">cp_link</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_or_app</span>. <span class="id">ss</span>. <span class="tactic">auto</span>. <span class="id">ss</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">LINKTGT</span>: <span class="id">link_sk</span> <span class="id">prog_tgt</span> = <span class="id">Some</span> <span class="id">sk_link</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7311')">Proof.</div>
<div class="proofscript" id="proof7311">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">UpperBound_AExtra.link_sk_match</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">prog_tgt</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">INCL_FOCUS</span>: <span class="kwd">forall</span> <span class="id">pgm</span>, <span class="id">is_focus</span> <span class="id">pgm</span> -&gt; <span class="id">SkEnv.includes</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">pgm</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7312')">Proof.</div>
<div class="proofscript" id="proof7312">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">exploit</span> <span class="id">link_includes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">LINKTGT</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">prog_tgt</span>. <span class="id">instantiate</span> (1 := (<span class="id">module</span> <span class="id">pgm</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> *. <span class="id">r</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">right</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">esplits</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Let</span> <span class="id">sum_cont</span> := <span class="id">sum_cont</span> <span class="id">cps</span> <span class="id">sk_link</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">match_focus</span>: <span class="id">Frame.t</span> -&gt; <span class="id">list</span> <span class="id">Frame.t</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">match_focus_cons_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cst_src</span> <span class="id">cst_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tl_tgt</span> <span class="id">k_tl_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SUM</span>: <span class="id">sum_cont</span> <span class="id">tl_tgt</span> <span class="id">k_tl_tgt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ST</span>: <span class="id">match_focus_state</span> <span class="id">cst_src</span> <span class="id">cst_tgt</span> <span class="id">k_tl_tgt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOCUS</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTSRC</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> <span class="id">ge_cp_link</span> <span class="id">cst_src</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WTTGT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">cst_tgt</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_focus</span> (<span class="id">Frame.mk</span> (<span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp_link</span>) <span class="id">cst_src</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">Frame.mk</span> (<span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp</span>) <span class="id">cst_tgt</span>) :: <span class="id">tl_tgt</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">match_focus_nonnil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fr</span> <span class="id">frs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FC</span>: <span class="id">match_focus</span> <span class="id">fr</span> <span class="id">frs</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">NONNIL</span>: <span class="id">frs</span> &lt;&gt; []&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7313')">Proof.</div>
<div class="proofscript" id="proof7313">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FC</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">match_stacks</span>: <span class="id">list</span> <span class="id">Frame.t</span> -&gt; <span class="id">list</span> <span class="id">Frame.t</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">match_stacks_nil</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_stacks</span> [] []<br/>
&nbsp;&nbsp;| <span class="id">match_stacks_cons_ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tail_src</span> <span class="id">tail_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id">match_stacks</span> <span class="id">tail_src</span> <span class="id">tail_tgt</span>) <span class="id">hd</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_stacks</span> (<span class="id">hd</span> :: <span class="id">tail_src</span>) (<span class="id">hd</span> :: <span class="id">tail_tgt</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_stacks_focus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tail_src</span> <span class="id">tail_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id">match_stacks</span> <span class="id">tail_src</span> <span class="id">tail_tgt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hd_src</span> <span class="id">hds_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HD</span>: <span class="id">match_focus</span> <span class="id">hd_src</span> <span class="id">hds_tgt</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_stacks</span> (<span class="id">hd_src</span> :: <span class="id">tail_src</span>) (<span class="id">hds_tgt</span> ++ <span class="id">tail_tgt</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">match_stacks_right_nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">frs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id">match_stacks</span> <span class="id">frs</span> []) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">NIL</span>: <span class="id">frs</span> = []&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7314')">Proof.</div>
<div class="proofscript" id="proof7314">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">hds_tgt</span>, <span class="id">tail_tgt</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_focus_nonnil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">match_states</span> : <span class="id">Sem.state</span> -&gt; <span class="id">Sem.state</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">match_states_normal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">frs_src</span> <span class="id">frs_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id">match_stacks</span> <span class="id">frs_src</span> <span class="id">frs_tgt</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> (<span class="id">State</span> <span class="id">frs_src</span>) (<span class="id">State</span> <span class="id">frs_tgt</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_states_call</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">frs_src</span> <span class="id">frs_tgt</span> <span class="id">args</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id">match_stacks</span> <span class="id">frs_src</span> <span class="id">frs_tgt</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> (<span class="id">Callstate</span> <span class="id">args</span> <span class="id">frs_src</span>) (<span class="id">Callstate</span> <span class="id">args</span> <span class="id">frs_tgt</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">init_fsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">st_init_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INIT</span>: <span class="id">initial_state</span> <span class="id">prog_src</span> <span class="id">st_init_src</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">i0</span>: <span class="id">unit</span>) <span class="id">st_init_tgt</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">INIT</span>: <span class="id">Dinitial_state</span> (<span class="id">sem</span> <span class="id">prog_tgt</span>) <span class="id">st_init_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">MATCH</span>: <span class="id">match_states</span> <span class="id">st_init_src</span> <span class="id">st_init_tgt</span>&gt;&gt;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7315')">Proof.</div>
<div class="proofscript" id="proof7315">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tt</span>, <span class="id">st_init_src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">INIT</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;init&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">prog_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id">UpperBound_AExtra.link_sk_match</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_src</span> <span class="kwd">in</span> <span class="id">WF</span>. <span class="tactic">unfold</span> <span class="id">prog_tgt</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> <span class="id">IN</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">WF</span>; <span class="id">et</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">in_map_iff</span> <span class="kwd">in</span> *. <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;dtm&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">INIT0</span>; <span class="id">inv</span> <span class="id">INIT1</span>; <span class="id">ss</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">link_sk_match</span>; <span class="id">i</span>. <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">INIT</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">final_bsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">retv</span> <span class="id">frs_src</span> <span class="id">frs_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MATCH</span>: <span class="id">match_states</span> (<span class="id">State</span> <span class="id">frs_src</span>) (<span class="id">State</span> <span class="id">frs_tgt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FINAL</span>: <span class="id">final_state</span> (<span class="id">State</span> <span class="id">frs_tgt</span>) <span class="id">retv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SAFESRC</span>: <span class="id">safe</span> (<span class="id">sem</span> <span class="id">prog_src</span>) (<span class="id">State</span> <span class="id">frs_src</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">FINAL</span>: <span class="id">final_state</span> (<span class="id">State</span> <span class="id">frs_src</span>) <span class="id">retv</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7316')">Proof.</div>
<div class="proofscript" id="proof7316">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">inv</span> <span class="id">FINAL</span>. <span class="id">inv</span> <span class="id">MATCH</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">match_stacks_right_nil</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">app_length</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">LEN</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> <span class="id">match_focus_nonnil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">hds_tgt</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">tail_tgt</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="tactic">destruct</span> <span class="id">hds_tgt</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_stacks_right_nil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>. <span class="id">inv</span> <span class="id">HD</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">SUM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FINAL0</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">ST</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">final_fsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">retv</span> <span class="id">frs_src</span> <span class="id">frs_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MATCH</span>: <span class="id">match_states</span> (<span class="id">State</span> <span class="id">frs_src</span>) (<span class="id">State</span> <span class="id">frs_tgt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FINAL</span>: <span class="id">final_state</span> (<span class="id">State</span> <span class="id">frs_src</span>) <span class="id">retv</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">DFINAL</span>: <span class="id">Dfinal_state</span> (<span class="id">sem</span> <span class="id">prog_tgt</span>) (<span class="id">State</span> <span class="id">frs_tgt</span>) <span class="id">retv</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7317')">Proof.</div>
<div class="proofscript" id="proof7317">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">FINAL</span>. <span class="id">inv</span> <span class="id">MATCH</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">TAIL</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">TAIL</span>. <span class="tactic">rewrite</span> <span class="id">app_nil_r</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">HD</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">FINAL0</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">ST</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexpl</span> <span class="id">app_cont_kstop_inv</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexpl</span> <span class="id">sum_cont_kstop_inv</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">FINAL0</span>; <span class="id">inv</span> <span class="id">FINAL1</span>; <span class="id">ss</span>. <span class="id">determ_tac</span> <span class="id">ModSem.final_frame_dtm</span>. <span class="tactic">rewrite</span> <span class="id">INT</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FINAL</span>. <span class="id">inv</span> <span class="id">MATCH</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">TAIL</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">ModSem.tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">TAIL</span>. <span class="tactic">rewrite</span> <span class="id">app_nil_r</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">FINAL0</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">ss</span>; <span class="id">ModSem.tac</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">WTMODULE</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WFSRC</span>: <span class="kwd">forall</span> <span class="id">md</span> : <span class="id">Mod.t</span>, <span class="id">In</span> <span class="id">md</span> <span class="id">prog_src</span> -&gt; <span class="id">Sk.wf</span> <span class="id">md</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">WFTGT</span>: <span class="kwd">forall</span> <span class="id">md</span> : <span class="id">Mod.t</span>, <span class="id">In</span> <span class="id">md</span> <span class="id">prog_tgt</span> -&gt; <span class="id">Sk.wf</span> <span class="id">md</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">id_in_prog</span> (<span class="id">prog</span>:<span class="id">Csyntax.program</span>) <span class="id">id</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">defs</span> <span class="id">prog</span> <span class="id">id</span> &lt;-&gt; <span class="id">In</span> <span class="id">id</span> (<span class="id">prog_defs_names</span> <span class="id">prog</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7318')">Proof.</div>
<div class="proofscript" id="proof7318">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">i</span>; <span class="tactic">unfold</span> <span class="id">defs</span>, <span class="id">in_dec</span>, <span class="id">ident_eq</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> (<span class="id">prog_defs_names</span> <span class="id">prog</span>); <span class="id">ss</span>; <span class="id">des_ifs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">id_not_in_prog</span> (<span class="id">prog</span>:<span class="id">Csyntax.program</span>) <span class="id">id</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">defs</span> <span class="id">prog</span> <span class="id">id</span> &lt;-&gt; ~ <span class="id">In</span> <span class="id">id</span> (<span class="id">prog_defs_names</span> <span class="id">prog</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7319')">Proof.</div>
<div class="proofscript" id="proof7319">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">i</span>; <span class="tactic">unfold</span> <span class="id">not</span>; <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">id_in_prog</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">id_in_prog</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">not_prog_defmap_spec</span> <span class="id">F</span> <span class="id">V</span> <span class="id">p</span> <span class="id">id</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">In</span> <span class="id">id</span> (<span class="id">prog_defs_names</span> <span class="id">p</span>) &lt;-&gt; ~ (<span class="id">exists</span> <span class="id">g</span> : <span class="id">globdef</span> <span class="id">F</span> <span class="id">V</span>, (<span class="id">prog_defmap</span> <span class="id">p</span>) ! <span class="id">id</span> = <span class="id">Some</span> <span class="id">g</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7320')">Proof.</div>
<div class="proofscript" id="proof7320">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">i</span>; <span class="tactic">unfold</span> <span class="id">not</span>; <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">prog_defmap_spec</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">des</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">cp_link_precise</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SkEnv.genv_precise</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">cp_link</span>) <span class="id">cp_link</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7321')">Proof.</div>
<div class="proofscript" id="proof7321">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">CSkEnv.project_revive_precise</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">SkEnv.project_impl_spec</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">is_focus_precise</span> <span class="id">pgm</span> (<span class="id">FOCUS1</span>: <span class="id">is_focus</span> <span class="id">pgm</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SkEnv.genv_precise</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">pgm</span>)) <span class="id">pgm</span>) <span class="id">pgm</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7322')">Proof.</div>
<div class="proofscript" id="proof7322">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">CSkEnv.project_revive_precise</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">SkEnv.project_impl_spec</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">defmap_with_signature_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">gd</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) ! <span class="id">i</span> = <span class="id">Some</span> <span class="id">gd</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">g</span>, (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span> = <span class="id">Some</span> <span class="id">g</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7323')">Proof.</div>
<div class="proofscript" id="proof7323">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">defmap_with_signature_rev_internal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">if_sig</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DMAP</span>: (<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">AST.Internal</span> <span class="id">if_sig</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">if_sig0</span>, (<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig0</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7324')">Proof.</div>
<div class="proofscript" id="proof7324">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">destruct</span> <span class="id">f1</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_def_exists_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">fptr</span> <span class="id">if_sig</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNAL</span> : <span class="id">Genv.find_funct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fptr</span> = <span class="id">Some</span> (<span class="id">AST.Internal</span> <span class="id">if_sig</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">if_sig0</span>, <span class="id">Genv.find_funct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">fptr</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">AST.Internal</span> <span class="id">if_sig0</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7325')">Proof.</div>
<div class="proofscript" id="proof7325">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">Genv.genv_defs</span> <span class="id">skenv_link</span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">Hdefs</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">Hsymb</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">Hdefmap</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">defmap_with_signature_rev_internal</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">g</span>', (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span> = <span class="id">Some</span> <span class="id">g</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">prog_defmap_exists_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">eauto</span>. } <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">if_sig0</span>, (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">link_program</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_prog</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> <span class="kwd">in</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_linkorder</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">ORD</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">ORD</span>. <span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">ORD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ORD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">ORD0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_program</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">ORD0</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (@<span class="id">prog_defmap_linkorder</span> (<span class="id">Ctypes.fundef</span> <span class="id">function</span>) <span class="id">type</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="id">des</span>. <span class="id">inv</span> <span class="id">P0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>. <span class="id">exploit</span> <span class="id">defmap_with_signature_internal</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">if_sig2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span>. <span class="tactic">rewrite</span> <span class="id">Hdefs</span>. <span class="tactic">rewrite</span> <span class="id">Hsymb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">internals_linking</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_find_defs_revive_rev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">b</span> <span class="id">func</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">func</span>', <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">cp_link</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> <span class="id">func</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7326')">Proof.</div>
<div class="proofscript" id="proof7326">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">destruct</span> ((<span class="id">Genv.genv_defs</span> <span class="id">skenv_link</span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">GENVDEF</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma1</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eapply</span> <span class="id">defmap_with_signature</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span>. <span class="tactic">rewrite</span> <span class="id">GENVDEF</span>. <span class="tactic">rewrite</span> <span class="id">SYMBSKENV</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_exists_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">func</span>'. <span class="id">des_ifs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">defmap_with_signature</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">internals_linking</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="id">exploit</span> <span class="id">defmap_with_signature</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">i</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_defmap_exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">id</span> <span class="id">func</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFMAP</span>: (<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pgm</span>, <span class="id">is_focus</span> <span class="id">pgm</span> /\ (<span class="id">prog_defmap</span> <span class="id">pgm</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">func</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7327')">Proof.</div>
<div class="proofscript" id="proof7327">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">is_focus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">DEFMAP</span> <span class="id">FOCUS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">DEFMAP</span>. <span class="id">revert</span> <span class="id">FOCUS</span>. <span class="id">revert</span> <span class="id">func</span>. <span class="id">revert</span> <span class="id">id</span>. <span class="id">revert</span> <span class="id">cp_link</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cps</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="tactic">destruct</span> <span class="id">l</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">link_list</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">exists</span> <span class="id">cp_link</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">link_list_cons_inv</span>. <span class="tactic">eapply</span> <span class="id">FOCUS</span>. <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_exists_aux</span>. <span class="tactic">eapply</span> <span class="id">FOCUS</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exists</span> <span class="id">a</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pgm</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_def_same</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> <span class="id">if_sig</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">cp_link</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">cp</span>, <span class="id">is_focus</span> <span class="id">cp</span> /\ <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">b</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7328')">Proof.</div>
<div class="proofscript" id="proof7328">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_exists</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pgm</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMB</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">SYMBSKENV</span>. <span class="id">clarify</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">pgm</span>)) <span class="id">b</span> = <span class="id">Some</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMB</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">SYMBSKENV</span>. <span class="id">clarify</span>. } <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SYMBSKENV</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">defmap_with_signature</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_internals</span> <span class="kwd">in</span> <span class="id">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prog_def_exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">if_sig</span> <span class="id">fptr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNAL</span> : <span class="id">Genv.find_funct</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">fptr</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">AST.Internal</span> <span class="id">if_sig</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pgm</span>, <span class="id">is_focus</span> <span class="id">pgm</span> /\ <span class="id">exists</span> <span class="id">sig</span>, <span class="id">Genv.find_funct</span> (<span class="id">ModSem.skenv</span> (<span class="id">modsem</span> <span class="id">skenv_link</span> <span class="id">pgm</span>)) <span class="id">fptr</span> = <span class="id">Some</span> (<span class="id">AST.Internal</span> <span class="id">sig</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7329')">Proof.</div>
<div class="proofscript" id="proof7329">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">Genv.genv_defs</span> <span class="id">skenv_link</span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">Hdefs</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">Hsymb</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_internals</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">Hdefmap</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">CSk.of_program_prog_defmap</span>. <span class="id">instantiate</span> (1:=<span class="id">cp_link</span>). <span class="id">instantiate</span> (1:=<span class="id">signature_of_function</span>). <span class="id">instantiate</span> (1:= <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">MAPREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">g0</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">Hdefmap</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H1</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">Hdefmap</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_exists</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pgm</span>. <span class="id">splits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">is_focus_precise</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">P2GE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b0</span> = <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">SYMB</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_symbol</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_key_spec</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">DEF</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">DEF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">DEF</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">rewrite</span> <span class="id">Hdefs</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">rewrite</span> <span class="id">Hsymb</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">CSk.of_program_prog_defmap</span>. <span class="id">instantiate</span> (1:=<span class="id">pgm</span>). <span class="id">instantiate</span> (1:=<span class="id">signature_of_function</span>). <span class="id">instantiate</span> (1:= <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">MAPREL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">g1</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f0</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H5</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">exists</span> <span class="id">s</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span>. <span class="tactic">rewrite</span> <span class="id">Hdefs</span>. <span class="tactic">rewrite</span> <span class="id">Hsymb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">internals</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span>. <span class="tactic">simpl</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_fptr_owner_determ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fptr</span> <span class="id">ms0</span> <span class="id">ms1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND0</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_tgt</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> <span class="id">ms0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND1</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_tgt</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> <span class="id">ms1</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ms0</span> = <span class="id">ms1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7330')">Proof.</div>
<div class="proofscript" id="proof7330">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">SemProps.find_fptr_owner_determ</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">LINKTGT</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">same_prog</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp2</span> <span class="id">cp_top</span> <span class="id">blk</span> <span class="id">if_sig1</span> <span class="id">if_sig2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC1</span> : <span class="id">is_focus</span> <span class="id">cp2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC2</span>: <span class="id">is_focus</span> <span class="id">cp_top</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNAL1</span>: <span class="id">Genv.find_def</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) <span class="id">blk</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">AST.Internal</span> <span class="id">if_sig1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INTERNAL2</span>: <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp2</span>)) <span class="id">cp2</span>) <span class="id">blk</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig2</span>))) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp2</span> = <span class="id">cp_top</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7331')">Proof.</div>
<div class="proofscript" id="proof7331">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">blk</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp2</span>)) <span class="id">blk</span>) <span class="id">eqn</span>:<span class="id">SYMB1</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DEFMAP1</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp2</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DEFMAP2</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">invert_symbol_lemma1</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">SYMB1</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">i0</span>. <span class="id">exploit</span> <span class="id">defmap_with_signature_rev_internal</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H</span> <span class="id">DEFMAP2</span> <span class="id">FOCUS</span> <span class="id">FOC1</span> <span class="id">FOC2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">cp2</span> = <span class="id">cp_top</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">is_focus</span> <span class="kwd">in</span> *. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">same_prog_aux1</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">msfind_fsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fptr</span> <span class="id">ms</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MSFIND</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_src</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> <span class="id">ms</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">MSFIND</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_tgt</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> <span class="id">ms</span>&gt;&gt;) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">cp</span>, (&lt;&lt;<span class="id">ISFOCSRC</span>: <span class="id">ms</span> = <span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp_link</span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (&lt;&lt;<span class="id">ISFOCTGT</span>: <span class="id">is_focus</span> <span class="id">cp</span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (&lt;&lt;<span class="id">MSFIND</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_tgt</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> (<span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp</span>)&gt;&gt;)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7332')">Proof.</div>
<div class="proofscript" id="proof7332">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">load_genv</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">MSFIND</span>. <span class="id">ss</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clarify</span>. <span class="id">left</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">ss</span>. <span class="id">left</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">load_modsems</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span> <span class="kwd">in</span> *. <span class="id">des</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id">prog_src</span> <span class="kwd">in</span> <span class="id">MODSEM0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> *. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">ss</span>. <span class="id">right</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">esplits</span>; <span class="id">et</span>. <span class="tactic">unfold</span> <span class="id">prog_tgt</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>. <span class="id">left</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">Genv.genv_defs</span> <span class="id">skenv_link</span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">Hdefs</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">Hsymb</span>; <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_internals</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">Hdefmap</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">CSk.of_program_prog_defmap</span>. <span class="id">instantiate</span> (1:=<span class="id">cp_link</span>). <span class="id">instantiate</span> (1:=<span class="id">signature_of_function</span>). <span class="id">instantiate</span> (1:= <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">MAPREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">g0</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">Hdefmap</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H1</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">Hdefmap</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_exists</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pgm</span>. <span class="id">splits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">is_focus_precise</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">P2GE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b0</span> = <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">SYMB</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_symbol</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_key_spec</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">DEF</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">DEF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">DEF</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">Heq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">rewrite</span> <span class="id">Hdefs</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="tactic">rewrite</span> <span class="id">Hsymb</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq1</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">CSk.of_program_prog_defmap</span>. <span class="id">instantiate</span> (1:=<span class="id">pgm</span>). <span class="id">instantiate</span> (1:=<span class="id">signature_of_function</span>). <span class="id">instantiate</span> (1:= <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">MAPREL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">g1</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f0</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MAPREL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H5</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">subst</span> <span class="id">prog_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">exists</span> (<span class="id">module</span> <span class="id">pgm</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">unfold</span> <span class="id">flip</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span>; <span class="id">right</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span>. <span class="tactic">rewrite</span> <span class="id">Hdefs</span>. <span class="tactic">rewrite</span> <span class="id">Hsymb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">internals</span>. <span class="tactic">rewrite</span> <span class="id">Heq3</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">msfind_bsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fptr</span> <span class="id">ms</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MSFIND</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_tgt</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> <span class="id">ms</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">MSFIND</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_src</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> <span class="id">ms</span>&gt;&gt;) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((&lt;&lt;<span class="id">MSFIND</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_src</span> <span class="id">skenv_link</span>) <span class="id">fptr</span> (<span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp_link</span>)&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">exists</span> <span class="id">cp</span>, (&lt;&lt;<span class="id">ISFOCSRC</span>: <span class="id">ms</span> = <span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp</span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (&lt;&lt;<span class="id">ISFOCTGT</span>: <span class="id">is_focus</span> <span class="id">cp</span>&gt;&gt;)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7333')">Proof.</div>
<div class="proofscript" id="proof7333">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">load_genv</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">MSFIND</span>. <span class="id">ss</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clarify</span>. <span class="id">left</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">ss</span>. <span class="id">left</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">load_modsems</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span> <span class="kwd">in</span> *. <span class="id">des</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id">prog_tgt</span> <span class="kwd">in</span> <span class="id">MODSEM0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> *. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">ss</span>. <span class="id">right</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">esplits</span>; <span class="id">et</span>. <span class="tactic">unfold</span> <span class="id">prog_src</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>. <span class="id">left</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">flip</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span> <span class="kwd">in</span> *. <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>; <span class="id">rr</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_def_exists_rev</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">is_focus</span>. <span class="tactic">auto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">exists</span> (<span class="id">CsemC.module</span> <span class="id">cp_link</span>). <span class="id">ss</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_src</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>. <span class="id">right</span>; <span class="id">ss</span>. <span class="id">left</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">preservation_cp_link</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">st0</span> <span class="id">tr</span> <span class="id">st1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> <span class="id">ge_cp_link</span> <span class="id">st0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STEP</span>: <span class="id">Csem.step</span> <span class="id">skenv_link</span> <span class="id">ge_cp_link</span> <span class="id">st0</span> <span class="id">tr</span> <span class="id">st1</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">WT</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> <span class="id">ge_cp_link</span> <span class="id">st1</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7334')">Proof.</div>
<div class="proofscript" id="proof7334">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">preservation</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">STEP</span>; <span class="tactic">try</span> <span class="id">refl</span>; <span class="id">et</span>; <span class="tactic">destruct</span> <span class="id">cp_link_precise</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="tactic">red</span>. <span class="tactic">unfold</span> <span class="id">ge_cp_link</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">GE2P</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span> <span class="kwd">in</span> <span class="id">SYMB</span>. <span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span> <span class="kwd">in</span> <span class="id">SYMB0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.invert_symbol</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">SYMB</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">exploit</span> <span class="id">P2GE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">GE2P</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">unfold</span> <span class="id">ge_cp_link</span>. <span class="id">ss</span>. <span class="id">exists</span> <span class="id">id</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">preservation_cp_focus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cp</span> <span class="id">st0</span> <span class="id">tr</span> <span class="id">st1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FOC</span>: <span class="id">is_focus</span> <span class="id">cp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">st0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STEP</span>: <span class="id">Csem.step</span> <span class="id">skenv_link</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">st0</span> <span class="id">tr</span> <span class="id">st1</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">WT</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) <span class="id">st1</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7335')">Proof.</div>
<div class="proofscript" id="proof7335">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">is_focus_precise</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> <span class="kwd">in</span> <span class="id">FOC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">preservation</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">STEP</span>; <span class="tactic">try</span> <span class="id">refl</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">GE2P</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span> <span class="kwd">in</span> <span class="id">SYMB</span>. <span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span> <span class="kwd">in</span> <span class="id">SYMB0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.invert_symbol</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">SYMB</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">exploit</span> <span class="id">P2GE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">exploit</span> <span class="id">GE2P</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">alloc_variable_dtm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">genv</span> <span class="id">e</span> <span class="id">m0</span> <span class="id">l</span> <span class="id">e1</span> <span class="id">m3</span> <span class="id">e2</span> <span class="id">m5</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ALLOC1</span>: <span class="id">alloc_variables</span> <span class="id">genv</span> <span class="id">e</span> <span class="id">m0</span> <span class="id">l</span> <span class="id">e1</span> <span class="id">m3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ALLOC2</span>: <span class="id">alloc_variables</span> <span class="id">genv</span> <span class="id">e</span> <span class="id">m0</span> <span class="id">l</span> <span class="id">e2</span> <span class="id">m5</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e1</span> = <span class="id">e2</span> /\ <span class="id">m3</span> = <span class="id">m5</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7336')">Proof.</div>
<div class="proofscript" id="proof7336">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">ALLOC1</span> <span class="id">ALLOC2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">ALLOC1</span>. <span class="id">revert</span> <span class="id">ALLOC2</span>. <span class="id">revert</span> <span class="id">m5</span>. <span class="id">revert</span> <span class="id">e2</span>. <span class="id">revert</span> <span class="id">m3</span>. <span class="id">revert</span> <span class="id">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m0</span>. <span class="id">revert</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">ALLOC1</span>; <span class="id">inv</span> <span class="id">ALLOC2</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">ALLOC1</span>; <span class="id">inv</span> <span class="id">ALLOC2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>. <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="tactic">eapply</span> <span class="id">H9</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">subst</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">assign_loc_dtm</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">senv</span> <span class="id">genv</span> <span class="id">ty</span> <span class="id">m3</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">tr</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assign_loc</span> <span class="id">senv</span> <span class="id">genv</span> <span class="id">ty</span> <span class="id">m3</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">tr</span> <span class="id">m1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m0</span>, <span class="id">assign_loc</span> <span class="id">senv</span> <span class="id">genv</span> <span class="id">ty</span> <span class="id">m3</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">tr</span> <span class="id">m0</span> -&gt; <span class="id">m1</span> = <span class="id">m0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7337')">Proof.</div>
<div class="proofscript" id="proof7337">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span> <span class="id">m0</span> <span class="id">EV</span>; <span class="id">inv</span> <span class="id">EV</span>; <span class="tactic">f_equal</span>; <span class="id">Eq</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">H1</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H4</span>. <span class="id">revert</span> <span class="id">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H1</span>; <span class="tactic">intros</span> <span class="id">m0</span> <span class="id">EV</span>; <span class="id">inv</span> <span class="id">EV</span>; <span class="tactic">f_equal</span>; <span class="id">Eq</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">bind_param_dtm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">senv</span> <span class="id">genv</span> <span class="id">e1</span> <span class="id">m3</span> <span class="id">l</span> <span class="id">vs_arg</span> <span class="id">m4</span> <span class="id">m6</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BPARAM1</span>: <span class="id">bind_parameters</span> <span class="id">senv</span> <span class="id">genv</span> <span class="id">e1</span> <span class="id">m3</span> <span class="id">l</span> <span class="id">vs_arg</span> <span class="id">m4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BPARAM2</span>: <span class="id">bind_parameters</span> <span class="id">senv</span> <span class="id">genv</span> <span class="id">e1</span> <span class="id">m3</span> <span class="id">l</span> <span class="id">vs_arg</span> <span class="id">m6</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m4</span> = <span class="id">m6</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7338')">Proof.</div>
<div class="proofscript" id="proof7338">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">BPARAM1</span> <span class="id">BPARAM2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">BPARAM1</span>. <span class="id">revert</span> <span class="id">BPARAM2</span>. <span class="id">revert</span> <span class="id">m4</span>. <span class="id">revert</span> <span class="id">m6</span>. <span class="id">revert</span> <span class="id">vs_arg</span>. <span class="id">revert</span> <span class="id">m3</span>. <span class="id">revert</span> <span class="id">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">BPARAM1</span>. <span class="id">inv</span> <span class="id">BPARAM2</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">BPARAM1</span>. <span class="id">inv</span> <span class="id">BPARAM2</span>. <span class="tactic">auto</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">assign_loc_dtm</span>. <span class="tactic">eapply</span> <span class="id">H3</span>. <span class="tactic">eapply</span> <span class="id">H10</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>. <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="tactic">eapply</span> <span class="id">H11</span>. <span class="id">i</span>. <span class="tactic">eauto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">match_xsim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">st_src0</span> <span class="id">st_tgt0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MATCH</span>: <span class="id">match_states</span> <span class="id">st_src0</span> <span class="id">st_tgt0</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">XSIM</span>: <span class="id">xsim</span> (<span class="id">sem</span> <span class="id">prog_src</span>) (<span class="id">sem</span> <span class="id">prog_tgt</span>) (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">False</span>) <span class="id">tt</span> <span class="id">st_src0</span> <span class="id">st_tgt0</span>&gt;&gt;<br/>
&nbsp;&nbsp;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7339')">Proof.</div>
<div class="proofscript" id="proof7339">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert_until</span> <span class="id">sum_cont</span>. <span class="id">revert</span> <span class="id">INCL_FOCUS</span> <span class="id">INCL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pcofix</span> <span class="id">CIH</span>. <span class="id">i</span>. <span class="id">pfold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dup</span> <span class="id">LINKSRC</span>. <span class="id">sguard</span> <span class="kwd">in</span> <span class="id">LINKSRC</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MATCH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;normal&nbsp;state&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">frs_src</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">STK</span>. <span class="id">left</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span> 1; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">STEPSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">econs</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">FINAL0</span>; <span class="id">inv</span> <span class="id">FINAL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">FINAL</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">t</span> <span class="id">into</span> <span class="id">fr_src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">frs_tgt</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">match_stacks_right_nil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">t</span> <span class="id">into</span> <span class="id">fr_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">fr_tgt</span>.(<span class="id">Frame.ms</span>).(<span class="id">ModSem.is_call</span>) <span class="id">fr_tgt</span>.(<span class="id">Frame.st</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;tgt&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;fsim&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">right</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">final_fsim</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">fr_src</span>.(<span class="id">Frame.ms</span>).(<span class="id">ModSem.is_call</span>) <span class="id">fr_src</span>.(<span class="id">Frame.st</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;src&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">unsguard</span> <span class="id">LINKSRC</span>. <span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> <span class="id">STEPSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEPSRC</span>; <span class="id">ss</span>; <span class="id">ModSem.tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;receptiveness&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>. <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">ModSem.tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">eexists</span>. <span class="tactic">eapply</span> <span class="id">step_call</span>. <span class="id">instantiate</span> (1:=<span class="id">args</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">ModSem.tac</span>. <span class="id">ss</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">plus_one</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;determ&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">ModSem.tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">ModSem.at_external_dtm</span>. <span class="tactic">eapply</span> <span class="id">AT0</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">ModSem.is_step</span> (<span class="id">Frame.ms</span> <span class="id">fr_tgt</span>) (<span class="id">Frame.st</span> <span class="id">fr_tgt</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">ModSem.is_step</span>. <span class="id">ss</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">ModSem.call_step_disjoint</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">ModSem.call_return_disjoint</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">FINAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">ModSem.call_return_disjoint</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">ModSem.call_step_disjoint</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sguard</span> <span class="kwd">in</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>. <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ST</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">cp_link_precise</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">EXTERNAL</span>. <span class="tactic">destruct</span> <span class="id">fptr_arg</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> (<span class="id">Ptrofs.eq_dec</span> <span class="id">i</span> <span class="id">Ptrofs.zero</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span> <span class="kwd">in</span> <span class="id">EXTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;None&nbsp;or&nbsp;Gvar&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span>. <span class="id">des_ifs</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">Heq</span>, <span class="id">Heq0</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SYMB0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>, <span class="id">Heq0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMB</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eapply</span> <span class="id">defmap_with_signature</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP0</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eapply</span> <span class="id">defmap_with_signature</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">exploit</span> <span class="id">prog_defmap_exists_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span>, <span class="id">Genv.find_funct_ptr</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_find_defs_revive_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fundef</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;src&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">unsguard</span> <span class="id">LINKSRC</span>. <span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> <span class="id">STEPSRC</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEPSRC</span>; <span class="id">ss</span>; <span class="id">ModSem.tac</span>; <span class="id">swap</span> 2 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">contradict</span> <span class="id">H0</span>. <span class="id">rr</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">FINAL</span> <span class="id">ST</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">FINAL</span>; <span class="id">inv</span> <span class="id">ST</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dup</span> <span class="id">H</span>. <span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">ISCALLTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sguard</span> <span class="kwd">in</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">ST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">STEP</span>. <span class="id">des</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">inv</span> <span class="id">STEP</span>; <span class="id">ss</span>). <span class="id">folder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEP</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">classic</span>(<span class="id">is_external_ef</span> <span class="id">ef</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">exploit</span> <span class="id">CSkEnv.project_revive_no_external</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">skenv_link</span>. <span class="tactic">eapply</span> <span class="id">SkEnv.load_skenv_wf</span>. <span class="tactic">eapply</span> <span class="id">link_list_preserves_wf_sk</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">incl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">ISCALLTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">ss</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">FPTR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">Genv.invert_symbol</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">b</span>)) <span class="id">eqn</span>:<span class="id">SYMB</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">In</span> (<span class="id">i</span>, (<span class="id">Gfun</span> (<span class="id">External</span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cconv</span>))) (<span class="id">prog_defs</span> <span class="id">cp_link</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">PTree_Properties.in_of_list</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">External</span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cconv</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">BINTERNALLINK</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">BINCL</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">WFTGT</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">module</span> <span class="id">cp</span>). <span class="tactic">unfold</span> <span class="id">prog_tgt</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">in_or_app</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">in_map</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">prog_defmap_norepet</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">NoDup_norepet</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">NODUP</span>. <span class="tactic">unfold</span> <span class="id">prog_defs_names</span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">prog_defs</span> <span class="id">cp</span>) <span class="kwd">as</span> <span class="id">l</span>. <span class="tactic">clear</span> <span class="id">Heql</span>. <span class="id">ginduction</span> <span class="id">l</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">NODUP</span>. <span class="id">ss</span>. <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="tactic">clear</span> -<span class="id">H</span>. <span class="id">ginduction</span> <span class="id">l</span>; <span class="id">ss</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">is_focus_precise</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">P2GE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="id">ss</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">ef</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span> <span class="kwd">in</span> <span class="id">EXTERNAL</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">SKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">invert_symbol_lemma2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="tactic">subst</span> <span class="id">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b</span> = <span class="id">b0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Genv.find_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">i</span> = <span class="id">Some</span> <span class="id">b0</span>) <span class="tactic">by</span> <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> *. <span class="id">Eq</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">unfold</span> <span class="id">fundef</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">DEF</span> <span class="kwd">in</span> <span class="id">EXTERNAL</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">TGTFIND</span>: <span class="id">exists</span> <span class="id">cp_top</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">FINDMS</span>: <span class="id">Ge.find_fptr_owner</span> (<span class="id">load_genv</span> <span class="id">prog_tgt</span> <span class="id">skenv_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fptr_arg</span> (<span class="id">CsemC.modsem</span> <span class="id">skenv_link</span> <span class="id">cp_top</span>)&gt;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ &lt;&lt;<span class="id">FOCUS</span>: <span class="id">is_focus</span> <span class="id">cp_top</span>&gt;&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">FPTR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unsguard</span> <span class="id">LINKSRC</span>. <span class="tactic">destruct</span> <span class="id">cp_link_precise</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">GE2P</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sguard</span> <span class="kwd">in</span> <span class="id">LINKSRC</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_exists</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>. <span class="id">exists</span> <span class="id">pgm</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">pgm</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">func</span>, (<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">pgm</span>)) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">AST.Internal</span> <span class="id">func</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">destruct</span> <span class="id">f2</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">eauto</span>. } <span class="id">des</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>. <span class="id">econs</span>. { <span class="id">ss</span>. <span class="id">right</span>. <span class="tactic">unfold</span> <span class="id">prog_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">load_modsems</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">list_append_map</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">is_focus</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">map_map</span>. <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="tactic">unfold</span> <span class="id">flip</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">CsemC.module_obligation_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Genv.find_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_symbol</span> <span class="kwd">in</span> <span class="id">SYMB</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp_link</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">PROG</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">SIG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">SIG</span>. <span class="tactic">rewrite</span> <span class="id">SIG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H14</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span>, <span class="id">Genv.find_funct_ptr</span> <span class="kwd">in</span> <span class="id">SIG</span>, <span class="id">FPTR</span>. <span class="id">des_ifs</span>. <span class="tactic">rename</span> <span class="id">b</span> <span class="id">into</span> <span class="id">blk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">SYMB</span>: <span class="id">exists</span> <span class="id">id</span>, <span class="id">Genv.find_symbol</span> (<span class="id">geof</span> <span class="id">cp_top</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">blk</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>. <span class="tactic">eapply</span> <span class="id">FOCUS1</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>. <span class="tactic">unfold</span> <span class="id">SkEnv.revive</span>. <span class="id">ss</span>. } <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link</span> <span class="id">blk</span>) <span class="id">eqn</span>:<span class="id">SYMBSKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Genv.invert_find_symbol</span> <span class="kwd">in</span> <span class="id">SYMBSKENV</span>. <span class="tactic">clear</span> <span class="id">INTERNAL</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">lift_receptive_at</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>. <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H1</span>. <span class="id">eexists</span>. <span class="id">econs</span> 2. <span class="id">econs</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> <span class="id">FPTR</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">external_call_trace_length</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">plus_left</span> <span class="kwd">with</span> (<span class="id">t1</span> := <span class="id">E0</span>) (<span class="id">t2</span> := <span class="id">E0</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">lift_determinate_at</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>. <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>. <span class="id">unsguard</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">alloc_variable_dtm</span>. <span class="tactic">eapply</span> <span class="id">H13</span>. <span class="tactic">eapply</span> <span class="id">H15</span>. <span class="id">i</span>. <span class="id">des_safe</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">bind_param_dtm</span>. <span class="tactic">eapply</span> <span class="id">H14</span>. <span class="tactic">eapply</span> <span class="id">H16</span>. <span class="id">i</span>. <span class="tactic">subst</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">external_call_match_traces</span>. <span class="tactic">eapply</span> <span class="id">H12</span>. <span class="tactic">eapply</span> <span class="id">H11</span>. <span class="id">i</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">exploit</span> <span class="id">external_call_deterministic</span>. <span class="tactic">eapply</span> <span class="id">H12</span>. <span class="tactic">eapply</span> <span class="id">H11</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">external_call_trace_length</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 1; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_two</span> <span class="kwd">with</span> (<span class="id">t1</span> := <span class="id">E0</span>) (<span class="id">t2</span> := <span class="id">E0</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">LINKTGT</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">clarify</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">find_fptr_owner_determ</span>. <span class="tactic">eapply</span> <span class="id">FINDMS</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">find_fptr_owner_determ</span>. <span class="tactic">eapply</span> <span class="id">MSFIND</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">subst</span> <span class="id">ms</span>. <span class="tactic">subst</span> <span class="id">ms0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">inv</span> <span class="id">INIT</span>; <span class="id">inv</span> <span class="id">INIT0</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">FINAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">ss</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 2; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des_ifs</span>. <span class="id">folder</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">instantiate</span> (1:= <span class="id">f</span>). <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.  <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_def_same</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">same_prog</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">INTERNAL</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">WTSRC</span>. <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">type_of_function</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">type_of_function</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">blk</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTSKLINK</span>. <span class="tactic">unfold</span> <span class="id">size_arguments</span> <span class="kwd">in</span> <span class="id">WFPARAM</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">INTERNAL</span>: <span class="id">In</span> (<span class="id">i0</span>, <span class="id">Gfun</span> (<span class="id">AST.Internal</span> (<span class="id">signature_of_function</span> <span class="id">f</span>))) (<span class="id">AST.prog_defs</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">in_prog_defmap</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">CSk.of_program_prog_defmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (4 := <span class="id">i0</span>). <span class="id">instantiate</span> (1 := <span class="id">cp_link</span>). <span class="id">instantiate</span> (1 := <span class="id">signature_of_function</span>). <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">typlist_of_typelist_eq</span>. <span class="tactic">eauto</span>. <span class="id">hexploit</span> <span class="id">WFPARAM</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="tactic">assert</span>(<span class="id">WTPROG</span>: <span class="id">wt_program</span> <span class="id">cp_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">r</span> <span class="kwd">in</span> <span class="id">FOCUS1</span>. <span class="id">des</span>; <span class="id">clarify</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bar</span>. <span class="id">inv</span> <span class="id">WTPROG</span>. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">id</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hi</span>: <span class="id">i</span> = <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">Genv.find_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">SkEnv.revive</span> <span class="kwd">in</span> <span class="id">SYMB</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H2</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">SYMBSKENV</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>. } <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Haux</span>: <span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">f</span>)) (<span class="id">prog_defs</span> <span class="id">cp_top</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">blk</span>) <span class="id">eqn</span>:<span class="id">SYMBLINK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBLINK</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>. } <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp_top</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">id</span>). <span class="id">i</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">rewrite</span> <span class="id">DMAP0</span> <span class="kwd">in</span> *; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">des_ifs</span>; <span class="id">clarify</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">PTree_Properties.in_of_list</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">Haux</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">lift_determinate_at</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>. <span class="id">unsguard</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">alloc_variable_dtm</span>. <span class="tactic">eapply</span> <span class="id">H15</span>. <span class="tactic">eapply</span> <span class="id">H17</span>. <span class="id">i</span>. <span class="id">des_safe</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">bind_param_dtm</span>. <span class="tactic">eapply</span> <span class="id">H16</span>. <span class="tactic">eapply</span> <span class="id">H18</span>. <span class="id">i</span>. <span class="tactic">subst</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">external_call_match_traces</span>. <span class="tactic">eapply</span> <span class="id">H13</span>. <span class="tactic">eapply</span> <span class="id">H14</span>. <span class="id">i</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">exploit</span> <span class="id">external_call_deterministic</span>. <span class="tactic">eapply</span> <span class="id">H13</span>. <span class="tactic">eapply</span> <span class="id">H14</span>. <span class="id">i</span>. <span class="id">des</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">i</span>. <span class="id">inv</span> <span class="id">FINAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H3</span>. <span class="id">ss</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">external_call_trace_length</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">LINKTGT</span> <span class="kwd">in</span> *. <span class="id">rpapply</span> <span class="id">step_internal</span>; <span class="id">ss</span>; <span class="id">et</span>. <span class="id">rr</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> (<span class="id">Ptrofs.eq_dec</span> <span class="id">Ptrofs.zero</span> <span class="id">Ptrofs.zero</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">prog_def_same</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">cp0</span> = <span class="id">cp_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">same_prog</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">FOCUS1</span>. <span class="tactic">eapply</span> <span class="id">INTERNAL</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">auto</span>. } <span class="tactic">subst</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unguardH</span> <span class="id">LINKSRC</span>. <span class="tactic">eapply</span> <span class="id">preservation_alloc</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unguardH</span> <span class="id">LINKSRC</span>. <span class="tactic">eapply</span> <span class="id">preservation_bind_param</span>; <span class="tactic">eauto</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id">app_comm_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">et</span>. <span class="id">inv</span> <span class="id">WTTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">WTKS</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des_safe</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">CLASSIFY</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="tactic">clear</span> - <span class="id">WTYK</span>. <span class="id">des</span>. <span class="id">ss</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des_ifs</span>. <span class="tactic">eapply</span> <span class="id">preservation_cp_link</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. <span class="id">des_ifs</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">WTPROG</span>: <span class="id">wt_program</span> <span class="id">cp_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">r</span> <span class="kwd">in</span> <span class="id">FOCUS1</span>. <span class="id">des</span>; <span class="id">clarify</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bar</span>. <span class="id">inv</span> <span class="id">WTPROG</span>. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">id</span> <span class="id">f</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hi</span>: <span class="id">i</span> = <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">Genv.find_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">SkEnv.revive</span> <span class="kwd">in</span> <span class="id">SYMB</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H2</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">exploit</span> <span class="id">SYMBKEEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">SYMBSKENV</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">clarify</span>. } <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Haux</span>: <span class="id">In</span> (<span class="id">id</span>, <span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">f</span>)) (<span class="id">prog_defs</span> <span class="id">cp_top</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>)) <span class="id">blk</span>) <span class="id">eqn</span>:<span class="id">SYMBLINK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> = <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> <span class="id">CSk.of_program_defs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBLINK</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="id">i</span>. <span class="id">Eq</span>. <span class="tactic">auto</span>. } <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">DMAP0</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp_top</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">id</span>). <span class="id">i</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">rewrite</span> <span class="id">DMAP0</span> <span class="kwd">in</span> *; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">des_ifs</span>; <span class="id">clarify</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">Eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">PTree_Properties.in_of_list</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">Haux</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">FINDMS</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> (<span class="id">Ptrofs.eq_dec</span> <span class="id">Ptrofs.zero</span> <span class="id">Ptrofs.zero</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">preservation_cp_focus</span>; <span class="id">et</span>; <span class="id">revgoals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">step_internal_function</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span>. <span class="id">instantiate</span> (1:= <span class="id">Vptr</span> <span class="id">blk</span> <span class="id">Ptrofs.zero</span>). <span class="id">ss</span>. <span class="tactic">destruct</span> (<span class="id">Ptrofs.eq_dec</span> <span class="id">Ptrofs.zero</span> <span class="id">Ptrofs.zero</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">prog_def_same</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">cp0</span> = <span class="id">cp_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">same_prog</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">FOCUS1</span>. <span class="tactic">eapply</span> <span class="id">INTERNAL</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">auto</span>. } <span class="tactic">subst</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">preservation_alloc</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">preservation_bind_param</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_find_defs_same_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fundef</span>, <span class="id">skenv_link</span> <span class="kwd">in</span> *. <span class="id">Eq</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">EXT</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">f</span>, <span class="id">Genv.find_funct_ptr</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) <span class="id">cp_top</span>) <span class="id">blk</span> = <span class="id">Some</span> (<span class="id">Internal</span> <span class="id">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span> <span class="kwd">in</span> <span class="id">INTERNAL</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">f</span>, <span class="id">Genv.find_def</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) <span class="id">cp_top</span>) <span class="id">blk</span> = <span class="id">Some</span> (<span class="id">Gfun</span>(<span class="id">Internal</span> <span class="id">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MapsC.PTree_filter_map_spec</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="tactic">rewrite</span> <span class="id">o_bind_ignore</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">eapply</span> <span class="id">SYMBSKENV</span>. <span class="tactic">intros</span> <span class="id">INVSKENV</span>. <span class="tactic">rewrite</span> <span class="id">INVSKENV</span> <span class="kwd">in</span> <span class="id">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">Heq2</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">CSk.of_program_prog_defmap</span> <span class="id">cp_top</span> <span class="id">signature_of_function</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">if_sig</span>, (<span class="id">prog_defmap</span> <span class="id">cp_top</span>) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gfun</span> (<span class="id">Internal</span> <span class="id">if_sig</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">DMAP</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">unfold</span> <span class="id">CtypesC.CSk.match_fundef</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">destruct</span> <span class="id">f1</span>; <span class="tactic">destruct</span> <span class="id">f2</span>; <span class="tactic">eauto</span>; <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">H4</span>. } <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">is_focus_precise</span> <span class="id">_</span> <span class="id">FOCUS1</span>). <span class="id">exploit</span> <span class="id">P2GE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b</span> = <span class="id">blk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">Genv.find_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_top</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">SkEnv.revive</span> <span class="kwd">in</span> *; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_impl_spec</span>. <span class="tactic">eapply</span> <span class="id">INCL_FOCUS</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">defs_prog_defmap</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_safe</span>. <span class="id">exists</span> <span class="id">f0</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_safe</span>. <span class="id">specialize</span> (<span class="id">EXT</span> <span class="id">f0</span>). <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">EXT</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id">type_of_function</span> <span class="kwd">in</span> *. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id">type_of_function</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. } } }<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">CALLLE</span>: <span class="kwd">forall</span> (<span class="id">CALLSRC</span>: <span class="id">ModSem.is_call</span> (<span class="id">Frame.ms</span> <span class="id">fr_src</span>) (<span class="id">Frame.st</span> <span class="id">fr_src</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">CALLTGT</span>: <span class="id">ModSem.is_call</span> (<span class="id">Frame.ms</span> <span class="id">fr_tgt</span>) (<span class="id">Frame.st</span> <span class="id">fr_tgt</span>)&gt;&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">inv</span> <span class="id">STK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">CALLSRC</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>; <span class="id">clarify</span>. <span class="tactic">inversion</span> <span class="id">ST</span>; <span class="id">ss</span>; <span class="id">clarify</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">inv</span> <span class="id">CALLSRC</span>; <span class="id">inv</span> <span class="id">H0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">CALLSRC</span>. <span class="tactic">red</span>. <span class="id">ss</span>. <span class="id">econs</span>. <span class="id">ss</span>. <span class="id">instantiate</span> (1:= (<span class="id">Args.mk</span> <span class="id">fptr</span> <span class="id">vargs</span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">tyf</span> = (<span class="id">Tfunction</span> <span class="id">tyargs</span> <span class="id">tyres</span> <span class="id">cc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">classify_fun_strong</span> <span class="kwd">in</span> <span class="id">CLASSIFY</span>. <span class="id">des_ifs</span>. } <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_funct</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">cp</span>) <span class="id">fptr</span>) <span class="id">eqn</span>:<span class="id">CPEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">CPEXT</span>, <span class="id">EXTERNAL</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">CPEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_find_defs_revive_rev</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span> <span class="kwd">in</span> <span class="id">EXTERNAL</span>. <span class="tactic">unfold</span> <span class="id">fundef</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">EXTERNAL</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">fundef</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">WTKS</span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="id">Eq</span>.<br/>
<span class="id">i</span>. <span class="id">des_safe</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id">is_call_cont_strong</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">NCALLTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">NCALLSRC</span>: ~ <span class="id">ModSem.is_call</span> (<span class="id">Frame.ms</span> <span class="id">fr_src</span>) (<span class="id">Frame.st</span> <span class="id">fr_src</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">tauto</span>. }<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">fr_tgt</span>.(<span class="id">Frame.ms</span>).(<span class="id">ModSem.is_return</span>) <span class="id">fr_tgt</span>.(<span class="id">Frame.st</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;tgt&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">right</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">final_fsim</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">RECEP</span>: <span class="id">receptive_at</span> (<span class="id">sem</span> <span class="id">prog_src</span>) (<span class="id">State</span> (<span class="id">fr_src</span> :: <span class="id">frs_src</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">NCALLSRC</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">ModSem.step_return_disjoint</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">ss</span>. <span class="id">inv</span> <span class="id">HD</span>; <span class="id">clarify</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">ST</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">STEP</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="id">econs</span> 3. <span class="id">ss</span>. <span class="id">econs</span> 2. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">eexists</span>. <span class="id">econs</span> 4; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="id">nia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">STK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">ModSem.step_return_disjoint</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ss</span>. <span class="id">inv</span> <span class="id">HD</span>; <span class="id">clarify</span>; <span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">ST</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">STEP</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="id">ss</span>. <span class="id">nia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEPSRC</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NCALLSRC</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;src&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ModSem.tac</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>. <span class="id">clarify</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ST</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">STEP</span>. <span class="id">des</span>; <span class="id">inv</span> <span class="id">STEP</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SUM</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">CALL</span>. <span class="tactic">destruct</span> <span class="id">k0</span>; <span class="id">ss</span>. <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">typify_c_ex</span> <span class="id">v_ret</span> <span class="id">_tres</span>). <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">plus_two</span> <span class="kwd">with</span> (<span class="id">t1</span> := <span class="id">E0</span>) (<span class="id">t2</span> := <span class="id">E0</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">lift_determinate_at</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 4; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">lift_determinate_at</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="id">ss</span>. <span class="id">nia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rpapply</span> <span class="id">step_internal</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">app_comm_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">v_ret</span> = <span class="id">tv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTSRC</span>. <span class="id">inv</span> <span class="id">TYP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTK</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">preservation_cp_link</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">WTTGT1</span>: <span class="id">wt_state</span> <span class="id">cp0</span> (<span class="id">geof</span> <span class="id">cp0</span>) (<span class="id">Returnstate</span> <span class="id">tv</span> (<span class="id">Kcall</span> <span class="id">_f</span> <span class="id">_e</span> <span class="id">_C</span> <span class="id">_tres</span> <span class="id">_k</span>) (<span class="id">m_ret</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>; <span class="id">revgoals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">typify_c_spec</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTTGT0</span>. <span class="id">ss</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTTGT0</span>. <span class="id">des_safe</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">preservation_cp_focus</span>; <span class="id">et</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;src&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">STK</span>; <span class="id">ss</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;top&nbsp;is&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>. <span class="id">clarify</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FINAL</span>. <span class="id">inv</span> <span class="id">ST</span>. <span class="id">exploit</span> <span class="id">app_cont_kstop_inv</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">sum_cont_kstop_inv</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">SUM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">tail_tgt</span> &lt;&gt; []).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">TAIL</span>; <span class="id">ss</span>. <span class="id">hexploit</span> <span class="id">match_focus_nonnil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">hds_tgt</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tail_tgt</span> <span class="kwd">as</span> [|<span class="id">fr_snd</span> <span class="id">frs_tgt</span>]; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">TAIL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;snd&nbsp;is&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">plus_one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">lift_determinate_at</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H2</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 4; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;snd&nbsp;is&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">hexploit</span> <span class="id">match_focus_nonnil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">destruct</span> <span class="id">hds_tgt</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AFTER</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">ST</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">plus_one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">lift_determinate_at</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H3</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 4; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">app_comm_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTSRC0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">typify_c_spec</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">WTTGT1</span>: <span class="id">wt_state</span> <span class="id">cp0</span> (<span class="id">geof</span> <span class="id">cp0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Returnstate</span> <span class="id">tv</span> <span class="id">k2</span> <span class="id">m_ret</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>; <span class="id">revgoals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">typify_c_spec</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTTGT0</span>. <span class="id">ss</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT0</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;top&nbsp;is&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">frs_tgt</span> &lt;&gt; []).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">TAIL</span>; <span class="id">ss</span>. <span class="id">hexploit</span> <span class="id">match_focus_nonnil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">hds_tgt</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">frs_tgt</span> <span class="kwd">as</span> [|<span class="id">fr_snd</span> <span class="id">frs_tgt</span>]; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">TAIL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;snd&nbsp;is&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">plus_one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>. <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">ModSem.tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ModSem.final_frame_dtm</span>. <span class="tactic">eapply</span> <span class="id">FINAL1</span>. <span class="tactic">eapply</span> <span class="id">FINAL0</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ModSem.after_external_dtm</span>. <span class="tactic">eapply</span> <span class="id">AFTER0</span>. <span class="tactic">eapply</span> <span class="id">AFTER1</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">inv</span> <span class="id">FINAL0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">ModSem.tac</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="id">nia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 4; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;snd&nbsp;is&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">hexploit</span> <span class="id">match_focus_nonnil</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">destruct</span> <span class="id">hds_tgt</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AFTER</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">ST</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">split</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">plus_one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>. <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="id">ModSem.tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econs</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ModSem.final_frame_dtm</span>. <span class="tactic">eapply</span> <span class="id">FINAL1</span>. <span class="tactic">eapply</span> <span class="id">FINAL0</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">ModSem.after_external_dtm</span>. <span class="tactic">eapply</span> <span class="id">AFTER</span>. <span class="tactic">eapply</span> <span class="id">AFTER0</span>. <span class="id">i</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">inv</span> <span class="id">FINAL0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">ModSem.tac</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="id">nia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 4; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">app_comm_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">WTSRC0</span>: <span class="id">wt_state</span> <span class="id">cp_link</span> <span class="id">ge_cp_link</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Returnstate</span> <span class="id">tv</span> (<span class="id">app_cont</span> <span class="id">k2</span> <span class="id">k_tl_tgt</span>) (<span class="id">Retv.m</span> <span class="id">retv</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>; <span class="id">revgoals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">typify_c_spec</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTSRC</span>. <span class="id">ss</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTSRC</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">WTTGT0</span>: <span class="id">wt_state</span> <span class="id">cp</span> (<span class="id">geof</span> <span class="id">cp</span>) (<span class="id">Returnstate</span> <span class="id">tv</span> <span class="id">k2</span> (<span class="id">Retv.m</span> <span class="id">retv</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>; <span class="id">revgoals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">typify_c_spec</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">ss</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTTGT</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. } } }<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">RETLE</span>: <span class="kwd">forall</span> (<span class="id">RETSRC</span>: <span class="id">ModSem.is_return</span> (<span class="id">Frame.ms</span> <span class="id">fr_src</span>) (<span class="id">Frame.st</span> <span class="id">fr_src</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">RETTGT</span>: <span class="id">ModSem.is_return</span> (<span class="id">Frame.ms</span> <span class="id">fr_tgt</span>) (<span class="id">Frame.st</span> <span class="id">fr_tgt</span>)&gt;&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">inv</span> <span class="id">STK</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HD</span>; <span class="id">ss</span>; <span class="id">clarify</span>. <span class="tactic">inversion</span> <span class="id">ST</span>; <span class="id">ss</span>; <span class="id">clarify</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">inv</span> <span class="id">RETSRC</span>; <span class="id">inv</span> <span class="id">H0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">RETSRC</span>. <span class="tactic">red</span>. <span class="id">ss</span>. <span class="id">econs</span>. <span class="id">ss</span>. <span class="id">instantiate</span> (1:= <span class="id">Retv.mk</span> <span class="id">vres</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">WTTGT</span>. <span class="id">inv</span> <span class="id">WTK</span>. <span class="id">econs</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">NRETTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">NRETSRC</span>: ~ <span class="id">ModSem.is_return</span> (<span class="id">Frame.ms</span> <span class="id">fr_src</span>) (<span class="id">Frame.st</span> <span class="id">fr_src</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">tauto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;src&nbsp;internal&nbsp;&amp;&amp;&nbsp;tgt&nbsp;internal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">final_bsim</span>; <span class="id">et</span>. { <span class="id">econs</span>; <span class="id">et</span>. } <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">et</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;progress&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">right</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">clear_tac</span>. <span class="id">specialize</span> (<span class="id">SAFESRC</span> <span class="id">_</span> (<span class="id">star_refl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)). <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SAFESRC</span>. <span class="id">contradict</span> <span class="id">NRETTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SAFESRC</span>; <span class="id">swap</span> 2 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NCALLTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NRETTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;bsim&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEPTGT</span>; <span class="id">swap</span> 2 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NCALLTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NRETTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econs</span> 3; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;focus&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">inversion</span> <span class="id">HD</span>; <span class="tactic">subst</span>; <span class="id">ss</span>. <span class="id">clarify</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;progress&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">right</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="id">clear_tac</span>. <span class="id">specialize</span> (<span class="id">SAFESRC</span> <span class="id">_</span> (<span class="id">star_refl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)). <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SAFESRC</span>. <span class="id">contradict</span> <span class="id">NRETSRC</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SAFESRC</span>; <span class="id">swap</span> 2 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NCALLSRC</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NRETSRC</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">inv</span> <span class="id">LINKSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_focus_state_progress</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">ST</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">NCALLTGT</span>. <span class="tactic">unfold</span> <span class="id">ModSem.is_call</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>. <span class="id">eexists</span>. <span class="id">econs</span>. <span class="id">ss</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;bsim&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">LINKTGT</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STEPTGT</span>; <span class="id">swap</span> 2 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NCALLTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">contradict</span> <span class="id">NRETTGT</span>. <span class="id">rr</span>. <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econs</span> 3; <span class="id">et</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_focus_state_bsim</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="tactic">unfold</span> <span class="id">Frame.update_st</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">match_focus</span> {| <span class="id">Frame.ms</span> := <span class="id">modsem</span> <span class="id">skenv_link</span> <span class="id">cp_link</span>; <span class="id">Frame.st</span> := <span class="id">matched_state_source</span> <span class="id">st0</span> <span class="id">k_tl_tgt</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;({| <span class="id">Frame.ms</span> := <span class="id">modsem</span> <span class="id">skenv_link</span> <span class="id">cp</span>; <span class="id">Frame.st</span> := <span class="id">st0</span> |} :: <span class="id">tl_tgt</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">st0</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_focus_state_bsim</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">preservation_cp_link</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">preservation_cp_focus</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_stacks_focus</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;call&nbsp;state&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">inv</span> <span class="id">FINALTGT</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">specialize</span> (<span class="id">SAFESRC</span> <span class="id">_</span> (<span class="id">star_refl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)). <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SAFESRC</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> <span class="id">SAFESRC</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SAFESRC</span>. <span class="id">right</span>. <span class="id">exploit</span> <span class="id">msfind_fsim</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">LINKTGT</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">LINKTGT</span>. <span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">INIT</span>. <span class="id">ss</span>.  <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_def_same</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">cp</span> = <span class="id">cp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MSFIND0</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">unfold</span> <span class="id">Args.get_fptr</span>, <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">same_prog</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">ISFOCTGT</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">inv</span> <span class="id">STEPTGT</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">msfind_bsim</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des_ifs</span>. <span class="tactic">eauto</span>. } <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des_ifs</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econs</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">LINKSRC</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">LINKTGT</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">INIT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">prog_find_defs_same_rev</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">eapply</span> <span class="id">CIH</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">cons_app</span> <span class="kwd">with</span> (<span class="id">xtl</span> := <span class="id">frs_tgt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span> 3; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">TYP</span>. <span class="tactic">eapply</span> <span class="id">wt_initial_frame</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">esplits</span>; <span class="id">et</span>. <span class="id">instantiate</span> (1:= <span class="id">fd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">prog_find_defs_same_rev</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WTPROGLINK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp_link</span>))); <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp_link</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">in_prog_defmap</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">TYP</span>. <span class="tactic">eapply</span> <span class="id">wt_initial_frame</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>. <span class="id">Eq</span>. <span class="id">exploit</span> <span class="id">WTPROGS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_funct</span> <span class="kwd">in</span> <span class="id">FINDF</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_funct_ptr_iff</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_def</span> <span class="kwd">in</span> <span class="id">FINDF</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">PTree_filter_map_spec</span>, <span class="id">o_bind_ignore</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> (<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span> <span class="id">cp</span>)) <span class="id">b</span>); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">o_bind</span> <span class="kwd">in</span> <span class="id">FINDF</span>. <span class="id">ss</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">cp</span>) ! <span class="id">i</span>) <span class="id">eqn</span>:<span class="id">DMAP</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">DMAP</span>. <span class="tactic">eapply</span> <span class="id">PTree_Properties.in_of_list</span> <span class="kwd">in</span> <span class="id">DMAP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">DMAP</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (2:=<span class="id">i</span>). <span class="id">instantiate</span> (1:=<span class="id">fd0</span>). <span class="id">ss</span>. } <span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">ss</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">WTMODULE</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id">upperbound_a_xsim</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">XSIM</span>: <span class="id">mixed_simulation</span> (<span class="id">Sem.sem</span> <span class="id">prog_src</span>) (<span class="id">Sem.sem</span> <span class="id">prog_tgt</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7340')">Proof.</div>
<div class="proofscript" id="proof7340">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">unit_ord_wf</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">inversion</span> <span class="id">INITSRC</span>. <span class="id">exploit</span> <span class="id">init_fsim</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_xsim</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INIT</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">INIT0</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">PRESERVATION</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">BehaviorsC</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">geof</span> := <span class="kwd">fun</span> <span class="id">skenv_link</span> (<span class="id">cp</span>: <span class="id">Csyntax.program</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Build_genv</span> (<span class="id">SkEnv.revive</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link</span> <span class="id">cp</span>.(<span class="id">CSk.of_program</span> <span class="id">signature_of_function</span>)) <span class="id">cp</span>) <span class="id">cp</span>.(<span class="id">prog_comp_env</span>)).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">upperbound_a_correct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">builtins</span> (<span class="id">cp_link</span>: <span class="id">Csyntax.program</span>) <span class="id">cps</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TYPEDS</span>: <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">cp</span> =&gt; (<span class="id">typechecked</span> <span class="id">builtins</span> <span class="id">cp</span>)) <span class="id">cps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TYPEDLINK</span>: <span class="id">typechecked</span> <span class="id">builtins</span> <span class="id">cp_link</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id">link_list</span> <span class="id">cps</span> = <span class="id">Some</span> <span class="id">cp_link</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">REFINE</span>: <span class="id">improves</span> (<span class="id">Sem.sem</span> (<span class="id">ctx</span> ++ [<span class="id">cp_link</span>.(<span class="id">CsemC.module</span>)]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Sem.sem</span> (<span class="id">ctx</span> ++ <span class="id">map</span> <span class="id">CsemC.module</span> <span class="id">cps</span>))&gt;&gt;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7341')">Proof.</div>
<div class="proofscript" id="proof7341">
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">bsim_improves</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mixed_to_backward_simulation</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">link_sk</span> (<span class="id">ctx</span> ++ [<span class="id">module</span> <span class="id">cp_link</span>])) <span class="id">eqn</span>:<span class="id">LINKSK</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">unit_ord_wf</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">et</span>. <span class="id">i</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">INITSRC</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> <span class="id">link_sk_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">cp_link</span>). <span class="id">instantiate</span> (1 := <span class="id">cps</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ctx</span>). <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">t</span> <span class="id">into</span> <span class="id">link_sk</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">TYPEDLINK</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">upperbound_a_xsim</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">typecheck_program_sound</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">TYPEDS</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="id">inv</span> <span class="id">T</span>. <span class="tactic">eapply</span> <span class="id">typecheck_program_sound</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">TYPEDS</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="id">inv</span> <span class="id">T</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">TYPEDS</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="id">inv</span> <span class="id">T</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">TYPEDS</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="id">inv</span> <span class="id">T</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">exploit</span> <span class="id">TYPEDS</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="id">inv</span> <span class="id">T</span>. <span class="tactic">eauto</span>. }<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
