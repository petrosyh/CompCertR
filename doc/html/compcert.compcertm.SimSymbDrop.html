
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SimSymbDrop</title>
<meta name="description" content="Documentation of Coq module SimSymbDrop" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module SimSymbDrop</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Events</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Values</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">AST</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">MemoryC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Globalenvs</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Smallstep</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">CoqlibC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Skeleton</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">IntegersC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ASTC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">LinkingC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">SimSymb</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">MapsC</span>.<br/>
<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">SimSymb</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">SimMem</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">SimMemInjC</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ModSem</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">ref_init</span> (<span class="id">il</span> : <span class="id">list</span> <span class="id">init_data</span>) (<span class="id">id</span> : <span class="id">ident</span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ofs</span>, <span class="id">In</span> (<span class="id">Init_addrof</span> <span class="id">id</span> <span class="id">ofs</span>) <span class="id">il</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">MEMINJ</span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id">t</span>': <span class="kwd">Type</span> := <span class="id">mk</span> {<br/>
&nbsp;&nbsp;<span class="id">dropped</span>:&gt; <span class="id">ident</span> -&gt; <span class="kwd">Prop</span>;<br/>
&nbsp;&nbsp;<span class="id">src</span>: <span class="id">Sk.t</span>;<br/>
&nbsp;&nbsp;<span class="id">tgt</span>: <span class="id">Sk.t</span>;<br/>
}.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="kwd">wf</span> (<span class="id">ss</span>: <span class="id">t</span>'): <span class="kwd">Prop</span> :=<br/>
| <span class="id">sim_sk_intro</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">KEPT</span>: <span class="kwd">forall</span> <span class="id">id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">KEPT</span>: ~ <span class="id">ss</span> <span class="id">id</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>.(<span class="id">tgt</span>).(<span class="id">prog_defmap</span>) ! <span class="id">id</span> = <span class="id">ss</span>.(<span class="id">src</span>).(<span class="id">prog_defmap</span>) ! <span class="id">id</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DROP</span>: <span class="kwd">forall</span> <span class="id">id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DROP</span>: <span class="id">ss</span> <span class="id">id</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>.(<span class="id">tgt</span>).(<span class="id">prog_defmap</span>) ! <span class="id">id</span> = <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CLOSED</span>: <span class="id">ss</span> &lt;1= <span class="id">ss</span>.(<span class="id">src</span>).(<span class="id">privs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PUB</span>: <span class="id">ss</span>.(<span class="id">src</span>).(<span class="id">prog_public</span>) = <span class="id">ss</span>.(<span class="id">tgt</span>).(<span class="id">prog_public</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MAIN</span>: <span class="id">ss</span>.(<span class="id">src</span>).(<span class="id">prog_main</span>) = <span class="id">ss</span>.(<span class="id">tgt</span>).(<span class="id">prog_main</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NOREF</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">gv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PROG</span>: <span class="id">ss</span>.(<span class="id">tgt</span>).(<span class="id">prog_defmap</span>) ! <span class="id">id</span>  = <span class="id">Some</span> (<span class="id">Gvar</span> <span class="id">gv</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">NOREF</span>: <span class="kwd">forall</span> <span class="id">id_drop</span> (<span class="id">DROP</span>: <span class="id">ss</span> <span class="id">id_drop</span>), ~ <span class="id">ref_init</span> <span class="id">gv</span>.(<span class="id">gvar_init</span>) <span class="id">id_drop</span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NODUP</span>: <span class="id">NoDup</span> (<span class="id">prog_defs_names</span> <span class="id">ss</span>.(<span class="id">tgt</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NOMAIN</span>: ~ <span class="id">ss</span> <span class="id">ss</span>.(<span class="id">src</span>).(<span class="id">prog_main</span>)).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">sim_skenv</span> (<span class="id">sm0</span>: <span class="id">SimMem.t</span>) (<span class="id">ss</span>: <span class="id">t</span>') (<span class="id">skenv_src</span> <span class="id">skenv_tgt</span>: <span class="id">SkEnv.t</span>): <span class="kwd">Prop</span> :=<br/>
| <span class="id">sim_skenv_intro</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSYMB1</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_src</span> <span class="id">blk_tgt</span> <span class="id">delta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BLKSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DELTA</span>: <span class="id">delta</span> = 0&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">BLKTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">KEPT</span>: ~ <span class="id">ss</span> <span class="id">id</span>&gt;&gt;))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSYMB2</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">KEPT</span>: ~ <span class="id">ss</span> <span class="id">id</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BLKSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">blk_tgt</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">BLKTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0)&gt;&gt;))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSYMB3</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BLKTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">blk_src</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">BLKSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0)&gt;&gt;))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMDEF</span>: <span class="kwd">forall</span> <span class="id">blk_src</span> <span class="id">blk_tgt</span> <span class="id">delta</span> <span class="id">def_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_src</span> = <span class="id">Some</span> <span class="id">def_src</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">def_tgt</span>, (&lt;&lt;<span class="id">DEFTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_tgt</span> = <span class="id">Some</span> <span class="id">def_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DELTA</span>: <span class="id">delta</span> = 0&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIM</span>: <span class="id">def_src</span> = <span class="id">def_tgt</span>&gt;&gt;))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DISJ</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_src0</span> <span class="id">blk_src1</span> <span class="id">blk_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBSRC</span>: <span class="id">Genv.find_symbol</span> <span class="id">skenv_src</span> <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL0</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src0</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL1</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src1</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_src0</span> = <span class="id">blk_src1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMDEFINV</span>: <span class="kwd">forall</span> <span class="id">blk_src</span> <span class="id">blk_tgt</span> <span class="id">delta</span> <span class="id">def_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_tgt</span> = <span class="id">Some</span> <span class="id">def_tgt</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">def_src</span>, (&lt;&lt;<span class="id">DEFSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_src</span> = <span class="id">Some</span> <span class="id">def_src</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DELTA</span>: <span class="id">delta</span> = 0&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIM</span>: <span class="id">def_src</span> = <span class="id">def_tgt</span>&gt;&gt;))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PUBKEPT</span>: (<span class="kwd">fun</span> <span class="id">id</span> =&gt; <span class="id">In</span> <span class="id">id</span> <span class="id">skenv_src</span>.(<span class="id">Genv.genv_public</span>)) &lt;1= ~1 <span class="id">ss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PUB</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.genv_public</span>) = <span class="id">skenv_tgt</span>.(<span class="id">Genv.genv_public</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NBSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.genv_next</span>) = <span class="id">sm0</span>.(<span class="id">src_ge_nb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NBTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.genv_next</span>) = <span class="id">sm0</span>.(<span class="id">tgt_ge_nb</span>)).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">sim_skenv_symbols_inject</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> <span class="id">ss0</span> <span class="id">skenv_src</span> <span class="id">skenv_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSKENV</span>: <span class="id">sim_skenv</span> <span class="id">sm0</span> <span class="id">ss0</span> <span class="id">skenv_src</span> <span class="id">skenv_tgt</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SINJ</span>: <span class="id">symbols_inject</span> <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">skenv_src</span> <span class="id">skenv_tgt</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6097')">Proof.</div>
<div class="proofscript" id="proof6097">
&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">SIMSKENV</span>. <span class="id">inv</span> <span class="id">SIMSKENV</span>; <span class="id">ss</span>. <span class="id">rr</span>. <span class="id">esplits</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">Genv.public_symbol</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">PUB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_symbol</span> <span class="id">skenv_tgt</span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">SIMSYMB3</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">BLKSRC</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des_ifs</span>. <span class="id">des_sumbool</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">PUBKEPT</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NNPP</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SIMSYMB1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">PUBKEPT</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Genv.public_symbol</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des_ifs</span>. <span class="id">des_sumbool</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">Genv.block_is_volatile</span>, <span class="id">Genv.find_var_info</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_def</span> <span class="id">skenv_src</span> <span class="id">b1</span>) <span class="id">eqn</span>:<span class="id">T0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SIMDEF</span>; <span class="tactic">try</span> <span class="id">eassumption</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_def</span> <span class="id">skenv_tgt</span> <span class="id">b2</span>) <span class="id">eqn</span>:<span class="id">T1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SIMDEFINV</span>; <span class="tactic">try</span> <span class="id">eassumption</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">sim_skenv_splittable</span> (<span class="id">sm0</span>: <span class="id">SimMem.t</span>) (<span class="id">ss</span>: <span class="id">t</span>') (<span class="id">skenv_src</span> <span class="id">skenv_tgt</span>: <span class="id">SkEnv.t</span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMSYMB1</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_src</span> <span class="id">blk_tgt</span> <span class="id">delta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BLKSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DELTA</span>: <span class="id">delta</span> = 0&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">BLKTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">KEPT</span>: ~ <span class="id">ss</span> <span class="id">id</span>&gt;&gt;)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMSYMB2</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">KEPT</span>: ~ <span class="id">ss</span> <span class="id">id</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BLKSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">blk_tgt</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">BLKTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0)&gt;&gt;)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMSYMB3</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BLKTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">blk_src</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">BLKSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_symbol</span>) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0)&gt;&gt;)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMDEF</span>: <span class="kwd">forall</span> <span class="id">blk_src</span> <span class="id">blk_tgt</span> <span class="id">delta</span> <span class="id">def_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_src</span> = <span class="id">Some</span> <span class="id">def_src</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">def_tgt</span>, (&lt;&lt;<span class="id">DEFTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_tgt</span> = <span class="id">Some</span> <span class="id">def_tgt</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DELTA</span>: <span class="id">delta</span> = 0&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIM</span>: <span class="id">def_src</span> = <span class="id">def_tgt</span>&gt;&gt;)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DISJ</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">blk_src0</span> <span class="id">blk_src1</span> <span class="id">blk_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBSRC</span>: <span class="id">Genv.find_symbol</span> <span class="id">skenv_src</span> <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL0</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src0</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL1</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src1</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, 0)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">blk_src0</span> = <span class="id">blk_src1</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIMDEFINV</span>: <span class="kwd">forall</span> <span class="id">blk_src</span> <span class="id">blk_tgt</span> <span class="id">delta</span> <span class="id">def_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMVAL</span>: <span class="id">sm0</span>.(<span class="id">SimMemInj.inj</span>) <span class="id">blk_src</span> = <span class="id">Some</span> (<span class="id">blk_tgt</span>, <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DEFTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_tgt</span> = <span class="id">Some</span> <span class="id">def_tgt</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">def_src</span>, (&lt;&lt;<span class="id">DEFSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.find_def</span>) <span class="id">blk_src</span> = <span class="id">Some</span> <span class="id">def_src</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">DELTA</span>: <span class="id">delta</span> = 0&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">SIM</span>: <span class="id">def_src</span> = <span class="id">def_tgt</span>&gt;&gt;)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">PUBKEPT</span>: (<span class="kwd">fun</span> <span class="id">id</span> =&gt; <span class="id">In</span> <span class="id">id</span> <span class="id">skenv_src</span>.(<span class="id">Genv.genv_public</span>)) &lt;1= ~1 <span class="id">ss</span>&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">PUB</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.genv_public</span>) = <span class="id">skenv_tgt</span>.(<span class="id">Genv.genv_public</span>)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">NBSRC</span>: <span class="id">skenv_src</span>.(<span class="id">Genv.genv_next</span>) = <span class="id">sm0</span>.(<span class="id">src_ge_nb</span>)&gt;&gt;) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(&lt;&lt;<span class="id">NBTGT</span>: <span class="id">skenv_tgt</span>.(<span class="id">Genv.genv_next</span>) = <span class="id">sm0</span>.(<span class="id">tgt_ge_nb</span>)&gt;&gt;).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">sim_skenv_splittable_spec</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sim_skenv_splittable</span> &lt;4= <span class="id">sim_skenv</span>) /\ (<span class="id">sim_skenv</span> &lt;4= <span class="id">sim_skenv_splittable</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6098')">Proof.</div>
<div class="proofscript" id="proof6098">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">ii</span>; <span class="id">inv</span> <span class="id">PR</span>; <span class="id">ss</span>; <span class="id">des</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">splits</span>; <span class="id">ss</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id">le</span> (<span class="id">ss0</span>: <span class="id">t</span>') (<span class="id">ss1</span>: <span class="id">t</span>'): <span class="kwd">Prop</span> :=<br/>
| <span class="id">le_intro</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LE</span>: <span class="id">ss0</span> &lt;1= <span class="id">ss1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OUTSIDE</span>: <span class="kwd">forall</span> <span class="id">id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IN</span>: (<span class="id">ss1</span> -1 <span class="id">ss0</span>) <span class="id">id</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">OUTSIDESRC</span>: ~ <span class="id">ss0</span>.(<span class="id">src</span>).(<span class="id">defs</span>) <span class="id">id</span>&gt;&gt; /\ &lt;&lt;<span class="id">OUTSIDETGT</span>: ~ <span class="id">ss0</span>.(<span class="id">tgt</span>).(<span class="id">defs</span>) <span class="id">id</span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SKLESRC</span>: <span class="id">linkorder</span> <span class="id">ss0</span>.(<span class="id">src</span>) <span class="id">ss1</span>.(<span class="id">src</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SKLETGT</span>: <span class="id">linkorder</span> <span class="id">ss0</span>.(<span class="id">tgt</span>) <span class="id">ss1</span>.(<span class="id">tgt</span>))<br/>
.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">linkorder_defs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> <span class="id">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">Linker</span> <span class="id">F</span>} `{<span class="id">Linker</span> <span class="id">V</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p0</span> <span class="id">p1</span>: <span class="id">AST.program</span> <span class="id">F</span> <span class="id">V</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINKORD</span>: <span class="id">linkorder</span> <span class="id">p0</span> <span class="id">p1</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">DEFS</span>: <span class="id">p0</span>.(<span class="id">defs</span>) &lt;1= <span class="id">p1</span>.(<span class="id">defs</span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6099')">Proof.</div>
<div class="proofscript" id="proof6099">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LINKORD</span>. <span class="id">ii</span>. <span class="id">u</span> <span class="kwd">in</span> *. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl_bool</span>. <span class="id">des_sumbool</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H3</span>; <span class="tactic">try</span> <span class="id">eassumption</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">prog_defmap_spec</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Genv_invert_symbol_none_spec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> <span class="id">V</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ge</span>: <span class="id">Genv.t</span> <span class="id">F</span> <span class="id">V</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">INV</span>: <span class="id">Genv.invert_symbol</span> <span class="id">ge</span> <span class="id">b</span> = <span class="id">None</span>&gt;&gt; &lt;-&gt; &lt;&lt;<span class="id">FIND</span>: <span class="kwd">forall</span> <span class="id">id</span>, <span class="id">Genv.find_symbol</span> <span class="id">ge</span> <span class="id">id</span> &lt;&gt; <span class="id">Some</span> <span class="id">b</span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6100')">Proof.</div>
<div class="proofscript" id="proof6100">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Genv.find_symbol</span>, <span class="id">Genv.invert_symbol</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">abstr</span> (<span class="id">Genv.genv_symb</span> <span class="id">ge</span>) <span class="id">tree</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">i</span>; <span class="id">des</span>; <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">PTree_Properties.fold_rec</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">PTree.gempty</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gsspec</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">PTree_Properties.fold_rec</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">clarify</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">or_des</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">OR</span>: <span class="id">A</span> \/ <span class="id">B</span>):<br/>
&nbsp;&nbsp;(<span class="id">A</span> /\ <span class="id">B</span>) \/ (<span class="id">A</span> /\ ~ <span class="id">B</span>) \/ (~ <span class="id">A</span> /\ <span class="id">B</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6101')">Proof.</div>
<div class="proofscript" id="proof6101">
 <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">init_meminj</span> (<span class="id">sk_src</span> <span class="id">sk_tgt</span>:<span class="id">Sk.t</span>) : <span class="id">meminj</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">Genv.invert_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">sk_src</span>) <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">id</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">sk_tgt</span>) <span class="id">id</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">b</span>' =&gt; <span class="id">Some</span> (<span class="id">b</span>', 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id">init_meminj_invert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: (<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">b</span> = <span class="id">Some</span>(<span class="id">b</span>', <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSK</span>: <span class="kwd">wf</span> <span class="id">ss</span>):<br/>
&nbsp;&nbsp;<span class="id">delta</span> = 0 /\ <span class="id">exists</span> <span class="id">id</span>, <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span> /\ <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span>' /\ ~ <span class="id">ss</span> <span class="id">id</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6102')">Proof.</div>
<div class="proofscript" id="proof6102">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">init_meminj</span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">id</span>|] <span class="id">eqn</span>:<span class="id">S</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">b</span>''|] <span class="id">eqn</span>:<span class="id">F</span>; <span class="id">inv</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">exists</span> <span class="id">id</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">Genv.invert_find_symbol</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id">Genv.find_symbol_inversion</span> <span class="kwd">in</span> <span class="id">F</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span> <span class="kwd">in</span> <span class="id">F</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">apply</span> <span class="id">DROP</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id">init_meminj_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> <span class="id">id</span> <span class="id">b</span> <span class="id">b</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBOL</span>: <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBOL2</span>: <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSK</span>: <span class="kwd">wf</span> <span class="id">ss</span>):<br/>
&nbsp;&nbsp;(<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">b</span> = <span class="id">Some</span>(<span class="id">b</span>', 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6103')">Proof.</div>
<div class="proofscript" id="proof6103">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">init_meminj</span>. <span class="id">erewrite</span> <span class="id">Genv.find_invert_symbol</span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">SYMBOL2</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">init_mem_exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> <span class="id">m_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSK</span>: <span class="kwd">wf</span> <span class="id">ss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LOADMEMSRC</span>: <span class="id">Sk.load_mem</span> <span class="id">ss</span>.(<span class="id">src</span>) = <span class="id">Some</span> <span class="id">m_src</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m_tgt</span>, <span class="id">Sk.load_mem</span> <span class="id">ss</span>.(<span class="id">tgt</span>) = <span class="id">Some</span> <span class="id">m_tgt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6104')">Proof.</div>
<div class="proofscript" id="proof6104">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">unfold</span> <span class="id">Sk.load_mem</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id">Genv.init_mem_exists</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">P</span>: (<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">tgt</span>))!<span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gvar</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">prog_defmap_norepet</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">NoDup_norepet</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Q</span>: (<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">src</span>)) ! <span class="id">id</span> = <span class="id">Some</span> (<span class="id">Gvar</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;- <span class="id">KEPT</span>; <span class="id">ss</span>. <span class="id">ii</span>. <span class="tactic">rewrite</span> <span class="id">DROP</span> <span class="kwd">in</span> <span class="id">P</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.init_mem_inversion</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">in_prog_defmap</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">AL</span> <span class="id">FV</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">FV</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b</span> &amp; <span class="id">FS</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Genv.find_symbol_inversion</span> <span class="kwd">in</span> <span class="id">FS</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span> <span class="kwd">in</span> <span class="id">FS</span>. <span class="tactic">destruct</span> <span class="id">FS</span> <span class="kwd">as</span> (<span class="id">g</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Genv.find_symbol_exists</span> <span class="kwd">with</span> <span class="id">g</span>. <span class="tactic">apply</span> <span class="id">in_prog_defmap</span>. <span class="tactic">rewrite</span> <span class="id">KEPT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">NOREF</span>; <span class="id">et</span>. <span class="id">r</span>. <span class="id">exists</span> <span class="id">o</span>; <span class="id">et</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">init_meminj_simskenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> <span class="id">m_src</span> <span class="id">m_tgt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LOADMEMSRC</span>: <span class="id">Sk.load_mem</span> <span class="id">ss</span>.(<span class="id">src</span>) = <span class="id">Some</span> <span class="id">m_src</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LOADMEMTGT</span>: <span class="id">Sk.load_mem</span> <span class="id">ss</span>.(<span class="id">tgt</span>) = <span class="id">Some</span> <span class="id">m_tgt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSK</span>: <span class="kwd">wf</span> <span class="id">ss</span>)<br/>
&nbsp;&nbsp;: <span class="id">sim_skenv</span> (<span class="id">SimMemInj.mk</span> <span class="id">m_src</span> <span class="id">m_tgt</span> (<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">bot2</span> <span class="id">bot2</span> (<span class="id">Mem.nextblock</span> <span class="id">m_src</span>) (<span class="id">Mem.nextblock</span> <span class="id">m_tgt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Mem.nextblock</span> <span class="id">m_src</span>) (<span class="id">Mem.nextblock</span> <span class="id">m_tgt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6105')">Proof.</div>
<div class="proofscript" id="proof6105">
&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="id">i</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">inv</span> <span class="id">SIMSK</span>; <span class="id">erewrite</span> <span class="id">Genv.init_mem_genv_next</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id1</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">id1</span> = <span class="id">id</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> (<span class="id">Genv.genv_vars_inj</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>))); <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">id1</span>. <span class="id">esplits</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">blk_tgt</span> : <span class="id">block</span>, <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_tgt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">Genv.find_symbol_inversion</span> <span class="kwd">in</span> <span class="id">BLKSRC</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span> <span class="kwd">in</span> <span class="id">BLKSRC</span>. <span class="tactic">destruct</span> <span class="id">BLKSRC</span> <span class="kwd">as</span> (<span class="id">g</span> &amp; <span class="id">P</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Genv.find_symbol_exists</span> <span class="kwd">with</span> <span class="id">g</span>. <span class="tactic">apply</span> <span class="id">in_prog_defmap</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">rewrite</span> <span class="id">KEPT0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>. <span class="id">exists</span> <span class="id">blk_tgt</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">init_meminj_eq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">blk_src</span> : <span class="id">block</span>, <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">blk_src</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">Genv.find_symbol_inversion</span> <span class="kwd">in</span> <span class="id">BLKTGT</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span> <span class="kwd">in</span> <span class="id">BLKTGT</span>. <span class="tactic">destruct</span> <span class="id">BLKTGT</span> <span class="kwd">as</span> (<span class="id">g</span> &amp; <span class="id">P</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Genv.find_symbol_exists</span> <span class="kwd">with</span> <span class="id">g</span>. <span class="tactic">apply</span> <span class="id">in_prog_defmap</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">KEPT</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">rewrite</span> <span class="id">DROP</span> <span class="kwd">in</span> <span class="id">P</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>. <span class="id">exists</span> <span class="id">blk_src</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">init_meminj_eq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">src</span>))!<span class="id">id</span> = <span class="id">Some</span> <span class="id">def_src</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Genv.find_def_symbol</span>. <span class="id">exists</span> <span class="id">blk_src</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">tgt</span>))!<span class="id">id</span> = <span class="id">Some</span> <span class="id">def_src</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">rewrite</span> <span class="id">KEPT</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_def_symbol</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span> <span class="kwd">in</span> *. <span class="tactic">replace</span> <span class="id">b</span> <span class="kwd">with</span> <span class="id">blk_tgt</span> <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="id">exists</span> <span class="id">def_src</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">init_meminj</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="id">apply_all_once</span> <span class="id">Genv.find_invert_symbol</span>. <span class="tactic">rewrite</span> <span class="id">Heq2</span> <span class="kwd">in</span> <span class="id">Heq0</span>. <span class="id">inv</span> <span class="id">Heq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply_all_once</span> <span class="id">Genv.invert_find_symbol</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">tgt</span>))!<span class="id">id</span> = <span class="id">Some</span> <span class="id">def_tgt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Genv.find_def_symbol</span>. <span class="id">exists</span> <span class="id">blk_tgt</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">rewrite</span> <span class="id">KEPT</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">Genv.find_def_symbol</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span> <span class="kwd">in</span> *. <span class="tactic">replace</span> <span class="id">b</span> <span class="kwd">with</span> <span class="id">blk_src</span> <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="id">exists</span> <span class="id">def_tgt</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">apply</span> <span class="id">CLOSED</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id">privs</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">negb_true_iff</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Genv.globalenv_public</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="id">des_sumbool</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id">Genv.globalenv_public</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-&nbsp;inv&nbsp;SIMSK.&nbsp;erewrite&nbsp;Genv.init_mem_genv_next;&nbsp;et.&nbsp;xomega.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-&nbsp;inv&nbsp;SIMSK.&nbsp;erewrite&nbsp;Genv.init_mem_genv_next;&nbsp;et.&nbsp;xomega.&nbsp;*)</span><br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">init_meminj_invert_strong</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: (<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">b</span> = <span class="id">Some</span>(<span class="id">b</span>', <span class="id">delta</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSK</span> : <span class="kwd">wf</span> <span class="id">ss</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">delta</span> = 0 /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">id</span> <span class="id">gd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">id</span> = <span class="id">Some</span> <span class="id">b</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Genv.find_def</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">b</span> = <span class="id">Some</span> <span class="id">gd</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Genv.find_def</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">b</span>' = <span class="id">Some</span> <span class="id">gd</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6106')">Proof.</div>
<div class="proofscript" id="proof6106">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>). <span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">gd</span>, (<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">src</span>))!<span class="id">id</span> = <span class="id">Some</span> <span class="id">gd</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span>. <span class="tactic">eapply</span> <span class="id">Genv.find_symbol_inversion</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">gd</span> <span class="id">DM</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">prog_defmap</span> <span class="id">ss</span>.(<span class="id">tgt</span>))!<span class="id">id</span> = <span class="id">Some</span> <span class="id">gd</span>).<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">rewrite</span> <span class="id">KEPT</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_def_symbol</span> <span class="kwd">in</span> <span class="id">DM</span>. <span class="tactic">destruct</span> <span class="id">DM</span> <span class="kwd">as</span> (<span class="id">b</span>'' &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">rewrite</span> <span class="id">P</span> <span class="kwd">in</span> <span class="id">B</span>; <span class="id">inv</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Genv.find_def_symbol</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span>'' &amp; <span class="id">R</span> &amp; <span class="id">S</span>). <span class="tactic">rewrite</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">bytes_of_init_inject</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span> <span class="id">m_src</span> <span class="id">il</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SIMSK</span>: <span class="kwd">wf</span> <span class="id">ss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LOADMEMSRC</span>: <span class="id">Sk.load_mem</span> <span class="id">ss</span>.(<span class="id">src</span>) = <span class="id">Some</span> <span class="id">m_src</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">REF</span>: <span class="kwd">forall</span> <span class="id">id</span>, <span class="id">ref_init</span> <span class="id">il</span> <span class="id">id</span> -&gt; ~ <span class="id">ss</span> <span class="id">id</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_forall2</span> (<span class="id">memval_inject</span> (<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>))) (<span class="id">Genv.bytes_of_init_data_list</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">il</span>) (<span class="id">Genv.bytes_of_init_data_list</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">il</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6107')">Proof.</div>
<div class="proofscript" id="proof6107">
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">init_mem_exists</span>; <span class="id">et</span>. <span class="tactic">intros</span> <span class="id">LOADMEMTGT</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">il</span> <span class="kwd">as</span> [ | <span class="id">i1</span> <span class="id">il</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">list_forall2_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">init_meminj_simskenv</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">SIMSK</span>; <span class="id">et</span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i1</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id">inj_bytes_inject</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">induction</span> (<span class="id">Z.to_nat</span> <span class="id">z</span>); <span class="tactic">simpl</span>; <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="id">i</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">FS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (~ <span class="id">ss</span> <span class="id">i</span>). { <span class="tactic">apply</span> <span class="id">REF</span>. <span class="tactic">red</span>. <span class="id">exists</span> <span class="id">i0</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="id">et</span>. <span class="tactic">intros</span> (<span class="id">b</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">apply</span> <span class="id">inj_value_inject</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">Ptrofs.add_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">Genv.find_symbol</span> (<span class="id">Sk.load_skenv</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">i</span>) <span class="kwd">as</span> [<span class="id">b</span>'|] <span class="id">eqn</span>:<span class="id">FS</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIMSYMB3</span>; <span class="id">et</span>. <span class="tactic">intros</span> (<span class="id">b</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">congruence</span>. <span class="tactic">apply</span> <span class="id">repeat_Undef_inject_self</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHil</span>. <span class="tactic">intros</span> <span class="id">id</span> [<span class="id">ofs</span> <span class="id">IN</span>]. <span class="tactic">apply</span> <span class="id">REF</span>. <span class="id">exists</span> <span class="id">ofs</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Mem_getN_forall2</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">P</span>: <span class="id">memval</span> -&gt; <span class="id">memval</span> -&gt; <span class="kwd">Prop</span>) <span class="id">c1</span> <span class="id">c2</span> <span class="id">i</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id">list_forall2</span> <span class="id">P</span> (<span class="id">Mem.getN</span> <span class="id">n</span> <span class="id">p</span> <span class="id">c1</span>) (<span class="id">Mem.getN</span> <span class="id">n</span> <span class="id">p</span> <span class="id">c2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">p</span> &lt;= <span class="id">i</span> -&gt; <span class="id">i</span> &lt; <span class="id">p</span> + <span class="id">Z.of_nat</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">P</span> (<span class="id">ZMap.get</span> <span class="id">i</span> <span class="id">c1</span>) (<span class="id">ZMap.get</span> <span class="id">i</span> <span class="id">c2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6108')">Proof.</div>
<div class="proofscript" id="proof6108">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="id">Mem.getN</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">omegaContradiction</span>.<br/>
- <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">Nat2Z.inj_succ</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> (<span class="id">zeq</span> <span class="id">i</span> <span class="id">p</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
+ <span class="tactic">apply</span> <span class="id">IHn</span> <span class="kwd">with</span> (<span class="id">p</span> + 1); <span class="tactic">auto</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">le_PreOrder</span>: <span class="id">PreOrder</span> <span class="id">le</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6109')">Next Obligation.</div>
<div class="proofscript" id="proof6109">
&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">des</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">linkorder_refl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">linkorder_refl</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6110')">Next Obligation.</div>
<div class="proofscript" id="proof6110">
&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">y</span> <span class="id">id</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">OUTSIDE</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">OUTSIDE0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">linkorder_defs</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="id">eassumption</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">linkorder_defs</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="id">eassumption</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">linkorder_trans</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">linkorder_trans</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">SimSymbDrop</span>: <span class="id">SimSymb.class</span> <span class="id">SimMemInj</span> := {<br/>
&nbsp;&nbsp;<span class="id">t</span> := <span class="id">t</span>';<br/>
&nbsp;&nbsp;<span class="id">src</span> := <span class="id">src</span>;<br/>
&nbsp;&nbsp;<span class="id">tgt</span> := <span class="id">tgt</span>;<br/>
&nbsp;&nbsp;<span class="id">le</span> := <span class="id">le</span>;<br/>
&nbsp;&nbsp;<span class="kwd">wf</span> := <span class="kwd">wf</span>;<br/>
&nbsp;&nbsp;<span class="id">sim_skenv</span> := <span class="id">sim_skenv</span>;<br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6111')">Next Obligation.</div>
<div class="proofscript" id="proof6111">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">inv</span> <span class="id">WFSRC</span>. <span class="id">econs</span>; <span class="id">et</span>. <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_norepet</span> <span class="kwd">in</span> <span class="id">IN</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">NoDup_norepet</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss0</span> <span class="id">id_to</span>)).<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">NOREF</span>; <span class="id">et</span>; <span class="id">ss</span>. <span class="id">rr</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span>(<span class="id">KEPT0</span>: ~ <span class="id">ss0</span> <span class="id">id_fr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">DROP</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dup</span> <span class="id">IN</span>. <span class="tactic">rewrite</span> <span class="id">KEPT</span> <span class="kwd">in</span> <span class="id">IN</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">WFPTR</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">in_prog_defmap</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="tactic">eapply</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">des</span>. <span class="tactic">eapply</span> <span class="id">prog_defmap_image</span>; <span class="id">et</span>. <span class="id">erewrite</span> <span class="id">KEPT</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">PUB</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss0</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">CLOSED</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="tactic">unfold</span> <span class="id">privs</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">bsimpl</span>. <span class="id">des</span>. <span class="tactic">unfold</span> <span class="id">NW</span> <span class="kwd">in</span> *. <span class="id">bsimpl</span>. <span class="id">des_sumbool</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">KEPT</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">prog_defmap_image</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">ss</span>. <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">WFPARAM</span>. <span class="id">instantiate</span> (1:=<span class="id">id</span>). <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss0</span> <span class="id">id</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">DROP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">prog_defmap_norepet</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">NoDup_norepet</span>. <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">KEPT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">prog_defmap_norepet</span> <span class="kwd">in</span> <span class="id">IN</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">NoDup_norepet</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">in_prog_defmap</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6112')">Next Obligation.</div>
<div class="proofscript" id="proof6112">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">inv</span> <span class="id">SIMSK0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">link_prog_inv</span> <span class="id">ss0</span>.(<span class="id">src</span>) <span class="id">ss1</span>.(<span class="id">src</span>)); <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">AUX1</span>: <span class="kwd">forall</span> <span class="id">id</span>, <span class="id">ss1</span> <span class="id">id</span> -&gt; ~ <span class="id">ss0</span> <span class="id">id</span> -&gt; (<span class="id">prog_defmap</span> <span class="id">ss0</span>.(<span class="id">src</span>)) ! <span class="id">id</span> = <span class="id">None</span>).<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">ss0</span>.(<span class="id">src</span>)) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">CLOSED0</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id">privs</span>, <span class="id">defs</span>, <span class="id">NW</span> <span class="kwd">in</span> *. <span class="id">bsimpl</span>. <span class="id">des</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">AUX2</span>: <span class="kwd">forall</span> <span class="id">id</span>, <span class="id">ss0</span> <span class="id">id</span> -&gt; ~ <span class="id">ss1</span> <span class="id">id</span> -&gt; (<span class="id">prog_defmap</span> <span class="id">ss1</span>.(<span class="id">src</span>)) ! <span class="id">id</span> = <span class="id">None</span>).<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">ss1</span>.(<span class="id">src</span>)) ! <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">CLOSED</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id">privs</span>, <span class="id">defs</span>, <span class="id">NW</span> <span class="kwd">in</span> *. <span class="id">bsimpl</span>. <span class="id">des</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">LINKTGT</span>: <span class="id">link</span> <span class="id">ss0</span>.(<span class="id">tgt</span>) <span class="id">ss1</span>.(<span class="id">tgt</span>) = <span class="id">Some</span> (<span class="id">mkprogram</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PTree.elements</span> (<span class="id">PTree.combine</span> <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">ss0</span>.(<span class="id">tgt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_defmap</span> <span class="id">ss1</span>.(<span class="id">tgt</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_public</span> <span class="id">ss0</span>.(<span class="id">tgt</span>) ++ <span class="id">prog_public</span> <span class="id">ss1</span>.(<span class="id">tgt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prog_main</span> <span class="id">ss0</span>.(<span class="id">tgt</span>)))).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> (<span class="id">link_prog_succeeds</span> <span class="id">ss0</span>.(<span class="id">tgt</span>) <span class="id">ss1</span>.(<span class="id">tgt</span>)); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">KEPT</span>; <span class="id">et</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">DROP</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id">KEPT0</span>; <span class="id">et</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">DROP0</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">i</span>. <span class="id">eexists</span> (<span class="id">mk</span> (<span class="id">ss0</span> \1/ <span class="id">ss1</span>) <span class="id">_</span> <span class="id">_</span>). <span class="id">eexists</span>. <span class="id">esplits</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des</span>; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>; <span class="id">ii</span>; <span class="tactic">eapply</span> <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">des</span>; <span class="id">exploit</span> <span class="id">AUX1</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="id">exploit</span> <span class="id">KEPT</span>; <span class="tactic">eauto</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">link_linkorder</span> <span class="kwd">in</span> <span class="id">LINKSRC</span>; <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">link_linkorder</span> <span class="kwd">in</span> <span class="id">LINKTGT</span>; <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des</span>; <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>; <span class="id">ii</span>; <span class="tactic">eapply</span> <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">des</span>; <span class="id">exploit</span> <span class="id">AUX2</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="id">exploit</span> <span class="id">KEPT0</span>; <span class="tactic">eauto</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">link_linkorder</span> <span class="kwd">in</span> <span class="id">LINKSRC</span>; <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">link_linkorder</span> <span class="kwd">in</span> <span class="id">LINKTGT</span>; <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">ii</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">not_or_and</span> <span class="kwd">in</span> <span class="id">KEPT1</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> ! <span class="id">prog_defmap_elements</span>, !<span class="id">PTree.gcombine</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">KEPT</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">KEPT0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">prog_defmap_elements</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span>; <span class="id">ss</span>. <span class="tactic">apply</span> <span class="id">or_des</span> <span class="kwd">in</span> <span class="id">DROP1</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">DROP</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">DROP0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">DROP</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">KEPT0</span>; <span class="id">ss</span>. <span class="tactic">apply</span> <span class="id">AUX2</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">DROP0</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">KEPT</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">AUX1</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rr</span>. <span class="tactic">unfold</span> <span class="id">privs</span>. <span class="id">ss</span>. <span class="id">bsimpl</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span>(<span class="id">T</span>: <span class="id">exists</span> <span class="id">x1</span>, <span class="id">link_prog_merge</span> (<span class="id">prog_defmap</span> <span class="id">ss0</span>.(<span class="id">src</span>)) ! <span class="id">x0</span> (<span class="id">prog_defmap</span> <span class="id">ss1</span>.(<span class="id">src</span>)) ! <span class="id">x0</span> = <span class="id">Some</span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">CLOSED</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="tactic">unfold</span> <span class="id">privs</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">unfold</span> <span class="id">NW</span> <span class="kwd">in</span> *. <span class="id">bsimpl</span>. <span class="id">des_safe</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">T</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">ss1</span>.(<span class="id">src</span>)) ! <span class="id">x0</span>) <span class="id">eqn</span>:<span class="id">EQN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">CLOSED0</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="tactic">unfold</span> <span class="id">privs</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">unfold</span> <span class="id">NW</span> <span class="kwd">in</span> *. <span class="id">bsimpl</span>. <span class="id">des_safe</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">T</span>. <span class="tactic">destruct</span> ((<span class="id">prog_defmap</span> <span class="id">ss0</span>.(<span class="id">src</span>)) ! <span class="id">x0</span>) <span class="id">eqn</span>:<span class="id">EQN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">PR</span>. <span class="id">des_safe</span>. <span class="id">rr</span>. <span class="tactic">unfold</span> <span class="id">defs</span>. <span class="tactic">unfold</span> <span class="id">NW</span>. <span class="id">des_sumbool</span>. <span class="tactic">unfold</span> <span class="id">prog_defs_names</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span>. <span class="id">eexists</span> (<span class="id">_</span>, <span class="id">_</span>). <span class="id">s</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">PTree.elements_correct</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span>; <span class="id">ss</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">NW</span>. <span class="id">bsimpl</span>. <span class="id">des_sumbool</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">destruct</span> <span class="id">PR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">CLOSED</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">TT</span>. <span class="tactic">unfold</span> <span class="id">privs</span>, <span class="id">NW</span> <span class="kwd">in</span> <span class="id">TT</span>. <span class="id">bsimpl</span>. <span class="id">des_safe</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>; <span class="id">ss</span>. <span class="tactic">apply</span> <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> <span class="id">TT</span>. <span class="id">inv</span> <span class="id">WFSRC1</span>. <span class="tactic">apply</span> <span class="id">PUBINCL</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id">CLOSED0</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">TT</span>. <span class="tactic">unfold</span> <span class="id">privs</span>, <span class="id">NW</span> <span class="kwd">in</span> <span class="id">TT</span>. <span class="id">bsimpl</span>. <span class="id">des_safe</span>. <span class="id">des_sumbool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>; <span class="id">ss</span>. <span class="tactic">apply</span> <span class="id">defs_prog_defmap</span> <span class="kwd">in</span> <span class="id">TT</span>. <span class="id">inv</span> <span class="id">WFSRC0</span>. <span class="tactic">apply</span> <span class="id">PUBINCL</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_dom</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span>(<span class="id">T</span>: (<span class="id">In</span> (<span class="id">id</span>, <span class="id">Gvar</span> <span class="id">gv</span>) (<span class="id">prog_defs</span> <span class="id">ss0</span>.(<span class="id">tgt</span>))) \/ (<span class="id">In</span> (<span class="id">id</span>, <span class="id">Gvar</span> <span class="id">gv</span>) (<span class="id">prog_defs</span> <span class="id">ss1</span>.(<span class="id">tgt</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">prog_defmap</span> <span class="kwd">in</span> <span class="id">PROG</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">PTree_Properties.of_list_elements</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PTree.gcombine</span> <span class="kwd">in</span> *; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">link_prog_merge</span> <span class="kwd">in</span> <span class="id">PROG</span>. <span class="tactic">clear</span> - <span class="id">PROG</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">PTree_Properties.in_of_list</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">apply</span> <span class="id">PTree_Properties.in_of_list</span> <span class="kwd">in</span> <span class="id">Heq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">link_unit_same</span> <span class="id">g</span> <span class="id">g0</span>); <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">PTree_Properties.in_of_list</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">PTree_Properties.in_of_list</span> <span class="kwd">in</span> <span class="id">PROG</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">U</span>: ~ <span class="id">In</span> <span class="id">id_drop</span> (<span class="id">prog_defs_names</span> <span class="id">ss0</span>.(<span class="id">tgt</span>)) /\ ~ <span class="id">In</span> <span class="id">id_drop</span> (<span class="id">prog_defs_names</span> <span class="id">ss1</span>.(<span class="id">tgt</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss0</span> <span class="id">id_drop</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">DROP</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">V</span>. <span class="tactic">intro</span> <span class="id">W</span>. <span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">desH</span> <span class="id">DROP1</span>; <span class="id">et</span>. <span class="id">exploit</span> <span class="id">KEPT</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">AUX1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des_safe</span>; <span class="id">clarify</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss1</span> <span class="id">id_drop</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">DROP0</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">V</span>. <span class="tactic">intro</span> <span class="id">W</span>. <span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">desH</span> <span class="id">DROP1</span>; <span class="id">et</span>. <span class="id">exploit</span> <span class="id">KEPT0</span>; <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">AUX2</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">prog_defmap_dom</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des_safe</span>; <span class="id">clarify</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">desH</span> <span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">WFTGT0</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">des_safe</span>. <span class="id">exploit</span> <span class="id">WFPTR</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">inv</span> <span class="id">WFTGT1</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">des_safe</span>. <span class="id">exploit</span> <span class="id">WFPTR</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">NoDup_norepet</span>. <span class="tactic">apply</span> <span class="id">PTree.elements_keys_norepet</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6113')">Next Obligation.</div>
<div class="proofscript" id="proof6113">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSKE</span>. <span class="tactic">unfold</span> <span class="id">Genv.public_symbol</span>. <span class="tactic">apply</span> <span class="id">func_ext1</span>. <span class="tactic">intro</span> <span class="id">i0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_symbol</span> <span class="id">skenv_tgt</span> <span class="id">i0</span>) <span class="id">eqn</span>:<span class="id">T</span>.<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SIMSYMB3</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id">PUB</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">des_ifs</span>. <span class="id">des_sumbool</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">PUBKEPT</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6114')">Next Obligation.</div>
<div class="proofscript" id="proof6114">
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">init_mem_exists</span>; <span class="id">et</span>. <span class="tactic">intros</span> <span class="id">LOADMEMTGT</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">init_meminj_simskenv</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">SIMSK</span>; <span class="id">et</span>. <span class="tactic">intros</span> <span class="id">SIMSKENV</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">m_tgt</span>. <span class="id">exists</span> (<span class="id">SimMemInj.mk</span> <span class="id">m_src</span> <span class="id">m_tgt</span> (<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">bot2</span> <span class="id">bot2</span> (<span class="id">Mem.nextblock</span> <span class="id">m_src</span>) (<span class="id">Mem.nextblock</span> <span class="id">m_tgt</span>) (<span class="id">Mem.nextblock</span> <span class="id">m_src</span>) (<span class="id">Mem.nextblock</span> <span class="id">m_tgt</span>)).<br/>
&nbsp;&nbsp;<span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert_strong</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">gd</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">Genv.init_mem_characterization_gen</span> <span class="id">ss</span>.(<span class="id">src</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">Genv.init_mem_characterization_gen</span> <span class="id">ss</span>.(<span class="id">tgt</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">gd</span> <span class="kwd">as</span> [<span class="id">f</span>|<span class="id">v</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">P2</span> &amp; <span class="id">Q2</span>) (<span class="id">P1</span> &amp; <span class="id">Q1</span>). <span class="tactic">apply</span> <span class="id">Q1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id">Mem.perm_cur</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">P2</span> &amp; <span class="id">Q2</span> &amp; <span class="id">R2</span> &amp; <span class="id">S2</span>) (<span class="id">P1</span> &amp; <span class="id">Q1</span> &amp; <span class="id">R1</span> &amp; <span class="id">S1</span>). <span class="tactic">apply</span> <span class="id">Q1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Mem.perm_cur</span>. <span class="tactic">eapply</span> <span class="id">Mem.perm_implies</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">P2</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">subst</span> <span class="id">delta</span>. <span class="tactic">apply</span> <span class="id">Z.divide_0_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert_strong</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">gd</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">Genv.init_mem_characterization_gen</span> <span class="id">ss</span>.(<span class="id">src</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">Genv.init_mem_characterization_gen</span> <span class="id">ss</span>.(<span class="id">tgt</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">gd</span> <span class="kwd">as</span> [<span class="id">f</span>|<span class="id">v</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">P2</span> &amp; <span class="id">Q2</span>) (<span class="id">P1</span> &amp; <span class="id">Q1</span>). <span class="tactic">apply</span> <span class="id">Q1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">P2</span> &amp; <span class="id">Q2</span> &amp; <span class="id">R2</span> &amp; <span class="id">S2</span>) (<span class="id">P1</span> &amp; <span class="id">Q1</span> &amp; <span class="id">R1</span> &amp; <span class="id">S1</span>). <span class="tactic">apply</span> <span class="id">Q1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">NO</span>: <span class="id">gvar_volatile</span> <span class="id">v</span> = <span class="id">false</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Genv.perm_globvar</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> (<span class="id">gvar_volatile</span> <span class="id">v</span>); <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H1</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Mem.loadbytes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">S1</span> <span class="id">NO</span>). <span class="tactic">unfold</span> <span class="id">Mem.loadbytes</span>. <span class="tactic">destruct</span> <span class="id">Mem.range_perm_dec</span>; <span class="tactic">intros</span> <span class="id">E1</span>; <span class="id">inv</span> <span class="id">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">S2</span> <span class="id">NO</span>). <span class="tactic">unfold</span> <span class="id">Mem.loadbytes</span>. <span class="tactic">destruct</span> <span class="id">Mem.range_perm_dec</span>; <span class="tactic">intros</span> <span class="id">E2</span>; <span class="id">inv</span> <span class="id">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Z.add_0_r</span>. <span class="tactic">apply</span> <span class="id">Mem_getN_forall2</span> <span class="kwd">with</span> (<span class="id">p</span> := 0) (<span class="id">n</span> := <span class="id">nat_of_Z</span> (<span class="id">init_data_list_size</span> (<span class="id">gvar_init</span> <span class="id">v</span>))); <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>, <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id">bytes_of_init_inject</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">eapply</span> <span class="id">NOREF</span>; <span class="id">et</span>. <span class="tactic">eapply</span> <span class="id">Genv.find_def_symbol</span>. <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">nat_of_Z_eq</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">init_data_list_size_pos</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> ((<span class="id">init_meminj</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="id">b</span>) <span class="kwd">as</span> [[<span class="id">b</span>' <span class="id">delta</span>]|] <span class="id">eqn</span>:<span class="id">INJ</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span>, <span class="id">Sk.load_mem</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id">Genv.find_symbol_not_fresh</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Sk.load_skenv</span>, <span class="id">Sk.load_mem</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id">Genv.find_symbol_not_fresh</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="id">et</span>. <span class="tactic">intros</span> (<span class="id">A1</span> &amp; <span class="id">id1</span> &amp; <span class="id">B1</span> &amp; <span class="id">C1</span> &amp; <span class="id">D1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="id">et</span>. <span class="tactic">intros</span> (<span class="id">A2</span> &amp; <span class="id">id2</span> &amp; <span class="id">B2</span> &amp; <span class="id">C2</span> &amp; <span class="id">D2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">ident_eq</span> <span class="id">id1</span> <span class="id">id2</span>). <span class="tactic">congruence</span>. <span class="id">left</span>; <span class="tactic">eapply</span> <span class="id">Genv.global_addresses_distinct</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>). <span class="tactic">subst</span> <span class="id">delta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">omega</span>. <span class="tactic">generalize</span> (<span class="id">Ptrofs.unsigned_range_2</span> <span class="id">ofs</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">init_meminj_invert_strong</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">id</span> &amp; <span class="id">gd</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">Genv.init_mem_characterization_gen</span> <span class="id">ss</span>.(<span class="id">src</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">Genv.init_mem_characterization_gen</span> <span class="id">ss</span>.(<span class="id">tgt</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">gd</span> <span class="kwd">as</span> [<span class="id">f</span>|<span class="id">v</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">P2</span> &amp; <span class="id">Q2</span>) (<span class="id">P1</span> &amp; <span class="id">Q1</span>). <span class="tactic">apply</span> <span class="id">Q2</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>. <span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">Mem.perm_cur</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">P2</span> &amp; <span class="id">Q2</span> &amp; <span class="id">R2</span> &amp; <span class="id">S2</span>) (<span class="id">P1</span> &amp; <span class="id">Q1</span> &amp; <span class="id">R1</span> &amp; <span class="id">S1</span>). <span class="tactic">apply</span> <span class="id">Q2</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">Mem.perm_cur</span>. <span class="tactic">eapply</span> <span class="id">Mem.perm_implies</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">P1</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">MAIN</span>. <span class="tactic">unfold</span> <span class="id">init_meminj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSKENV</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">Genv.symbol_address</span>. <span class="id">des_ifs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Genv.find_invert_symbol</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">psimpl</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heq</span>. <span class="tactic">rewrite</span> <span class="id">Heq0</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6115')">Next Obligation.</div>
<div class="proofscript" id="proof6115">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MLE</span>. <span class="id">inv</span> <span class="id">SIMSKENV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SAME</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span>, <span class="id">Plt</span> <span class="id">b</span> (<span class="id">Genv.genv_next</span> <span class="id">skenv_src</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inj</span> <span class="id">sm1</span> <span class="id">b</span> = <span class="id">Some</span>(<span class="id">b</span>', <span class="id">delta</span>) -&gt; <span class="id">inj</span> <span class="id">sm0</span> <span class="id">b</span> = <span class="id">Some</span>(<span class="id">b</span>', <span class="id">delta</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">erewrite</span> <span class="id">frozen_preserves_src</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sim_skenv_splittable_spec</span>. <span class="id">rr</span>. <span class="id">dsplits</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="id">ii</span>.<br/>
&nbsp;&nbsp;- <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">SIMSYMB1</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">SAME</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Genv.genv_symb_range</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">eexists</span>. <span class="id">splits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">exploit</span> <span class="id">SIMSYMB3</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">eexists</span>. <span class="id">splits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">exploit</span> <span class="id">SIMDEF</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">SAME</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Genv.genv_defs_range</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">SAME</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Genv.genv_symb_range</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">inj</span> <span class="id">sm0</span> <span class="id">blk_src1</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">p</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">INCR</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">inv</span> <span class="id">FROZEN</span>. <span class="id">exploit</span> <span class="id">NEW_IMPLIES_OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SPLITHINT</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">SYMBSRC</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.genv_symb_range</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">clear</span> - <span class="id">H</span> <span class="id">OUTSIDE_TGT</span> <span class="id">NBTGT</span>. <span class="tactic">rewrite</span> <span class="id">NBTGT</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;- <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">SIMDEFINV</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">inj</span> <span class="id">sm0</span> <span class="id">blk_src</span>) <span class="kwd">as</span> [[<span class="id">b1</span> <span class="id">delta1</span>] | ] <span class="id">eqn</span>: <span class="id">J</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">INCR</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">FROZEN</span>. <span class="id">exploit</span> <span class="id">NEW_IMPLIES_OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Genv.genv_defs_range</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">NBTGT</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6116')">Next Obligation.</div>
<div class="proofscript" id="proof6116">
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link_src</span> <span class="id">ss</span>.(<span class="id">src</span>)) <span class="kwd">as</span> <span class="id">skenv_src</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">SkEnv.project_impl_spec</span> <span class="id">INCLSRC</span>); <span class="tactic">intro</span> <span class="id">LESRC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">SkEnv.project</span> <span class="id">skenv_link_tgt</span> <span class="id">ss</span>.(<span class="id">tgt</span>)) <span class="kwd">as</span> <span class="id">skenv_tgt</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">SkEnv.project_impl_spec</span> <span class="id">INCLTGT</span>); <span class="tactic">intro</span> <span class="id">LETGT</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_spec_preserves_wf</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">LESRC</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">WFSMALLSRC</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SkEnv.project_spec_preserves_wf</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">LETGT</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">WFSMALLTGT</span>.<br/>
<span class="comment">(*&nbsp;THIS&nbsp;IS&nbsp;TOP&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSKENV</span>. <span class="id">ss</span>. <span class="tactic">apply</span> <span class="id">sim_skenv_splittable_spec</span>. <span class="id">folder</span>.<br/>
&nbsp;&nbsp;<span class="id">dsplits</span>; <span class="tactic">eauto</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;SIMSYMB1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LESRC</span>. <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">exploit</span> <span class="id">SYMBDROP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">KEEP</span>; <span class="id">des</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIMSYMB1</span>; <span class="tactic">eauto</span>. { <span class="tactic">rewrite</span> &lt;- <span class="id">KEEP</span>. <span class="id">ss</span>. } <span class="id">i</span>; <span class="id">des</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LETGT</span>. <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">tgt</span>) <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">SYMBDROP0</span>; <span class="id">ss</span>. <span class="id">exfalso</span>. <span class="tactic">clear</span> - <span class="id">LE</span> <span class="id">KEPT</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">SIMSK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">clear</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">u</span> <span class="kwd">in</span> *. <span class="id">simpl_bool</span>. <span class="id">des_sumbool</span>. <span class="tactic">rewrite</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> *. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss</span> <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">KEPT0</span>; <span class="id">ss</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">KEPT</span>. <span class="id">inv</span> <span class="id">LE</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">SYMBKEEP0</span>; <span class="id">ss</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">LE</span> <span class="id">H0</span> <span class="id">KEPT</span>. <span class="id">inv</span> <span class="id">LE</span>. <span class="id">ii</span>. <span class="tactic">apply</span> <span class="id">KEPT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NNPP</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">OUTSIDE</span>; <span class="tactic">eauto</span>. { <span class="tactic">split</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;SIMSYMB2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LESRC</span>. <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">exploit</span> <span class="id">SYMBDROP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">KEEP</span>; <span class="id">des</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">KEEP</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">SIMSYMB2</span> <span class="id">id</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">LE</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">KEPT</span>. <span class="id">specialize</span> (<span class="id">OUTSIDE</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">LETGT</span>. <span class="id">erewrite</span> <span class="id">SYMBKEEP0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">tgt</span>) <span class="id">id</span>)); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="tactic">clear</span> - <span class="id">LE</span> <span class="id">KEPT</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">SIMSK</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">u</span> <span class="kwd">in</span> *. <span class="id">simpl_bool</span>. <span class="id">des_sumbool</span>. <span class="tactic">rewrite</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss</span> <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">KEPT0</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">KEPT</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;SIMSYMB3&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LETGT</span>. <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">tgt</span>) <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SYMBDROP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">SYMBKEEP</span> <span class="kwd">in</span> *; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">SIMSYMB3</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LESRC</span>. <span class="id">erewrite</span> <span class="id">SYMBKEEP0</span>; <span class="id">ss</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">H</span> <span class="id">SIMSK</span>. <span class="id">inv</span> <span class="id">SIMSK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">u</span> <span class="kwd">in</span> *. <span class="id">simpl_bool</span>. <span class="id">des_sumbool</span>. <span class="tactic">rewrite</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> *. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss</span> <span class="id">id</span>)); <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id">DROP</span> <span class="kwd">in</span> *; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">KEPT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;SIMDEF&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LESRC</span>. <span class="id">inv</span> <span class="id">WFSMALLSRC</span>. <span class="id">exploit</span> <span class="id">DEFSYMB</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">SYMBSMALL</span>; <span class="id">des</span>. <span class="tactic">rename</span> <span class="id">SYMB</span> <span class="id">into</span> <span class="id">SYMBSMALL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SYMBDROP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">SYMBBIG</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">SYMBSMALL</span> <span class="kwd">in</span> *. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">SYMBBIG</span>. <span class="id">inv</span> <span class="id">WFSRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBDEF</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIMDEF</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SPLITHINT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">move</span> <span class="id">DEFSRC</span> <span class="tactic">at</span> <span class="id">bottom</span>. <span class="tactic">move</span> <span class="id">H0</span> <span class="tactic">at</span> <span class="id">bottom</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">DEFKEPT</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">KEEP</span>. <span class="id">clarify</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert(def_src&nbsp;=&nbsp;def_tgt).&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;{&nbsp;exploit&nbsp;DEFKEEP;&nbsp;eauto.&nbsp;eapply&nbsp;Genv.find_invert_symbol;&nbsp;eauto.&nbsp;i.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;DEFSRC&nbsp;in&nbsp;*.&nbsp;rewrite&nbsp;H0&nbsp;in&nbsp;*.&nbsp;des.&nbsp;clarify.&nbsp;}&nbsp;clarify.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">LETGT</span>. <span class="id">exploit</span> <span class="id">SIMSYMB1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_def</span> <span class="id">skenv_tgt</span> <span class="id">blk_tgt</span>) <span class="id">eqn</span>:<span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">DEFKEPT0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">specialize</span> (<span class="id">KEPT1</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss</span> <span class="id">id</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">DROP</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">KEPT1</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">DEFKEEP0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">exploit</span> (<span class="id">KEPT1</span> <span class="id">id</span>); <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">LESRC</span>. <span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">defs</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">id</span>)); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SYMBDROP</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="id">et</span>. <span class="id">erewrite</span> &lt;- <span class="id">SYMBKEEP</span>; <span class="id">et</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;SIMDEFINV&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">gd_big</span>, &lt;&lt;<span class="id">DEFBIG</span>: <span class="id">Genv.find_def</span> <span class="id">skenv_link_tgt</span> <span class="id">blk_tgt</span> = <span class="id">Some</span> <span class="id">gd_big</span>&gt;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ &lt;&lt;<span class="id">LO</span>: <span class="id">linkorder</span> <span class="id">def_tgt</span> <span class="id">gd_big</span>&gt;&gt;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LETGT</span>. <span class="tactic">destruct</span> (<span class="id">Genv.invert_symbol</span> <span class="id">skenv_link_tgt</span> <span class="id">blk_tgt</span>) <span class="id">eqn</span>:<span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">DEFKEPT</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">DEFORPHAN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des</span>. <span class="id">exploit</span> <span class="id">SIMDEFINV</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WFSMALLTGT</span>. <span class="id">exploit</span> <span class="id">DEFSYMB</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">SYMBSMALLTGT</span>; <span class="id">des</span>. <span class="tactic">rename</span> <span class="id">SYMB</span> <span class="id">into</span> <span class="id">SYMBSMALLTGT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SPLITHINT1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Fail</span> <span class="id">clears</span> <span class="id">blk_src</span>. <span class="tactic">assert</span>(<span class="id">blk_src</span> = <span class="id">blk_src0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">symmetry</span>. <span class="tactic">eapply</span> <span class="id">SPLITHINT3</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">inv</span> <span class="id">LESRC</span>. <span class="id">inv</span> <span class="id">WFSRC</span>. <span class="id">exploit</span> <span class="id">DEFSYMB</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">id</span> = <span class="id">id0</span>). { <span class="tactic">eapply</span> <span class="id">Genv.genv_vars_inj</span>. <span class="tactic">apply</span> <span class="id">SYMBSMALLTGT</span>. <span class="tactic">eauto</span>. } <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">DSRC</span>: <span class="id">defs</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">id0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">NNPP</span>. <span class="id">ii</span>. <span class="id">erewrite</span> <span class="id">SYMBDROP</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SYMBKEEP</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">BLKSRC</span> <span class="kwd">in</span> *. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">DTGT</span>: <span class="id">defs</span> <span class="id">ss</span>.(<span class="id">tgt</span>) <span class="id">id0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">NNPP</span>. <span class="id">ii</span>. <span class="id">inv</span> <span class="id">LETGT</span>. <span class="id">erewrite</span> <span class="id">SYMBDROP0</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">ITGT</span>: <span class="id">internals</span> <span class="id">ss</span>.(<span class="id">tgt</span>) <span class="id">id0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">dup</span> <span class="id">DTGT</span>. <span class="tactic">unfold</span> <span class="id">defs</span> <span class="kwd">in</span> <span class="id">DTGT</span>. <span class="id">des_sumbool</span>. <span class="tactic">apply</span> <span class="id">prog_defmap_spec</span> <span class="kwd">in</span> <span class="id">DTGT</span>. <span class="id">des</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INCLTGT</span>. <span class="id">exploit</span> <span class="id">DEFS</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">blk</span> = <span class="id">blk_tgt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">LETGT</span>. <span class="id">exploit</span> <span class="id">SYMBKEEP0</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">inv</span> <span class="id">LETGT</span>. <span class="id">exploit</span> <span class="id">DEFKEPT0</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">ISRC</span>: <span class="id">internals</span> <span class="id">ss</span>.(<span class="id">src</span>) <span class="id">id0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="tactic">unfold</span> <span class="id">internals</span> <span class="kwd">in</span> *. <span class="id">des_ifs_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SPLITHINT</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clear_tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">hexploit</span> (<span class="id">KEPT</span> <span class="id">id0</span>); <span class="id">et</span>. <span class="tactic">intro</span> <span class="id">T</span>. <span class="tactic">rewrite</span> <span class="id">Heq</span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">DEFKEEP</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">DEFSMALL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">LETGT</span>. <span class="id">exploit</span> <span class="id">DEFKEPT0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">Genv.find_invert_symbol</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">SYMBKEEP0</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id">SIMSK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">KEPT</span> <span class="id">id0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classic</span> (<span class="id">ss</span> <span class="id">id0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">DROP</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">KEPT</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;PUBS&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">PUBKEPT</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">INCLSRC</span>; <span class="id">et</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LE</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">SIMSK</span>. <span class="id">ss</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6117')">Next Obligation.</div>
<div class="proofscript" id="proof6117">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSKENV</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMFPTR</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">des_ifs_safe</span>; <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id">Genv.find_funct_ptr</span> <span class="kwd">in</span> *. <span class="id">des_ifs_safe</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIMDEF</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIM</span>. <span class="tactic">rewrite</span> <span class="id">DEFTGT</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">des_ifs</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6118')">Next Obligation.</div>
<div class="proofscript" id="proof6118">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSKENV</span>. <span class="tactic">unfold</span> <span class="id">System.skenv</span> <span class="kwd">in</span> *. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ii</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">Genv_map_defs_symb</span> <span class="kwd">in</span> *; <span class="id">apply_all_once</span> <span class="id">Genv_map_defs_def</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">des</span>. <span class="id">exploit</span> <span class="id">SIMDEF</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">Genv_map_defs_def_inv</span> <span class="kwd">in</span> <span class="id">DEFTGT</span>. <span class="tactic">rewrite</span> <span class="id">DEFTGT</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">des</span>. <span class="id">exploit</span> <span class="id">SIMDEFINV</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">Genv_map_defs_def_inv</span> <span class="kwd">in</span> <span class="id">DEFSRC</span>. <span class="tactic">rewrite</span> <span class="id">DEFSRC</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">PUBKEPT</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6119')">Next Obligation.</div>
<div class="proofscript" id="proof6119">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ARGS</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">sm0</span>; <span class="id">ss</span>. <span class="id">inv</span> <span class="id">MWF</span>; <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">SIMSKENV</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">external_call_mem_inject_gen</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">skenv_sys_tgt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span>. <span class="id">esplits</span>; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">Genv.public_symbol</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">PUB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_symbol</span> <span class="id">skenv_sys_tgt</span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">SIMSYMB3</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="tactic">rewrite</span> <span class="id">BLKSRC</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">des_ifs</span>. <span class="id">des_sumbool</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">PUBKEPT</span>; <span class="id">et</span>. <span class="tactic">apply</span> <span class="id">NNPP</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="id">et</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SIMSYMB1</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id">SIMSYMB2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">PUBKEPT</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">Genv.public_symbol</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">des_ifs</span>. <span class="id">des_sumbool</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">Genv.block_is_volatile</span>, <span class="id">Genv.find_var_info</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_def</span> <span class="id">skenv_sys_src</span> <span class="id">b1</span>) <span class="id">eqn</span>:<span class="id">T0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SIMDEF</span>; <span class="tactic">try</span> <span class="id">eassumption</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Genv.find_def</span> <span class="id">skenv_sys_tgt</span> <span class="id">b2</span>) <span class="id">eqn</span>:<span class="id">T1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id">SIMDEFINV</span>; <span class="tactic">try</span> <span class="id">eassumption</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">des_ifs</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ss</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>.<br/>
<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;almost&nbsp;exactly&nbsp;copied&nbsp;from&nbsp;SimMemInj.&nbsp;we&nbsp;may&nbsp;remove&nbsp;duplicate&nbsp;code&nbsp;some&nbsp;way&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="id">dsplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">instantiate</span> (1:= <span class="id">Retv.mk</span> <span class="id">_</span> <span class="id">_</span>); <span class="id">ss</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">retv_src</span>; <span class="id">ss</span>. <span class="id">instantiate</span> (1:= <span class="id">SimMemInj.mk</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>). <span class="id">econs</span> 1; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">retv_src</span>.(<span class="id">Retv.m</span>)). <span class="id">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">Mem.unchanged_on_implies</span>; <span class="tactic">eauto</span>. <span class="id">u</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">SRCEXT</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">unfold</span> <span class="id">src_private</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">Mem.unchanged_on_implies</span>; <span class="tactic">eauto</span>. <span class="id">u</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">unfold</span> <span class="id">tgt_private</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">des</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">inject_separated_frozen</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">NEW_IMPLIES_OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">inject_separated_frozen</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">NEW_IMPLIES_OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">external_call_max_perm</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">external_call_max_perm</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">inject_separated_frozen</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">econs</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">etrans</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">src_private</span>. <span class="id">ss</span>. <span class="id">ii</span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rr</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">x0</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">ss</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>. <span class="id">exploit</span> <span class="id">NEW_IMPLIES_OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">unfold</span> <span class="id">valid_blocks</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Mem.valid_block</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">r</span>. <span class="tactic">eapply</span> <span class="id">Mem.valid_block_unchanged_on</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">etrans</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">tgt_private</span>. <span class="id">ss</span>. <span class="id">ii</span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rr</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="id">ii</span>. <span class="tactic">destruct</span> (<span class="id">inj</span> <span class="id">b0</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">destruct</span> <span class="id">p</span>; <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">PR</span>; <span class="id">et</span>. <span class="tactic">eapply</span> <span class="id">external_call_max_perm</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Mem.valid_block_inject_1</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">T</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">inv</span> <span class="id">H5</span>. <span class="id">exploit</span> <span class="id">NEW_IMPLIES_OUTSIDE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">des</span>. <span class="tactic">unfold</span> <span class="id">valid_blocks</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Mem.valid_block</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">r</span>. <span class="tactic">eapply</span> <span class="id">Mem.valid_block_unchanged_on</span>; <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H2</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H3</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">MEMINJ</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
